<div
  class="code-block code-block-1"
  style="margin: 8px 8px 8px 0; float: left"
></div>
<p>
  In previous lessons, we discussed that when passing an argument by value, a
  copy of the argument is made into the function parameter. For fundamental
  types (which are cheap to copy), this is fine. But copying is typically
  expensive for class types (such as <code>std::string</code>). We can avoid
  making an expensive copy by utilizing passing by (const) reference (or pass by
  address) instead.
</p>
<p>
  We encounter a similar situation when returning by value: a copy of the return
  value is passed back to the caller. If the return type of the function is a
  class type, this can be expensive.
</p>
<div class="code-toolbar">
  <pre
    class="line-numbers language-cpp"
    tabindex="0"
  ><code class="match-braces language-cpp">std<span class="token double-colon punctuation">::</span>string <span class="token function">returnByValue</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-0-close">(</span><span class="token punctuation brace-round brace-close brace-level-1" id="pair-0-open">)</span><span class="token punctuation">;</span> <span class="token comment">// returns a copy of a std::string (expensive)</span><span aria-hidden="true" class="line-numbers-rows"><span style="height: 16px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre>
  <div class="toolbar">
    <div class="toolbar-item">
      <button
        class="copy-to-clipboard-button"
        type="button"
        data-copy-state="copy"
      >
        <span>Copy</span>
      </button>
    </div>
  </div>
</div>
<p class="cpp-section cpp-topline" style="clear: both">Return by reference</p>
<p>
  In cases where we’re passing a class type back to the caller, we may (or may
  not) want to return by reference instead.
  <strong>Return by reference</strong> returns a reference that is bound to the
  object being returned, which avoids making a copy of the return value. To
  return by reference, we simply define the return value of the function to be a
  reference type:
</p>
<div class="code-toolbar">
  <pre
    class="line-numbers language-cpp"
    tabindex="0"
  ><code class="match-braces language-cpp">std<span class="token double-colon punctuation">::</span>string<span class="token operator">&amp;</span>       <span class="token function">returnByReference</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-1-close">(</span><span class="token punctuation brace-round brace-close brace-level-1" id="pair-1-open">)</span><span class="token punctuation">;</span> <span class="token comment">// returns a reference to an existing std::string (cheap)</span>
<span class="token keyword keyword-const">const</span> std<span class="token double-colon punctuation">::</span>string<span class="token operator">&amp;</span> <span class="token function">returnByReferenceToConst</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-2-close">(</span><span class="token punctuation brace-round brace-close brace-level-1" id="pair-2-open">)</span><span class="token punctuation">;</span> <span class="token comment">// returns a const reference to an existing std::string (cheap)</span><span aria-hidden="true" class="line-numbers-rows"><span style="height: 16px;"></span><span style="height: 16px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre>
  <div class="toolbar">
    <div class="toolbar-item">
      <button
        class="copy-to-clipboard-button"
        type="button"
        data-copy-state="copy"
      >
        <span>Copy</span>
      </button>
    </div>
  </div>
</div>
<p>
  Here is an academic program to demonstrate the mechanics of return by
  reference:
</p>
<div class="code-toolbar">
  <pre
    class="line-numbers language-cpp"
    tabindex="0"
  ><code class="match-braces language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string&gt;</span></span>

<span class="token keyword keyword-const">const</span> std<span class="token double-colon punctuation">::</span>string<span class="token operator">&amp;</span> <span class="token function">getProgramName</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-3-close">(</span><span class="token punctuation brace-round brace-close brace-level-1" id="pair-3-open">)</span> <span class="token comment">// returns a const reference</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-7-close">{</span>
    <span class="token keyword keyword-static">static</span> <span class="token keyword keyword-const">const</span> std<span class="token double-colon punctuation">::</span>string s_programName <span class="token punctuation brace-curly brace-open brace-level-2" id="pair-6-close">{</span> <span class="token string">"Calculator"</span> <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-6-open">}</span><span class="token punctuation">;</span> <span class="token comment">// has static duration, destroyed at end of program</span>

    <span class="token keyword keyword-return">return</span> s_programName<span class="token punctuation">;</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-7-open">}</span>

<span class="token keyword keyword-int">int</span> <span class="token function">main</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-4-close">(</span><span class="token punctuation brace-round brace-close brace-level-1" id="pair-4-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-8-close">{</span>
    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"This program is named "</span> <span class="token operator">&lt;&lt;</span> <span class="token function">getProgramName</span><span class="token punctuation brace-round brace-open brace-level-2" id="pair-5-close">(</span><span class="token punctuation brace-round brace-close brace-level-2" id="pair-5-open">)</span><span class="token punctuation">;</span>

    <span class="token keyword keyword-return">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-8-open">}</span><span aria-hidden="true" class="line-numbers-rows"><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre>
  <div class="toolbar">
    <div class="toolbar-item">
      <button
        class="copy-to-clipboard-button"
        type="button"
        data-copy-state="copy"
      >
        <span>Copy</span>
      </button>
    </div>
  </div>
</div>
<p>This program prints:</p>
<pre>
This program is named Calculator
</pre>
<p>
  Because <code>getProgramName()</code> returns a const reference, when the line
  <code>return s_programName</code> is executed,
  <code>getProgramName()</code> will return a const reference to
  <code>s_programName</code> (thus avoiding making a copy). That const reference
  can then be used by the caller to access the value of
  <code>s_programName</code>, which is printed.
</p>
<div class="code-block code-block-2" style="margin: 8px 0; clear: both"></div>

<p class="cpp-section cpp-topline" style="clear: both">
  The object being returned by reference must exist after the function returns
</p>
<p>
  Using return by reference has one major caveat: the programmer
  <em>must</em> be sure that the object being referenced outlives the function
  returning the reference. Otherwise, the reference being returned will be left
  dangling (referencing an object that has been destroyed), and use of that
  reference will result in undefined behavior.
</p>
<p>
  In the program above, because <code>s_programName</code> has static duration,
  <code>s_programName</code> will exist until the end of the program. When
  <code>main()</code> accesses the returned reference, it is actually accessing
  <code>s_programName</code>, which is fine, because
  <code>s_programName</code> won’t be destroyed until later.
</p>
<p>
  Now let’s modify the above program to show what happens in the case where our
  function returns a dangling reference:
</p>
<div class="code-toolbar">
  <pre
    class="line-numbers language-cpp"
    tabindex="0"
  ><code class="match-braces language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string&gt;</span></span>

<span class="token keyword keyword-const">const</span> std<span class="token double-colon punctuation">::</span>string<span class="token operator">&amp;</span> <span class="token function">getProgramName</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-9-close">(</span><span class="token punctuation brace-round brace-close brace-level-1" id="pair-9-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-13-close">{</span>
    <span class="token keyword keyword-const">const</span> std<span class="token double-colon punctuation">::</span>string programName <span class="token punctuation brace-curly brace-open brace-level-2" id="pair-12-close">{</span> <span class="token string">"Calculator"</span> <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-12-open">}</span><span class="token punctuation">;</span> <span class="token comment">// now a non-static local variable, destroyed when function ends</span>

    <span class="token keyword keyword-return">return</span> programName<span class="token punctuation">;</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-13-open">}</span>

<span class="token keyword keyword-int">int</span> <span class="token function">main</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-10-close">(</span><span class="token punctuation brace-round brace-close brace-level-1" id="pair-10-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-14-close">{</span>
    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"This program is named "</span> <span class="token operator">&lt;&lt;</span> <span class="token function">getProgramName</span><span class="token punctuation brace-round brace-open brace-level-2" id="pair-11-close">(</span><span class="token punctuation brace-round brace-close brace-level-2" id="pair-11-open">)</span><span class="token punctuation">;</span> <span class="token comment">// undefined behavior</span>

    <span class="token keyword keyword-return">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-14-open">}</span><span aria-hidden="true" class="line-numbers-rows"><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre>
  <div class="toolbar">
    <div class="toolbar-item">
      <button
        class="copy-to-clipboard-button"
        type="button"
        data-copy-state="copy"
      >
        <span>Copy</span>
      </button>
    </div>
  </div>
</div>
<p>
  The result of this program is undefined. When
  <code>getProgramName()</code> returns, a reference bound to local variable
  <code>programName</code> is returned. Then, because
  <code>programName</code> is a local variable with automatic duration,
  <code>programName</code> is destroyed at the end of the function. That means
  the returned reference is now dangling, and use of <code>programName</code> in
  the <code>main()</code> function results in undefined behavior.
</p>
<div class="code-block code-block-3" style="margin: 8px 0; clear: both"></div>

<p>
  Modern compilers will produce a warning or error if you try to return a local
  variable by reference (so the above program may not even compile), but
  compilers sometimes have trouble detecting more complicated cases.
</p>
<div class="cpp-note cpp-lightredbackground" style="height: auto !important">
  <p class="cpp-note-title cpp-bottomline">Warning</p>
  <div
    class="google-auto-placed ap_container"
    style="width: 100%; height: auto; clear: both; text-align: center"
  >
    <ins
      data-ad-format="auto"
      class="adsbygoogle adsbygoogle-noablate"
      data-ad-client="ca-pub-0588844875925051"
      data-adsbygoogle-status="done"
      style="
        display: block;
        margin: auto;
        background-color: transparent;
        height: 0px;
      "
      data-ad-status="unfilled"
      ><div
        id="aswift_7_host"
        style="
          border: none;
          height: 0px;
          width: 995px;
          margin: 0px;
          padding: 0px;
          position: relative;
          visibility: visible;
          background-color: transparent;
          display: inline-block;
          overflow: hidden;
          opacity: 0;
        "
      >
        <iframe
          id="aswift_7"
          name="aswift_7"
          browsingtopics="true"
          style="
            left: 0px;
            position: absolute;
            top: 0px;
            border: 0px;
            width: 995px;
            height: 0px;
            min-height: auto;
            max-height: none;
            min-width: auto;
            max-width: none;
          "
          sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation"
          width="995"
          height="0"
          frameborder="0"
          marginwidth="0"
          marginheight="0"
          vspace="0"
          hspace="0"
          allowtransparency="true"
          scrolling="no"
          allow="attribution-reporting; run-ad-auction"
          src="https://googleads.g.doubleclick.net/pagead/ads?client=ca-pub-0588844875925051&amp;output=html&amp;h=280&amp;adk=2171842073&amp;adf=2484342630&amp;w=995&amp;abgtt=11&amp;fwrn=4&amp;fwrnh=100&amp;lmt=1751745297&amp;num_ads=1&amp;rafmt=1&amp;armr=3&amp;sem=mc&amp;pwprc=4633386603&amp;ad_type=text_image&amp;format=995x280&amp;url=https%3A%2F%2Fwww.learncpp.com%2Fcpp-tutorial%2Freturn-by-reference-and-return-by-address%2F&amp;fwr=0&amp;pra=3&amp;rh=200&amp;rw=994&amp;rpe=1&amp;resp_fmts=3&amp;wgl=1&amp;fa=27&amp;uach=WyJXaW5kb3dzIiwiMTkuMC4wIiwieDg2IiwiIiwiMTM3LjAuNzE1MS4xMjIiLG51bGwsMCxudWxsLCI2NCIsW1siR29vZ2xlIENocm9tZSIsIjEzNy4wLjcxNTEuMTIyIl0sWyJDaHJvbWl1bSIsIjEzNy4wLjcxNTEuMTIyIl0sWyJOb3QvQSlCcmFuZCIsIjI0LjAuMC4wIl1dLDBd&amp;dt=1751962749145&amp;bpp=1&amp;bdt=757&amp;idt=-M&amp;shv=r20250702&amp;mjsv=m202507020101&amp;ptt=9&amp;saldr=aa&amp;abxe=1&amp;cookie=ID%3D05f6e82287d810b4%3AT%3D1751962604%3ART%3D1751962604%3AS%3DALNI_MaQYA0TSAU2k8xwY5tqlN0xFCcd6g&amp;gpic=UID%3D00001157d9e27d0a%3AT%3D1751962604%3ART%3D1751962604%3AS%3DALNI_MYgtHzQJAQQXY_151HTGSSfVxE8_A&amp;eo_id_str=ID%3D52c21936d98c6d2b%3AT%3D1751962604%3ART%3D1751962604%3AS%3DAA-AfjZsJ15yjdEPJ8d11hPojsJQ&amp;prev_fmts=0x0%2C336x280%2C160x600%2C160x600&amp;nras=2&amp;correlator=3468958914472&amp;frm=20&amp;pv=1&amp;u_tz=480&amp;u_his=2&amp;u_h=600&amp;u_w=800&amp;u_ah=600&amp;u_aw=800&amp;u_cd=24&amp;u_sd=1&amp;dmc=8&amp;adx=43&amp;ady=1957&amp;biw=1080&amp;bih=1024&amp;scr_x=0&amp;scr_y=0&amp;eid=42531646%2C95353387%2C95362655%2C95365225%2C95365234%2C95359265%2C95365120%2C95365797%2C31092546&amp;oid=2&amp;pvsid=8113963793964551&amp;tmod=1708485235&amp;uas=0&amp;nvt=1&amp;fc=1408&amp;brdim=10%2C10%2C10%2C10%2C800%2C0%2C780%2C580%2C1080%2C1024&amp;vis=1&amp;rsz=%7C%7Cs%7C&amp;abl=NS&amp;fu=128&amp;bc=31&amp;bz=0.72&amp;td=1&amp;tdf=2&amp;psd=W251bGwsbnVsbCxudWxsLDNd&amp;nt=1&amp;ifi=8&amp;uci=a!8&amp;btvi=1&amp;fsb=1&amp;dtd=11"
          data-google-container-id="a!8"
          tabindex="0"
          title="Advertisement"
          aria-label="Advertisement"
          data-load-complete="true"
          data-google-query-id="CIyQkurprI4DFYZfDwIdVM0M8g"
        ></iframe></div
    ></ins>
  </div>
  <p>
    Objects returned by reference must live beyond the scope of the function
    returning the reference, or a dangling reference will result. Never return a
    (non-static) local variable or temporary by reference.
  </p>
</div>
<p class="cpp-section cpp-topline" style="clear: both">
  Lifetime extension doesn’t work across function boundaries
</p>
<p>Let’s take a look at an example where we return a temporary by reference:</p>
<div class="code-toolbar">
  <pre
    class="line-numbers language-cpp"
    tabindex="0"
  ><code class="match-braces language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>

<span class="token keyword keyword-const">const</span> <span class="token keyword keyword-int">int</span><span class="token operator">&amp;</span> <span class="token function">returnByConstReference</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-15-close">(</span><span class="token punctuation brace-round brace-close brace-level-1" id="pair-15-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-18-close">{</span>
    <span class="token keyword keyword-return">return</span> <span class="token number">5</span><span class="token punctuation">;</span> <span class="token comment">// returns const reference to temporary object</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-18-open">}</span>

<span class="token keyword keyword-int">int</span> <span class="token function">main</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-16-close">(</span><span class="token punctuation brace-round brace-close brace-level-1" id="pair-16-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-20-close">{</span>
    <span class="token keyword keyword-const">const</span> <span class="token keyword keyword-int">int</span><span class="token operator">&amp;</span> ref <span class="token punctuation brace-curly brace-open brace-level-2" id="pair-19-close">{</span> <span class="token function">returnByConstReference</span><span class="token punctuation brace-round brace-open brace-level-3" id="pair-17-close">(</span><span class="token punctuation brace-round brace-close brace-level-3" id="pair-17-open">)</span> <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-19-open">}</span><span class="token punctuation">;</span>

    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> ref<span class="token punctuation">;</span> <span class="token comment">// undefined behavior</span>

    <span class="token keyword keyword-return">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-20-open">}</span><span aria-hidden="true" class="line-numbers-rows"><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre>
  <div class="toolbar">
    <div class="toolbar-item">
      <button
        class="copy-to-clipboard-button"
        type="button"
        data-copy-state="copy"
      >
        <span>Copy</span>
      </button>
    </div>
  </div>
</div>
<p>
  In the above program, <code>returnByConstReference()</code> is returning an
  integer literal, but the return type of the function is
  <code>const int&amp;</code>. This results in the creation and return of a
  temporary reference bound to a temporary object holding value 5. This returned
  reference is copied into a temporary reference in the scope of the caller. The
  temporary object then goes out of scope, leaving the temporary reference in
  the scope of the caller dangling.
</p>
<p>
  By the time the temporary reference in the scope of the caller is bound to
  const reference variable <code>ref</code> (in <code>main()</code>), it is too
  late to extend the lifetime of the temporary object -- as it has already been
  destroyed. Thus <code>ref</code> is a dangling reference, and use of the value
  of <code>ref</code> will result in undefined behavior.
</p>
<div
  class="google-auto-placed ap_container"
  style="width: 100%; height: auto; clear: both; text-align: center"
>
  <ins
    data-ad-format="auto"
    class="adsbygoogle adsbygoogle-noablate"
    data-ad-client="ca-pub-0588844875925051"
    data-adsbygoogle-status="done"
    style="
      display: block;
      margin: auto;
      background-color: transparent;
      height: 0px;
    "
    data-ad-status="unfilled"
    ><div
      id="aswift_13_host"
      style="
        border: none;
        height: 0px;
        width: 1027px;
        margin: 0px;
        padding: 0px;
        position: relative;
        visibility: visible;
        background-color: transparent;
        display: inline-block;
        overflow: hidden;
        opacity: 0;
      "
    >
      <iframe
        id="aswift_13"
        name="aswift_13"
        browsingtopics="true"
        style="
          left: 0px;
          position: absolute;
          top: 0px;
          border: 0px;
          width: 1027px;
          height: 0px;
          min-height: auto;
          max-height: none;
          min-width: auto;
          max-width: none;
        "
        sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation"
        width="1027"
        height="0"
        frameborder="0"
        marginwidth="0"
        marginheight="0"
        vspace="0"
        hspace="0"
        allowtransparency="true"
        scrolling="no"
        allow="attribution-reporting; run-ad-auction"
        src="https://googleads.g.doubleclick.net/pagead/ads?client=ca-pub-0588844875925051&amp;output=html&amp;h=280&amp;adk=3119012778&amp;adf=3709266606&amp;w=1027&amp;abgtt=11&amp;fwrn=4&amp;fwrnh=100&amp;lmt=1751745297&amp;num_ads=1&amp;rafmt=1&amp;armr=3&amp;sem=mc&amp;pwprc=4633386603&amp;ad_type=text_image&amp;format=1027x280&amp;url=https%3A%2F%2Fwww.learncpp.com%2Fcpp-tutorial%2Freturn-by-reference-and-return-by-address%2F&amp;fwr=0&amp;pra=3&amp;rh=200&amp;rw=1026&amp;rpe=1&amp;resp_fmts=3&amp;wgl=1&amp;fa=27&amp;uach=WyJXaW5kb3dzIiwiMTkuMC4wIiwieDg2IiwiIiwiMTM3LjAuNzE1MS4xMjIiLG51bGwsMCxudWxsLCI2NCIsW1siR29vZ2xlIENocm9tZSIsIjEzNy4wLjcxNTEuMTIyIl0sWyJDaHJvbWl1bSIsIjEzNy4wLjcxNTEuMTIyIl0sWyJOb3QvQSlCcmFuZCIsIjI0LjAuMC4wIl1dLDBd&amp;dt=1751962749145&amp;bpp=1&amp;bdt=758&amp;idt=1&amp;shv=r20250702&amp;mjsv=m202507020101&amp;ptt=9&amp;saldr=aa&amp;abxe=1&amp;cookie=ID%3D05f6e82287d810b4%3AT%3D1751962604%3ART%3D1751962604%3AS%3DALNI_MaQYA0TSAU2k8xwY5tqlN0xFCcd6g&amp;gpic=UID%3D00001157d9e27d0a%3AT%3D1751962604%3ART%3D1751962604%3AS%3DALNI_MYgtHzQJAQQXY_151HTGSSfVxE8_A&amp;eo_id_str=ID%3D52c21936d98c6d2b%3AT%3D1751962604%3ART%3D1751962604%3AS%3DAA-AfjZsJ15yjdEPJ8d11hPojsJQ&amp;prev_fmts=0x0%2C336x280%2C160x600%2C160x600%2C995x280%2C995x280&amp;nras=4&amp;correlator=3468958914472&amp;frm=20&amp;pv=1&amp;u_tz=480&amp;u_his=2&amp;u_h=600&amp;u_w=800&amp;u_ah=600&amp;u_aw=800&amp;u_cd=24&amp;u_sd=1&amp;dmc=8&amp;adx=27&amp;ady=2810&amp;biw=1080&amp;bih=1024&amp;scr_x=0&amp;scr_y=0&amp;eid=42531646%2C95353387%2C95362655%2C95365225%2C95365234%2C95359265%2C95365120%2C95365797%2C31092546&amp;oid=2&amp;pvsid=8113963793964551&amp;tmod=1708485235&amp;uas=0&amp;nvt=1&amp;fc=1408&amp;brdim=10%2C10%2C10%2C10%2C800%2C0%2C780%2C580%2C1080%2C1024&amp;vis=1&amp;rsz=%7C%7Cs%7C&amp;abl=NS&amp;fu=128&amp;bc=31&amp;bz=0.72&amp;td=1&amp;tdf=2&amp;psd=W251bGwsbnVsbCxudWxsLDNd&amp;nt=1&amp;ifi=14&amp;uci=a!e&amp;btvi=3&amp;fsb=1&amp;dtd=13"
        data-google-container-id="a!e"
        tabindex="0"
        title="Advertisement"
        aria-label="Advertisement"
        data-load-complete="true"
        data-google-query-id="CI6jkurprI4DFSBfDwIduF8jlw"
      ></iframe></div
  ></ins>
</div>
<div class="code-block code-block-4" style="margin: 8px 0; clear: both"></div>

<p>Here’s a less obvious example that similarly doesn’t work:</p>
<div class="code-toolbar">
  <pre
    class="line-numbers language-cpp"
    tabindex="0"
  ><code class="match-braces language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>

<span class="token keyword keyword-const">const</span> <span class="token keyword keyword-int">int</span><span class="token operator">&amp;</span> <span class="token function">returnByConstReference</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-21-close">(</span><span class="token keyword keyword-const">const</span> <span class="token keyword keyword-int">int</span><span class="token operator">&amp;</span> ref<span class="token punctuation brace-round brace-close brace-level-1" id="pair-21-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-24-close">{</span>
    <span class="token keyword keyword-return">return</span> ref<span class="token punctuation">;</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-24-open">}</span>

<span class="token keyword keyword-int">int</span> <span class="token function">main</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-22-close">(</span><span class="token punctuation brace-round brace-close brace-level-1" id="pair-22-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-27-close">{</span>
    <span class="token comment">// case 1: direct binding</span>
    <span class="token keyword keyword-const">const</span> <span class="token keyword keyword-int">int</span><span class="token operator">&amp;</span> ref1 <span class="token punctuation brace-curly brace-open brace-level-2" id="pair-25-close">{</span> <span class="token number">5</span> <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-25-open">}</span><span class="token punctuation">;</span> <span class="token comment">// extends lifetime</span>
    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> ref1 <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span><span class="token punctuation">;</span> <span class="token comment">// okay</span>

    <span class="token comment">// case 2: indirect binding</span>
    <span class="token keyword keyword-const">const</span> <span class="token keyword keyword-int">int</span><span class="token operator">&amp;</span> ref2 <span class="token punctuation brace-curly brace-open brace-level-2" id="pair-26-close">{</span> <span class="token function">returnByConstReference</span><span class="token punctuation brace-round brace-open brace-level-3" id="pair-23-close">(</span><span class="token number">5</span><span class="token punctuation brace-round brace-close brace-level-3" id="pair-23-open">)</span> <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-26-open">}</span><span class="token punctuation">;</span> <span class="token comment">// binds to dangling reference</span>
    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> ref2 <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span><span class="token punctuation">;</span> <span class="token comment">// undefined behavior</span>

    <span class="token keyword keyword-return">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-27-open">}</span><span aria-hidden="true" class="line-numbers-rows"><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre>
  <div class="toolbar">
    <div class="toolbar-item">
      <button
        class="copy-to-clipboard-button"
        type="button"
        data-copy-state="copy"
      >
        <span>Copy</span>
      </button>
    </div>
  </div>
</div>
<p>
  In case 2, a temporary object is created to hold value <code>5</code>, which
  function parameter <code>ref</code> binds to. The function just returns this
  reference back to the caller, which then uses the reference to initialize
  <code>ref2</code>. Because this is not a direct binding to the temporary
  object (as the refrence was bounced through a function), lifetime extension
  doesn’t apply. This leaves <code>ref2</code> dangling, and its subsequent use
  is undefined behavior.
</p>
<div class="cpp-note cpp-lightredbackground" style="height: auto !important">
  <p class="cpp-note-title cpp-bottomline">Warning</p>
  <div
    class="google-auto-placed ap_container"
    style="width: 100%; height: auto; clear: both; text-align: center"
  >
    <ins
      data-ad-format="auto"
      class="adsbygoogle adsbygoogle-noablate"
      data-ad-client="ca-pub-0588844875925051"
      data-adsbygoogle-status="done"
      style="
        display: block;
        margin: auto;
        background-color: transparent;
        height: 0px;
      "
      data-ad-status="unfilled"
      ><div
        id="aswift_11_host"
        style="
          border: none;
          height: 0px;
          width: 995px;
          margin: 0px;
          padding: 0px;
          position: relative;
          visibility: visible;
          background-color: transparent;
          display: inline-block;
          overflow: hidden;
          opacity: 0;
        "
      >
        <iframe
          id="aswift_11"
          name="aswift_11"
          browsingtopics="true"
          style="
            left: 0px;
            position: absolute;
            top: 0px;
            border: 0px;
            width: 995px;
            height: 0px;
            min-height: auto;
            max-height: none;
            min-width: auto;
            max-width: none;
          "
          sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation"
          width="995"
          height="0"
          frameborder="0"
          marginwidth="0"
          marginheight="0"
          vspace="0"
          hspace="0"
          allowtransparency="true"
          scrolling="no"
          allow="attribution-reporting; run-ad-auction"
          src="https://googleads.g.doubleclick.net/pagead/ads?client=ca-pub-0588844875925051&amp;output=html&amp;h=280&amp;adk=2171842073&amp;adf=791362395&amp;w=995&amp;abgtt=11&amp;fwrn=4&amp;fwrnh=100&amp;lmt=1751745297&amp;num_ads=1&amp;rafmt=1&amp;armr=3&amp;sem=mc&amp;pwprc=4633386603&amp;ad_type=text_image&amp;format=995x280&amp;url=https%3A%2F%2Fwww.learncpp.com%2Fcpp-tutorial%2Freturn-by-reference-and-return-by-address%2F&amp;fwr=0&amp;pra=3&amp;rh=200&amp;rw=994&amp;rpe=1&amp;resp_fmts=3&amp;wgl=1&amp;fa=27&amp;uach=WyJXaW5kb3dzIiwiMTkuMC4wIiwieDg2IiwiIiwiMTM3LjAuNzE1MS4xMjIiLG51bGwsMCxudWxsLCI2NCIsW1siR29vZ2xlIENocm9tZSIsIjEzNy4wLjcxNTEuMTIyIl0sWyJDaHJvbWl1bSIsIjEzNy4wLjcxNTEuMTIyIl0sWyJOb3QvQSlCcmFuZCIsIjI0LjAuMC4wIl1dLDBd&amp;dt=1751962749145&amp;bpp=1&amp;bdt=758&amp;idt=-M&amp;shv=r20250702&amp;mjsv=m202507020101&amp;ptt=9&amp;saldr=aa&amp;abxe=1&amp;cookie=ID%3D05f6e82287d810b4%3AT%3D1751962604%3ART%3D1751962604%3AS%3DALNI_MaQYA0TSAU2k8xwY5tqlN0xFCcd6g&amp;gpic=UID%3D00001157d9e27d0a%3AT%3D1751962604%3ART%3D1751962604%3AS%3DALNI_MYgtHzQJAQQXY_151HTGSSfVxE8_A&amp;eo_id_str=ID%3D52c21936d98c6d2b%3AT%3D1751962604%3ART%3D1751962604%3AS%3DAA-AfjZsJ15yjdEPJ8d11hPojsJQ&amp;prev_fmts=0x0%2C336x280%2C160x600%2C160x600%2C995x280&amp;nras=3&amp;correlator=3468958914472&amp;frm=20&amp;pv=1&amp;u_tz=480&amp;u_his=2&amp;u_h=600&amp;u_w=800&amp;u_ah=600&amp;u_aw=800&amp;u_cd=24&amp;u_sd=1&amp;dmc=8&amp;adx=43&amp;ady=3609&amp;biw=1080&amp;bih=1024&amp;scr_x=0&amp;scr_y=0&amp;eid=42531646%2C95353387%2C95362655%2C95365225%2C95365234%2C95359265%2C95365120%2C95365797%2C31092546&amp;oid=2&amp;pvsid=8113963793964551&amp;tmod=1708485235&amp;uas=0&amp;nvt=1&amp;fc=1408&amp;brdim=10%2C10%2C10%2C10%2C800%2C0%2C780%2C580%2C1080%2C1024&amp;vis=1&amp;rsz=%7C%7Cs%7C&amp;abl=NS&amp;fu=128&amp;bc=31&amp;bz=0.72&amp;td=1&amp;tdf=2&amp;psd=W251bGwsbnVsbCxudWxsLDNd&amp;nt=1&amp;ifi=12&amp;uci=a!c&amp;btvi=2&amp;fsb=1&amp;dtd=12"
          data-google-container-id="a!c"
          tabindex="0"
          title="Advertisement"
          aria-label="Advertisement"
          data-load-complete="true"
          data-google-query-id="CJijkurprI4DFbxhDwIdWW0D9w"
        ></iframe></div
    ></ins>
  </div>
  <p>Reference lifetime extension does not work across function boundaries.</p>
</div>
<p class="cpp-section cpp-topline" style="clear: both">
  Don’t return non-const static local variables by reference
</p>
<p>
  In the original example above, we returned a const static local variable by
  reference to illustrate the mechanics of return by reference in a simple way.
  However, returning non-const static local variables by reference is fairly
  non-idiomatic, and should generally be avoided. Here’s a simplified example
  that illustrates one such problem that can occur:
</p>
<div class="code-toolbar">
  <pre
    class="line-numbers language-cpp"
    tabindex="0"
  ><code class="match-braces language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string&gt;</span></span>

<span class="token keyword keyword-const">const</span> <span class="token keyword keyword-int">int</span><span class="token operator">&amp;</span> <span class="token function">getNextId</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-28-close">(</span><span class="token punctuation brace-round brace-close brace-level-1" id="pair-28-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-33-close">{</span>
    <span class="token keyword keyword-static">static</span> <span class="token keyword keyword-int">int</span> s_x<span class="token punctuation brace-curly brace-open brace-level-2" id="pair-32-close">{</span> <span class="token number">0</span> <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-32-open">}</span><span class="token punctuation">;</span> <span class="token comment">// note: variable is non-const</span>
    <span class="token operator">++</span>s_x<span class="token punctuation">;</span> <span class="token comment">// generate the next id</span>
    <span class="token keyword keyword-return">return</span> s_x<span class="token punctuation">;</span> <span class="token comment">// and return a reference to it</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-33-open">}</span>

<span class="token keyword keyword-int">int</span> <span class="token function">main</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-29-close">(</span><span class="token punctuation brace-round brace-close brace-level-1" id="pair-29-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-36-close">{</span>
    <span class="token keyword keyword-const">const</span> <span class="token keyword keyword-int">int</span><span class="token operator">&amp;</span> id1 <span class="token punctuation brace-curly brace-open brace-level-2" id="pair-34-close">{</span> <span class="token function">getNextId</span><span class="token punctuation brace-round brace-open brace-level-3" id="pair-30-close">(</span><span class="token punctuation brace-round brace-close brace-level-3" id="pair-30-open">)</span> <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-34-open">}</span><span class="token punctuation">;</span> <span class="token comment">// id1 is a reference</span>
    <span class="token keyword keyword-const">const</span> <span class="token keyword keyword-int">int</span><span class="token operator">&amp;</span> id2 <span class="token punctuation brace-curly brace-open brace-level-2" id="pair-35-close">{</span> <span class="token function">getNextId</span><span class="token punctuation brace-round brace-open brace-level-3" id="pair-31-close">(</span><span class="token punctuation brace-round brace-close brace-level-3" id="pair-31-open">)</span> <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-35-open">}</span><span class="token punctuation">;</span> <span class="token comment">// id2 is a reference</span>

    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> id1 <span class="token operator">&lt;&lt;</span> id2 <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span><span class="token punctuation">;</span>

    <span class="token keyword keyword-return">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-36-open">}</span><span aria-hidden="true" class="line-numbers-rows"><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre>
  <div class="toolbar">
    <div class="toolbar-item">
      <button
        class="copy-to-clipboard-button"
        type="button"
        data-copy-state="copy"
      >
        <span>Copy</span>
      </button>
    </div>
  </div>
</div>
<p>This program prints:</p>
<pre>
22
</pre>
<div
  class="google-auto-placed ap_container"
  style="width: 100%; height: auto; clear: both; text-align: center"
>
  <ins
    data-ad-format="auto"
    class="adsbygoogle adsbygoogle-noablate"
    data-ad-client="ca-pub-0588844875925051"
    data-adsbygoogle-status="done"
    style="
      display: block;
      margin: auto;
      background-color: transparent;
      height: 0px;
    "
    data-ad-status="unfilled"
    ><div
      id="aswift_12_host"
      style="
        border: none;
        height: 0px;
        width: 1027px;
        margin: 0px;
        padding: 0px;
        position: relative;
        visibility: visible;
        background-color: transparent;
        display: inline-block;
        overflow: hidden;
        opacity: 0;
      "
    >
      <iframe
        id="aswift_12"
        name="aswift_12"
        browsingtopics="true"
        style="
          left: 0px;
          position: absolute;
          top: 0px;
          border: 0px;
          width: 1027px;
          height: 0px;
          min-height: auto;
          max-height: none;
          min-width: auto;
          max-width: none;
        "
        sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation"
        width="1027"
        height="0"
        frameborder="0"
        marginwidth="0"
        marginheight="0"
        vspace="0"
        hspace="0"
        allowtransparency="true"
        scrolling="no"
        allow="attribution-reporting; run-ad-auction"
        src="https://googleads.g.doubleclick.net/pagead/ads?client=ca-pub-0588844875925051&amp;output=html&amp;h=280&amp;adk=3119012778&amp;adf=2309439046&amp;w=1027&amp;abgtt=11&amp;fwrn=4&amp;fwrnh=100&amp;lmt=1751745297&amp;num_ads=1&amp;rafmt=1&amp;armr=3&amp;sem=mc&amp;pwprc=4633386603&amp;ad_type=text_image&amp;format=1027x280&amp;url=https%3A%2F%2Fwww.learncpp.com%2Fcpp-tutorial%2Freturn-by-reference-and-return-by-address%2F&amp;fwr=0&amp;pra=3&amp;rh=200&amp;rw=1026&amp;rpe=1&amp;resp_fmts=3&amp;wgl=1&amp;fa=27&amp;uach=WyJXaW5kb3dzIiwiMTkuMC4wIiwieDg2IiwiIiwiMTM3LjAuNzE1MS4xMjIiLG51bGwsMCxudWxsLCI2NCIsW1siR29vZ2xlIENocm9tZSIsIjEzNy4wLjcxNTEuMTIyIl0sWyJDaHJvbWl1bSIsIjEzNy4wLjcxNTEuMTIyIl0sWyJOb3QvQSlCcmFuZCIsIjI0LjAuMC4wIl1dLDBd&amp;dt=1751962749142&amp;bpp=1&amp;bdt=754&amp;idt=0&amp;shv=r20250702&amp;mjsv=m202507020101&amp;ptt=9&amp;saldr=aa&amp;abxe=1&amp;cookie=ID%3D05f6e82287d810b4%3AT%3D1751962604%3ART%3D1751962604%3AS%3DALNI_MaQYA0TSAU2k8xwY5tqlN0xFCcd6g&amp;gpic=UID%3D00001157d9e27d0a%3AT%3D1751962604%3ART%3D1751962604%3AS%3DALNI_MYgtHzQJAQQXY_151HTGSSfVxE8_A&amp;eo_id_str=ID%3D52c21936d98c6d2b%3AT%3D1751962604%3ART%3D1751962604%3AS%3DAA-AfjZsJ15yjdEPJ8d11hPojsJQ&amp;prev_fmts=0x0%2C336x280%2C160x600%2C160x600%2C995x280%2C995x280%2C1027x280&amp;nras=5&amp;correlator=3468958914472&amp;frm=20&amp;pv=1&amp;u_tz=480&amp;u_his=2&amp;u_h=600&amp;u_w=800&amp;u_ah=600&amp;u_aw=800&amp;u_cd=24&amp;u_sd=1&amp;dmc=8&amp;adx=27&amp;ady=3671&amp;biw=1080&amp;bih=1024&amp;scr_x=0&amp;scr_y=0&amp;eid=42531646%2C95353387%2C95362655%2C95365225%2C95365234%2C95359265%2C95365120%2C95365797%2C31092546&amp;oid=2&amp;pvsid=8113963793964551&amp;tmod=1708485235&amp;uas=0&amp;nvt=1&amp;fc=1408&amp;brdim=10%2C10%2C10%2C10%2C800%2C0%2C780%2C580%2C1080%2C1024&amp;vis=1&amp;rsz=%7C%7Cs%7C&amp;abl=NS&amp;fu=128&amp;bc=31&amp;bz=0.72&amp;td=1&amp;tdf=2&amp;psd=W251bGwsbnVsbCxudWxsLDNd&amp;nt=1&amp;ifi=13&amp;uci=a!d&amp;btvi=4&amp;fsb=1&amp;dtd=266"
        data-google-container-id="a!d"
        tabindex="0"
        title="Advertisement"
        aria-label="Advertisement"
        data-load-complete="true"
        data-google-query-id="CL3ToerprI4DFbdkDwIduu0icw"
      ></iframe></div
  ></ins>
</div>
<p>
  This happens because <code>id1</code> and <code>id2</code> are referencing the
  same object (the static variable <code>s_x</code>), so when anything (e.g.
  <code>getNextId()</code>) modifies that value, all references are now
  accessing the modified value.
</p>
<div class="code-block code-block-5" style="margin: 8px 0; clear: both"></div>

<p>
  This above example can be fixed by making <code>id1</code> and
  <code>id2</code> normal variables (rather than references) so they save a copy
  of the return value rather than a reference to <code>s_x</code>.
</p>
<div class="cpp-note cpp-lightgraybackground">
  <p class="cpp-note-title cpp-bottomline">For advanced readers</p>
  <p>Here’s another example with a less obvious version of the same problem:</p>
  <div class="code-toolbar">
    <pre
      class="line-numbers language-cpp"
      tabindex="0"
    ><code class="match-braces language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string_view&gt;</span></span>

std<span class="token double-colon punctuation">::</span>string<span class="token operator">&amp;</span> <span class="token function">getName</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-37-close">(</span><span class="token punctuation brace-round brace-close brace-level-1" id="pair-37-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-45-close">{</span>
    <span class="token keyword keyword-static">static</span> std<span class="token double-colon punctuation">::</span>string s_name<span class="token punctuation brace-curly brace-open brace-level-2" id="pair-44-close">{</span><span class="token punctuation brace-curly brace-close brace-level-2" id="pair-44-open">}</span><span class="token punctuation">;</span>
    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Enter a name: "</span><span class="token punctuation">;</span>
    std<span class="token double-colon punctuation">::</span>cin <span class="token operator">&gt;&gt;</span> s_name<span class="token punctuation">;</span>
    <span class="token keyword keyword-return">return</span> s_name<span class="token punctuation">;</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-45-open">}</span>

<span class="token keyword keyword-void">void</span> <span class="token function">printFirstAlphabetical</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-38-close">(</span><span class="token keyword keyword-const">const</span> std<span class="token double-colon punctuation">::</span>string<span class="token operator">&amp;</span> s1<span class="token punctuation">,</span> <span class="token keyword keyword-const">const</span> std<span class="token double-colon punctuation">::</span>string<span class="token operator">&amp;</span> s2<span class="token punctuation brace-round brace-close brace-level-1" id="pair-38-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-46-close">{</span>
    <span class="token keyword keyword-if">if</span> <span class="token punctuation brace-round brace-open brace-level-2" id="pair-39-close">(</span>s1 <span class="token operator">&lt;</span> s2<span class="token punctuation brace-round brace-close brace-level-2" id="pair-39-open">)</span>
        std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> s1 <span class="token operator">&lt;&lt;</span> <span class="token string">" comes before "</span> <span class="token operator">&lt;&lt;</span> s2 <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-else">else</span>
        std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> s2 <span class="token operator">&lt;&lt;</span> <span class="token string">" comes before "</span> <span class="token operator">&lt;&lt;</span> s1 <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span><span class="token punctuation">;</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-46-open">}</span>

<span class="token keyword keyword-int">int</span> <span class="token function">main</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-40-close">(</span><span class="token punctuation brace-round brace-close brace-level-1" id="pair-40-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-47-close">{</span>
    <span class="token function">printFirstAlphabetical</span><span class="token punctuation brace-round brace-open brace-level-2" id="pair-43-close">(</span><span class="token function">getName</span><span class="token punctuation brace-round brace-open brace-level-3" id="pair-41-close">(</span><span class="token punctuation brace-round brace-close brace-level-3" id="pair-41-open">)</span><span class="token punctuation">,</span> <span class="token function">getName</span><span class="token punctuation brace-round brace-open brace-level-3" id="pair-42-close">(</span><span class="token punctuation brace-round brace-close brace-level-3" id="pair-42-open">)</span><span class="token punctuation brace-round brace-close brace-level-2" id="pair-43-open">)</span><span class="token punctuation">;</span>

    <span class="token keyword keyword-return">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-47-open">}</span><span aria-hidden="true" class="line-numbers-rows"><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre>
    <div class="toolbar">
      <div class="toolbar-item">
        <button
          class="copy-to-clipboard-button"
          type="button"
          data-copy-state="copy"
        >
          <span>Copy</span>
        </button>
      </div>
    </div>
  </div>
  <p>Here’s the result from one run of this program:</p>
  <pre>
Enter a name: Dave
Enter a name: Stan
Stan comes before Stan
</pre
  >
  <p>
    In this example, <code>getName()</code> returns a reference to static local
    <code>s_name</code>. Initializing a <code>const std::string&amp;</code> with
    a reference to <code>s_name</code> causes that
    <code>std::string&amp;</code> to bind to <code>s_name</code> (not make a
    copy of it).
  </p>
  <p>
    Thus, both <code>s1</code> and <code>s2</code> end up viewing
    <code>s_name</code> (which was assigned the last name we entered).
  </p>
  <div
    class="google-auto-placed ap_container"
    style="width: 100%; height: auto; clear: both; text-align: center"
  >
    <ins
      data-ad-format="auto"
      class="adsbygoogle adsbygoogle-noablate"
      data-ad-client="ca-pub-0588844875925051"
      data-adsbygoogle-status="done"
      style="
        display: block;
        margin: auto;
        background-color: transparent;
        height: 280px;
      "
      ><div
        id="aswift_4_host"
        style="
          border: none;
          height: 280px;
          width: 995px;
          margin: 0px;
          padding: 0px;
          position: relative;
          visibility: visible;
          background-color: transparent;
          display: inline-block;
        "
      ></div
    ></ins>
  </div>
  <p>
    Note that if we use <code>std::string_view</code> parameters instead, the
    first <code>std::string_view</code> parameter will be invalidated when the
    underlying <code>std::string</code> is changed.
  </p>
</div>
<p>
  Another issue that commonly occurs with programs that return a non-const
  static local by reference is that there is no standardized way to reset
  <code>s_x</code> back to the default state. Such programs must either use a
  non-conventional solution (e.g. a reset function parameter), or can only be
  reset by quitting and restarting the program.
</p>
<div class="cpp-note cpp-lightgreenbackground">
  <p class="cpp-note-title cpp-bottomline">Best practice</p>
  <p>Avoid returning references to non-const local static variables.</p>
</div>
<p>
  Returning a const reference to a <em>const</em> local static variable is
  sometimes done if the local variable being returned by reference is expensive
  to create and/or initialize (so we don’t have to recreate the variable every
  function call). But this is rare.
</p>
<div
  class="google-auto-placed ap_container"
  style="width: 100%; height: auto; clear: both; text-align: center"
>
  <ins
    data-ad-format="auto"
    class="adsbygoogle adsbygoogle-noablate"
    data-ad-client="ca-pub-0588844875925051"
    data-adsbygoogle-status="done"
    style="
      display: block;
      margin: auto;
      background-color: transparent;
      height: 280px;
    "
    ><div
      id="aswift_8_host"
      style="
        border: none;
        height: 280px;
        width: 1027px;
        margin: 0px;
        padding: 0px;
        position: relative;
        visibility: visible;
        background-color: transparent;
        display: inline-block;
      "
    ></div
  ></ins>
</div>
<p>
  Returning a const reference to a <em>const</em> global variable is also
  sometimes done as a way to encapsulate access to a global variable. We discuss
  this in lesson
  <a
    href="https://www.learncpp.com/cpp-tutorial/why-non-const-global-variables-are-evil/"
    >7.8 -- Why (non-const) global variables are evil</a
  >. When used intentionally and carefully, this is also okay.
</p>
<p class="cpp-section cpp-topline" style="clear: both">
  Assigning/initializing a normal variable with a returned reference makes a
  copy
</p>
<div class="code-block code-block-6" style="margin: 8px 0; clear: both"></div>

<p>
  If a function returns a reference, and that reference is used to initialize or
  assign to a non-reference variable, the return value will be copied (as if it
  had been returned by value).
</p>
<div class="code-toolbar">
  <pre
    class="line-numbers language-cpp"
    tabindex="0"
  ><code class="match-braces language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string&gt;</span></span>

<span class="token keyword keyword-const">const</span> <span class="token keyword keyword-int">int</span><span class="token operator">&amp;</span> <span class="token function">getNextId</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-48-close">(</span><span class="token punctuation brace-round brace-close brace-level-1" id="pair-48-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-53-close">{</span>
    <span class="token keyword keyword-static">static</span> <span class="token keyword keyword-int">int</span> s_x<span class="token punctuation brace-curly brace-open brace-level-2" id="pair-52-close">{</span> <span class="token number">0</span> <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-52-open">}</span><span class="token punctuation">;</span>
    <span class="token operator">++</span>s_x<span class="token punctuation">;</span>
    <span class="token keyword keyword-return">return</span> s_x<span class="token punctuation">;</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-53-open">}</span>

<span class="token keyword keyword-int">int</span> <span class="token function">main</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-49-close">(</span><span class="token punctuation brace-round brace-close brace-level-1" id="pair-49-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-56-close">{</span>
    <span class="token keyword keyword-const">const</span> <span class="token keyword keyword-int">int</span> id1 <span class="token punctuation brace-curly brace-open brace-level-2" id="pair-54-close">{</span> <span class="token function">getNextId</span><span class="token punctuation brace-round brace-open brace-level-3" id="pair-50-close">(</span><span class="token punctuation brace-round brace-close brace-level-3" id="pair-50-open">)</span> <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-54-open">}</span><span class="token punctuation">;</span> <span class="token comment">// id1 is a normal variable now and receives a copy of the value returned by reference from getNextId()</span>
    <span class="token keyword keyword-const">const</span> <span class="token keyword keyword-int">int</span> id2 <span class="token punctuation brace-curly brace-open brace-level-2" id="pair-55-close">{</span> <span class="token function">getNextId</span><span class="token punctuation brace-round brace-open brace-level-3" id="pair-51-close">(</span><span class="token punctuation brace-round brace-close brace-level-3" id="pair-51-open">)</span> <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-55-open">}</span><span class="token punctuation">;</span> <span class="token comment">// id2 is a normal variable now and receives a copy of the value returned by reference from getNextId()</span>

    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> id1 <span class="token operator">&lt;&lt;</span> id2 <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span><span class="token punctuation">;</span>

    <span class="token keyword keyword-return">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-56-open">}</span><span aria-hidden="true" class="line-numbers-rows"><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 32px;"></span><span style="height: 32px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre>
  <div class="toolbar">
    <div class="toolbar-item">
      <button
        class="copy-to-clipboard-button"
        type="button"
        data-copy-state="copy"
      >
        <span>Copy</span>
      </button>
    </div>
  </div>
</div>
<p>
  In the above example, <code>getNextId()</code> is returning a reference, but
  <code>id1</code> and <code>id2</code> are non-reference variables. In such a
  case, the value of the returned reference is copied into the normal variable.
  Thus, this program prints:
</p>
<pre>
12
</pre>
<p>
  Also note that if a program returns a dangling reference, the reference is
  left dangling before the copy is made, which will lead to undefined behavior:
</p>
<div class="code-toolbar">
  <pre
    class="line-numbers language-cpp"
    tabindex="0"
  ><code class="match-braces language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string&gt;</span></span>

<span class="token keyword keyword-const">const</span> std<span class="token double-colon punctuation">::</span>string<span class="token operator">&amp;</span> <span class="token function">getProgramName</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-57-close">(</span><span class="token punctuation brace-round brace-close brace-level-1" id="pair-57-open">)</span> <span class="token comment">// will return a const reference</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-61-close">{</span>
    <span class="token keyword keyword-const">const</span> std<span class="token double-colon punctuation">::</span>string programName<span class="token punctuation brace-curly brace-open brace-level-2" id="pair-60-close">{</span> <span class="token string">"Calculator"</span> <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-60-open">}</span><span class="token punctuation">;</span>

    <span class="token keyword keyword-return">return</span> programName<span class="token punctuation">;</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-61-open">}</span>

<span class="token keyword keyword-int">int</span> <span class="token function">main</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-58-close">(</span><span class="token punctuation brace-round brace-close brace-level-1" id="pair-58-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-63-close">{</span>
    std<span class="token double-colon punctuation">::</span>string name <span class="token punctuation brace-curly brace-open brace-level-2" id="pair-62-close">{</span> <span class="token function">getProgramName</span><span class="token punctuation brace-round brace-open brace-level-3" id="pair-59-close">(</span><span class="token punctuation brace-round brace-close brace-level-3" id="pair-59-open">)</span> <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-62-open">}</span><span class="token punctuation">;</span> <span class="token comment">// makes a copy of a dangling reference</span>
    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"This program is named "</span> <span class="token operator">&lt;&lt;</span> name <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span><span class="token punctuation">;</span> <span class="token comment">// undefined behavior</span>

    <span class="token keyword keyword-return">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-63-open">}</span><span aria-hidden="true" class="line-numbers-rows"><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre>
  <div class="toolbar">
    <div class="toolbar-item">
      <button
        class="copy-to-clipboard-button"
        type="button"
        data-copy-state="copy"
      >
        <span>Copy</span>
      </button>
    </div>
  </div>
</div>
<p class="cpp-section cpp-topline" style="clear: both">
  It’s okay to return reference parameters by reference
</p>
<div
  class="google-auto-placed ap_container"
  style="width: 100%; height: auto; clear: both; text-align: center"
>
  <ins
    data-ad-format="auto"
    class="adsbygoogle adsbygoogle-noablate"
    data-ad-client="ca-pub-0588844875925051"
    data-adsbygoogle-status="done"
    style="
      display: block;
      margin: auto;
      background-color: transparent;
      height: 280px;
    "
    ><div
      id="aswift_6_host"
      style="
        border: none;
        height: 280px;
        width: 1027px;
        margin: 0px;
        padding: 0px;
        position: relative;
        visibility: visible;
        background-color: transparent;
        display: inline-block;
      "
    ></div
  ></ins>
</div>
<p>
  There are quite a few cases where returning objects by reference makes sense,
  and we’ll encounter many of those in future lessons. However, there is one
  useful example that we can show now.
</p>
<div class="code-block code-block-7" style="margin: 8px 0; clear: both"></div>

<p>
  If a parameter is passed into a function by reference, it’s safe to return
  that parameter by reference. This makes sense: in order to pass an argument to
  a function, the argument must exist in the scope of the caller. When the
  called function returns, that object must still exist in the scope of the
  caller.
</p>
<p>Here is a simple example of such a function:</p>
<div class="code-toolbar">
  <pre
    class="line-numbers language-cpp"
    tabindex="0"
  ><code class="match-braces language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string&gt;</span></span>

<span class="token comment">// Takes two std::string objects, returns the one that comes first alphabetically</span>
<span class="token keyword keyword-const">const</span> std<span class="token double-colon punctuation">::</span>string<span class="token operator">&amp;</span> <span class="token function">firstAlphabetical</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-64-close">(</span><span class="token keyword keyword-const">const</span> std<span class="token double-colon punctuation">::</span>string<span class="token operator">&amp;</span> a<span class="token punctuation">,</span> <span class="token keyword keyword-const">const</span> std<span class="token double-colon punctuation">::</span>string<span class="token operator">&amp;</span> b<span class="token punctuation brace-round brace-close brace-level-1" id="pair-64-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-68-close">{</span>
	<span class="token keyword keyword-return">return</span> <span class="token punctuation brace-round brace-open brace-level-2" id="pair-65-close">(</span>a <span class="token operator">&lt;</span> b<span class="token punctuation brace-round brace-close brace-level-2" id="pair-65-open">)</span> <span class="token operator">?</span> a <span class="token operator">:</span> b<span class="token punctuation">;</span> <span class="token comment">// We can use operator&lt; on std::string to determine which comes first alphabetically</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-68-open">}</span>

<span class="token keyword keyword-int">int</span> <span class="token function">main</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-66-close">(</span><span class="token punctuation brace-round brace-close brace-level-1" id="pair-66-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-71-close">{</span>
	std<span class="token double-colon punctuation">::</span>string hello <span class="token punctuation brace-curly brace-open brace-level-2" id="pair-69-close">{</span> <span class="token string">"Hello"</span> <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-69-open">}</span><span class="token punctuation">;</span>
	std<span class="token double-colon punctuation">::</span>string world <span class="token punctuation brace-curly brace-open brace-level-2" id="pair-70-close">{</span> <span class="token string">"World"</span> <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-70-open">}</span><span class="token punctuation">;</span>

	std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token function">firstAlphabetical</span><span class="token punctuation brace-round brace-open brace-level-2" id="pair-67-close">(</span>hello<span class="token punctuation">,</span> world<span class="token punctuation brace-round brace-close brace-level-2" id="pair-67-open">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span><span class="token punctuation">;</span>

	<span class="token keyword keyword-return">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-71-open">}</span><span aria-hidden="true" class="line-numbers-rows"><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre>
  <div class="toolbar">
    <div class="toolbar-item">
      <button
        class="copy-to-clipboard-button"
        type="button"
        data-copy-state="copy"
      >
        <span>Copy</span>
      </button>
    </div>
  </div>
</div>
<p>This prints:</p>
<pre>
Hello
</pre>
<div
  class="google-auto-placed ap_container"
  style="width: 100%; height: auto; clear: both; text-align: center"
>
  <ins
    data-ad-format="auto"
    class="adsbygoogle adsbygoogle-noablate"
    data-ad-client="ca-pub-0588844875925051"
    data-adsbygoogle-status="done"
    style="
      display: block;
      margin: auto;
      background-color: transparent;
      height: 280px;
    "
    ><div
      id="aswift_5_host"
      style="
        border: none;
        height: 280px;
        width: 1027px;
        margin: 0px;
        padding: 0px;
        position: relative;
        visibility: visible;
        background-color: transparent;
        display: inline-block;
      "
    ></div
  ></ins>
</div>
<p>
  In the above function, the caller passes in two std::string objects by const
  reference, and whichever of these strings comes first alphabetically is passed
  back by const reference. If we had used pass by value and return by value, we
  would have made up to 3 copies of std::string (one for each parameter, one for
  the return value). By using pass by reference/return by reference, we can
  avoid those copies.
</p>
<p class="cpp-section cpp-topline" style="clear: both">
  It’s okay for an rvalue passed by const reference to be returned by const
  reference
</p>
<div class="code-block code-block-8" style="margin: 8px 0; clear: both"></div>

<p>
  When an argument for a const reference parameter is an rvalue, it’s still okay
  to return that parameter by const reference.
</p>
<p>
  This is because rvalues are not destroyed until the end of the full expression
  in which they are created.
</p>
<p>First, let’s look at this example:</p>
<div class="code-toolbar">
  <pre
    class="line-numbers language-cpp"
    tabindex="0"
  ><code class="match-braces language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string&gt;</span></span>

std<span class="token double-colon punctuation">::</span>string <span class="token function">getHello</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-72-close">(</span><span class="token punctuation brace-round brace-close brace-level-1" id="pair-72-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-75-close">{</span>
    <span class="token keyword keyword-return">return</span> <span class="token string">"Hello"</span><span class="token punctuation">;</span> <span class="token comment">// implicit conversion to std::string</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-75-open">}</span>

<span class="token keyword keyword-int">int</span> <span class="token function">main</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-73-close">(</span><span class="token punctuation brace-round brace-close brace-level-1" id="pair-73-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-77-close">{</span>
    <span class="token keyword keyword-const">const</span> std<span class="token double-colon punctuation">::</span>string s<span class="token punctuation brace-curly brace-open brace-level-2" id="pair-76-close">{</span> <span class="token function">getHello</span><span class="token punctuation brace-round brace-open brace-level-3" id="pair-74-close">(</span><span class="token punctuation brace-round brace-close brace-level-3" id="pair-74-open">)</span> <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-76-open">}</span><span class="token punctuation">;</span>

    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> s<span class="token punctuation">;</span>

    <span class="token keyword keyword-return">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-77-open">}</span><span aria-hidden="true" class="line-numbers-rows"><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre>
  <div class="toolbar">
    <div class="toolbar-item">
      <button
        class="copy-to-clipboard-button"
        type="button"
        data-copy-state="copy"
      >
        <span>Copy</span>
      </button>
    </div>
  </div>
</div>
<p>
  In this case, <code>getHello()</code> returns a <code>std::string</code> by
  value, which is an rvalue. This rvalue is then used to initialize
  <code>s</code>. After the initialization of <code>s</code>, the expression in
  which the rvalue was created has finished evaluating, and the rvalue is
  destroyed.
</p>
<p>Now let’s take a look at this similar example:</p>
<div class="code-toolbar">
  <pre
    class="line-numbers language-cpp"
    tabindex="0"
  ><code class="match-braces language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string&gt;</span></span>

<span class="token keyword keyword-const">const</span> std<span class="token double-colon punctuation">::</span>string<span class="token operator">&amp;</span> <span class="token function">foo</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-78-close">(</span><span class="token keyword keyword-const">const</span> std<span class="token double-colon punctuation">::</span>string<span class="token operator">&amp;</span> s<span class="token punctuation brace-round brace-close brace-level-1" id="pair-78-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-83-close">{</span>
    <span class="token keyword keyword-return">return</span> s<span class="token punctuation">;</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-83-open">}</span>

std<span class="token double-colon punctuation">::</span>string <span class="token function">getHello</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-79-close">(</span><span class="token punctuation brace-round brace-close brace-level-1" id="pair-79-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-84-close">{</span>
    <span class="token keyword keyword-return">return</span> <span class="token string">"Hello"</span><span class="token punctuation">;</span> <span class="token comment">// implicit conversion to std::string</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-84-open">}</span>

<span class="token keyword keyword-int">int</span> <span class="token function">main</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-80-close">(</span><span class="token punctuation brace-round brace-close brace-level-1" id="pair-80-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-86-close">{</span>
    <span class="token keyword keyword-const">const</span> std<span class="token double-colon punctuation">::</span>string s<span class="token punctuation brace-curly brace-open brace-level-2" id="pair-85-close">{</span> <span class="token function">foo</span><span class="token punctuation brace-round brace-open brace-level-3" id="pair-82-close">(</span><span class="token function">getHello</span><span class="token punctuation brace-round brace-open brace-level-4" id="pair-81-close">(</span><span class="token punctuation brace-round brace-close brace-level-4" id="pair-81-open">)</span><span class="token punctuation brace-round brace-close brace-level-3" id="pair-82-open">)</span> <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-85-open">}</span><span class="token punctuation">;</span>

    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> s<span class="token punctuation">;</span>

    <span class="token keyword keyword-return">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-86-open">}</span><span aria-hidden="true" class="line-numbers-rows"><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre>
  <div class="toolbar">
    <div class="toolbar-item">
      <button
        class="copy-to-clipboard-button"
        type="button"
        data-copy-state="copy"
      >
        <span>Copy</span>
      </button>
    </div>
  </div>
</div>
<p>
  The only difference in this case is that the rvalue is passed by const
  reference to <code>foo()</code> and then returned by const reference back to
  the caller before it is used to initialize <code>s</code>. Everything else
  works identically.
</p>
<p>
  We discuss a similar case in lesson
  <a href="https://www.learncpp.com/cpp-tutorial/access-functions/"
    >14.6 -- Access functions</a
  >.
</p>
<div
  class="google-auto-placed ap_container"
  style="width: 100%; height: auto; clear: both; text-align: center"
>
  <ins
    data-ad-format="auto"
    class="adsbygoogle adsbygoogle-noablate"
    data-ad-client="ca-pub-0588844875925051"
    data-adsbygoogle-status="done"
    style="
      display: block;
      margin: auto;
      background-color: transparent;
      height: 280px;
    "
    ><div
      id="aswift_9_host"
      style="
        border: none;
        height: 280px;
        width: 1027px;
        margin: 0px;
        padding: 0px;
        position: relative;
        visibility: visible;
        background-color: transparent;
        display: inline-block;
      "
    ></div
  ></ins>
</div>
<p class="cpp-section cpp-topline" style="clear: both">
  The caller can modify values through the reference
</p>
<p>
  When an argument is passed to a function by non-const reference, the function
  can use the reference to modify the value of the argument.
</p>
<p>
  Similarly, when a non-const reference is returned from a function, the caller
  can use the reference to modify the value being returned.
</p>
<p>Here’s an illustrative example:</p>
<div class="code-toolbar">
  <pre
    class="line-numbers language-cpp"
    tabindex="0"
  ><code class="match-braces language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>

<span class="token comment">// takes two integers by non-const reference, and returns the greater by reference</span>
<span class="token keyword keyword-int">int</span><span class="token operator">&amp;</span> <span class="token function">max</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-87-close">(</span><span class="token keyword keyword-int">int</span><span class="token operator">&amp;</span> x<span class="token punctuation">,</span> <span class="token keyword keyword-int">int</span><span class="token operator">&amp;</span> y<span class="token punctuation brace-round brace-close brace-level-1" id="pair-87-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-91-close">{</span>
    <span class="token keyword keyword-return">return</span> <span class="token punctuation brace-round brace-open brace-level-2" id="pair-88-close">(</span>x <span class="token operator">&gt;</span> y<span class="token punctuation brace-round brace-close brace-level-2" id="pair-88-open">)</span> <span class="token operator">?</span> x <span class="token operator">:</span> y<span class="token punctuation">;</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-91-open">}</span>

<span class="token keyword keyword-int">int</span> <span class="token function">main</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-89-close">(</span><span class="token punctuation brace-round brace-close brace-level-1" id="pair-89-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-94-close">{</span>
    <span class="token keyword keyword-int">int</span> a<span class="token punctuation brace-curly brace-open brace-level-2" id="pair-92-close">{</span> <span class="token number">5</span> <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-92-open">}</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-int">int</span> b<span class="token punctuation brace-curly brace-open brace-level-2" id="pair-93-close">{</span> <span class="token number">6</span> <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-93-open">}</span><span class="token punctuation">;</span>

    <span class="token function">max</span><span class="token punctuation brace-round brace-open brace-level-2" id="pair-90-close">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation brace-round brace-close brace-level-2" id="pair-90-open">)</span> <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">;</span> <span class="token comment">// sets the greater of a or b to 7</span>

    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> a <span class="token operator">&lt;&lt;</span> b <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span><span class="token punctuation">;</span>

    <span class="token keyword keyword-return">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-94-open">}</span><span aria-hidden="true" class="line-numbers-rows"><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre>
  <div class="toolbar">
    <div class="toolbar-item">
      <button
        class="copy-to-clipboard-button"
        type="button"
        data-copy-state="copy"
      >
        <span>Copy</span>
      </button>
    </div>
  </div>
</div>
<p>
  In the above program, <code>max(a, b)</code> calls the
  <code>max()</code> function with <code>a</code> and <code>b</code> as
  arguments. Reference parameter <code>x</code> binds to argument
  <code>a</code>, and reference parameter <code>y</code> binds to argument
  <code>b</code>. The function then determines which of
  <code>x</code> (<code>5</code>) and <code>y</code> (<code>6</code>) is
  greater. In this case, that’s <code>y</code>, so the function returns
  <code>y</code> (which is still bound to <code>b</code>) back to the caller.
  The caller then assigns the value <code>7</code> to this returned reference.
</p>
<p>
  Therefore, the expression <code>max(a, b) = 7</code> effectively resolves to
  <code>b = 7</code>.
</p>
<p>This prints:</p>
<div
  class="google-auto-placed ap_container"
  style="width: 100%; height: auto; clear: both; text-align: center"
>
  <ins
    data-ad-format="auto"
    class="adsbygoogle adsbygoogle-noablate"
    data-ad-client="ca-pub-0588844875925051"
    data-adsbygoogle-status="done"
    style="
      display: block;
      margin: auto;
      background-color: transparent;
      height: 280px;
    "
    ><div
      id="aswift_10_host"
      style="
        border: none;
        height: 280px;
        width: 1027px;
        margin: 0px;
        padding: 0px;
        position: relative;
        visibility: visible;
        background-color: transparent;
        display: inline-block;
      "
    ></div
  ></ins>
</div>
<pre>
57
</pre>
<p class="cpp-section cpp-topline" style="clear: both">Return by address</p>
<p>
  <strong>Return by address</strong> works almost identically to return by
  reference, except a pointer to an object is returned instead of a reference to
  an object. Return by address has the same primary caveat as return by
  reference -- the object being returned by address must outlive the scope of
  the function returning the address, otherwise the caller will receive a
  dangling pointer.
</p>
<p>
  The major advantage of return by address over return by reference is that we
  can have the function return <code>nullptr</code> if there is no valid object
  to return. For example, let’s say we have a list of students that we want to
  search. If we find the student we are looking for in the list, we can return a
  pointer to the object representing the matching student. If we don’t find any
  students matching, we can return <code>nullptr</code> to indicate a matching
  student object was not found.
</p>
<p>
  The major disadvantage of return by address is that the caller has to remember
  to do a <code>nullptr</code> check before dereferencing the return value,
  otherwise a null pointer dereference may occur and undefined behavior will
  result. Because of this danger, return by reference should be preferred over
  return by address unless the ability to return “no object” is needed.
</p>
<div class="cpp-note cpp-lightgreenbackground">
  <p class="cpp-note-title cpp-bottomline">Best practice</p>
  <p>
    Prefer return by reference over return by address unless the ability to
    return “no object” (using <code>nullptr</code>) is important.
  </p>
</div>
<div class="cpp-note cpp-lightgraybackground">
  <p class="cpp-note-title cpp-bottomline">Related content</p>
  <p>
    If you need the ability to return “no object” or a value (rather than an
    object)
    <a href="https://www.learncpp.com/cpp-tutorial/stdoptional/"
      >12.15 -- std::optional</a
    >
    describes a good alternative.
  </p>
</div>
<div class="cpp-note cpp-lightgraybackground">
  <p class="cpp-note-title cpp-bottomline">Related content</p>
  <p>
    See
    <a
      href="https://www.learncpp.com/cpp-tutorial/stdstring_view-part-2/#stringvsstringview"
      >5.9 -- std::string_view (part 2)</a
    >
    for a quick guide on when to return <code>std::string_view</code> vs
    <code>const std::string&amp;</code> .
  </p>
</div>
<div class="prevnext">
  <div class="prevnext-inline">
    <a
      class="nav-link"
      href="https://www.learncpp.com/cpp-tutorial/in-and-out-parameters/"
    >
      <div class="nav-button nav-button-next">
        <div class="nav-button-icon">
          <i class="fa fa-chevron-circle-right" aria-hidden="true"></i>
        </div>
        <div class="nav-button-text">
          <div class="nav-button-title">Next lesson</div>
          <div class="nav-button-lesson">
            <span class="nav-button-lesson-number">12.13</span>In and out
            parameters
          </div>
        </div>
      </div></a
    >
    <a class="nav-link" href="/">
      <div class="nav-button nav-button-index">
        <div class="nav-button-icon">
          <i class="fa fa-home" aria-hidden="true"></i>
        </div>
        <div class="nav-button-text">
          <div class="nav-button-title">Back to table of contents</div>
        </div>
      </div></a
    >
    <a
      class="nav-link"
      href="https://www.learncpp.com/cpp-tutorial/pass-by-address-part-2/"
    >
      <div class="nav-button nav-button-prev">
        <div class="nav-button-icon">
          <i class="fa fa-chevron-circle-left" aria-hidden="true"></i>
        </div>
        <div class="nav-button-text">
          <div class="nav-button-title">Previous lesson</div>
          <div class="nav-button-lesson">
            <span class="nav-button-lesson-number">12.11</span>Pass by address
            (part 2)
          </div>
        </div>
      </div></a
    >
  </div>
</div>
<div class="code-block code-block-10" style="margin: 8px 0; clear: both"></div>

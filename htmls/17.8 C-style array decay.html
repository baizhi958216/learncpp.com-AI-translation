<div
  class="code-block code-block-1"
  style="margin: 8px 8px 8px 0; float: left"
></div>
<p class="cpp-section">The C-style array passing challenge</p>
<p>
  The designers of the C language had a problem. Consider the following simple
  program:
</p>
<div class="code-toolbar">
  <pre
    class="line-numbers language-cpp"
    tabindex="0"
  ><code class="match-braces language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>

<span class="token keyword keyword-void">void</span> <span class="token function">print</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-0-close">(</span><span class="token keyword keyword-int">int</span> val<span class="token punctuation brace-round brace-close brace-level-1" id="pair-0-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-3-close">{</span>
    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> val<span class="token punctuation">;</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-3-open">}</span>

<span class="token keyword keyword-int">int</span> <span class="token function">main</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-1-close">(</span><span class="token punctuation brace-round brace-close brace-level-1" id="pair-1-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-5-close">{</span>
    <span class="token keyword keyword-int">int</span> x <span class="token punctuation brace-curly brace-open brace-level-2" id="pair-4-close">{</span> <span class="token number">5</span> <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-4-open">}</span><span class="token punctuation">;</span>
    <span class="token function">print</span><span class="token punctuation brace-round brace-open brace-level-2" id="pair-2-close">(</span>x<span class="token punctuation brace-round brace-close brace-level-2" id="pair-2-open">)</span><span class="token punctuation">;</span>

    <span class="token keyword keyword-return">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-5-open">}</span><span aria-hidden="true" class="line-numbers-rows"><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre>
  <div class="toolbar">
    <div class="toolbar-item">
      <button
        class="copy-to-clipboard-button"
        type="button"
        data-copy-state="copy"
      >
        <span>Copy</span>
      </button>
    </div>
  </div>
</div>
<p>
  When <code>print(x)</code> is called, the value of argument
  <code>x</code> (<code>5</code>) is copied into parameter <code>val</code>.
  Within the body of the function, the value of
  <code>val</code> (<code>5</code>) is printed to the console. Because
  <code>x</code> is cheap to copy, there’s no problem here.
</p>
<p>
  Now consider the following similar program, which uses a 1000 element C-style
  int array instead of a single int:
</p>
<div class="code-toolbar">
  <pre
    class="line-numbers language-cpp"
    tabindex="0"
  ><code class="match-braces language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>

<span class="token keyword keyword-void">void</span> <span class="token function">printElementZero</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-6-close">(</span><span class="token keyword keyword-int">int</span> arr<span class="token punctuation brace-square brace-open brace-level-2" id="pair-9-close">[</span><span class="token number">1000</span><span class="token punctuation brace-square brace-close brace-level-2" id="pair-9-open">]</span><span class="token punctuation brace-round brace-close brace-level-1" id="pair-6-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-12-close">{</span>
    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> arr<span class="token punctuation brace-square brace-open brace-level-2" id="pair-10-close">[</span><span class="token number">0</span><span class="token punctuation brace-square brace-close brace-level-2" id="pair-10-open">]</span><span class="token punctuation">;</span> <span class="token comment">// print the value of the first element</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-12-open">}</span>

<span class="token keyword keyword-int">int</span> <span class="token function">main</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-7-close">(</span><span class="token punctuation brace-round brace-close brace-level-1" id="pair-7-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-14-close">{</span>
    <span class="token keyword keyword-int">int</span> x<span class="token punctuation brace-square brace-open brace-level-2" id="pair-11-close">[</span><span class="token number">1000</span><span class="token punctuation brace-square brace-close brace-level-2" id="pair-11-open">]</span> <span class="token punctuation brace-curly brace-open brace-level-2" id="pair-13-close">{</span> <span class="token number">5</span> <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-13-open">}</span><span class="token punctuation">;</span>   <span class="token comment">// define an array with 1000 elements, x[0] is initialized to 5</span>
    <span class="token function">printElementZero</span><span class="token punctuation brace-round brace-open brace-level-2" id="pair-8-close">(</span>x<span class="token punctuation brace-round brace-close brace-level-2" id="pair-8-open">)</span><span class="token punctuation">;</span>

    <span class="token keyword keyword-return">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-14-open">}</span><span aria-hidden="true" class="line-numbers-rows"><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre>
  <div class="toolbar">
    <div class="toolbar-item">
      <button
        class="copy-to-clipboard-button"
        type="button"
        data-copy-state="copy"
      >
        <span>Copy</span>
      </button>
    </div>
  </div>
</div>
<p>
  This program also compiles and prints the expected value (<code>5</code>) to
  the console.
</p>
<div
  class="google-auto-placed ap_container"
  style="width: 100%; height: auto; clear: both; text-align: center"
>
  <ins
    data-ad-format="auto"
    class="adsbygoogle adsbygoogle-noablate"
    data-ad-client="ca-pub-0588844875925051"
    data-adsbygoogle-status="done"
    style="
      display: block;
      margin: auto;
      background-color: transparent;
      height: 0px;
    "
    data-ad-status="unfilled"
    ><div
      id="aswift_5_host"
      style="
        border: none;
        height: 0px;
        width: 1027px;
        margin: 0px;
        padding: 0px;
        position: relative;
        visibility: visible;
        background-color: transparent;
        display: inline-block;
        overflow: hidden;
        opacity: 0;
      "
    >
      <iframe
        id="aswift_5"
        name="aswift_5"
        browsingtopics="true"
        style="
          left: 0px;
          position: absolute;
          top: 0px;
          border: 0px;
          width: 1027px;
          height: 0px;
          min-height: auto;
          max-height: none;
          min-width: auto;
          max-width: none;
        "
        sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation"
        width="1027"
        height="0"
        frameborder="0"
        marginwidth="0"
        marginheight="0"
        vspace="0"
        hspace="0"
        allowtransparency="true"
        scrolling="no"
        allow="attribution-reporting; run-ad-auction"
        src="https://googleads.g.doubleclick.net/pagead/ads?client=ca-pub-0588844875925051&amp;output=html&amp;h=280&amp;adk=3001662743&amp;adf=1470173748&amp;w=1027&amp;abgtt=11&amp;fwrn=4&amp;fwrnh=100&amp;lmt=1751566668&amp;num_ads=1&amp;rafmt=1&amp;armr=3&amp;sem=mc&amp;pwprc=4633386603&amp;ad_type=text_image&amp;format=1027x280&amp;url=https%3A%2F%2Fwww.learncpp.com%2Fcpp-tutorial%2Fc-style-array-decay%2F&amp;fwr=0&amp;pra=3&amp;rh=200&amp;rw=1026&amp;rpe=1&amp;resp_fmts=3&amp;wgl=1&amp;fa=27&amp;uach=WyJXaW5kb3dzIiwiMTkuMC4wIiwieDg2IiwiIiwiMTM3LjAuNzE1MS4xMjIiLG51bGwsMCxudWxsLCI2NCIsW1siR29vZ2xlIENocm9tZSIsIjEzNy4wLjcxNTEuMTIyIl0sWyJDaHJvbWl1bSIsIjEzNy4wLjcxNTEuMTIyIl0sWyJOb3QvQSlCcmFuZCIsIjI0LjAuMC4wIl1dLDBd&amp;dt=1751963162659&amp;bpp=1&amp;bdt=1424&amp;idt=-M&amp;shv=r20250702&amp;mjsv=m202507020101&amp;ptt=9&amp;saldr=aa&amp;abxe=1&amp;cookie=ID%3D05f6e82287d810b4%3AT%3D1751962604%3ART%3D1751962911%3AS%3DALNI_MaQYA0TSAU2k8xwY5tqlN0xFCcd6g&amp;gpic=UID%3D00001157d9e27d0a%3AT%3D1751962604%3ART%3D1751962911%3AS%3DALNI_MYgtHzQJAQQXY_151HTGSSfVxE8_A&amp;eo_id_str=ID%3D52c21936d98c6d2b%3AT%3D1751962604%3ART%3D1751962911%3AS%3DAA-AfjZsJ15yjdEPJ8d11hPojsJQ&amp;prev_fmts=0x0%2C336x280%2C160x600%2C160x600&amp;nras=2&amp;correlator=5337207175728&amp;frm=20&amp;pv=1&amp;u_tz=480&amp;u_his=2&amp;u_h=600&amp;u_w=800&amp;u_ah=600&amp;u_aw=800&amp;u_cd=24&amp;u_sd=1&amp;dmc=8&amp;adx=27&amp;ady=1168&amp;biw=1080&amp;bih=1024&amp;scr_x=0&amp;scr_y=0&amp;eid=31093039%2C95353387%2C95362655%2C95365226%2C95365234%2C95365109%2C95359265%2C95365115%2C95365798&amp;oid=2&amp;pvsid=5189393279503263&amp;tmod=1708485235&amp;uas=0&amp;nvt=1&amp;fc=1408&amp;brdim=10%2C10%2C10%2C10%2C800%2C0%2C780%2C580%2C1080%2C1024&amp;vis=1&amp;rsz=%7C%7Cs%7C&amp;abl=NS&amp;fu=128&amp;bc=31&amp;bz=0.72&amp;td=1&amp;tdf=2&amp;psd=W251bGwsbnVsbCxudWxsLDNd&amp;nt=1&amp;ifi=6&amp;uci=a!6&amp;btvi=1&amp;fsb=1&amp;dtd=21"
        data-google-container-id="a!6"
        tabindex="0"
        title="Advertisement"
        aria-label="Advertisement"
        data-google-query-id="CJbYqa_rrI4DFZiL6QUdRFgnnA"
        data-load-complete="true"
      ></iframe></div
  ></ins>
</div>
<div class="code-block code-block-2" style="margin: 8px 0; clear: both"></div>

<p>
  While the code in this example is similar to the code in the prior example,
  mechanically it works a bit different than you might expect (we’ll explain
  this below). And that is due to the solution that the C designers came up to
  solve for two major challenges.
</p>
<p>
  First, copying a 1000 element array every time a function is called is
  expensive (and even more so if the elements are an expensive-to-copy type), so
  we want to avoid that. But how? C doesn’t have references, so using pass by
  reference to avoid making a copy of function arguments wasn’t an option.
</p>
<p>
  Second, we want to be able to write a single function that can accept array
  arguments of different lengths. Ideally, our
  <code>printElementZero()</code> function in the example above should be
  callable with arrays arguments of any length (since element 0 is guaranteed to
  exist). We don’t want to have to write a different function for every possible
  array length that we want to use as an argument. But how? C has no syntax to
  specify “any length” arrays, nor does it support templates, nor can arrays of
  one length be converted to arrays of another length (presumably because doing
  so would involve making an expensive copy).
</p>
<p>
  The designers of the C language came up with a clever solution (inherited by
  C++ for compatibility reasons) that solves for both of these issues:
</p>
<div class="code-toolbar">
  <pre
    class="line-numbers language-cpp"
    tabindex="0"
  ><code class="match-braces language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>

<span class="token keyword keyword-void">void</span> <span class="token function">printElementZero</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-15-close">(</span><span class="token keyword keyword-int">int</span> arr<span class="token punctuation brace-square brace-open brace-level-2" id="pair-18-close">[</span><span class="token number">1000</span><span class="token punctuation brace-square brace-close brace-level-2" id="pair-18-open">]</span><span class="token punctuation brace-round brace-close brace-level-1" id="pair-15-open">)</span> <span class="token comment">// doesn't make a copy</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-21-close">{</span>
    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> arr<span class="token punctuation brace-square brace-open brace-level-2" id="pair-19-close">[</span><span class="token number">0</span><span class="token punctuation brace-square brace-close brace-level-2" id="pair-19-open">]</span><span class="token punctuation">;</span> <span class="token comment">// print the value of the first element</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-21-open">}</span>

<span class="token keyword keyword-int">int</span> <span class="token function">main</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-16-close">(</span><span class="token punctuation brace-round brace-close brace-level-1" id="pair-16-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-23-close">{</span>
    <span class="token keyword keyword-int">int</span> x<span class="token punctuation brace-square brace-open brace-level-2" id="pair-20-close">[</span><span class="token number">7</span><span class="token punctuation brace-square brace-close brace-level-2" id="pair-20-open">]</span> <span class="token punctuation brace-curly brace-open brace-level-2" id="pair-22-close">{</span> <span class="token number">5</span> <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-22-open">}</span><span class="token punctuation">;</span>      <span class="token comment">// define an array with 7 elements</span>
    <span class="token function">printElementZero</span><span class="token punctuation brace-round brace-open brace-level-2" id="pair-17-close">(</span>x<span class="token punctuation brace-round brace-close brace-level-2" id="pair-17-open">)</span><span class="token punctuation">;</span> <span class="token comment">// somehow works!</span>

    <span class="token keyword keyword-return">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-23-open">}</span><span aria-hidden="true" class="line-numbers-rows"><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre>
  <div class="toolbar">
    <div class="toolbar-item">
      <button
        class="copy-to-clipboard-button"
        type="button"
        data-copy-state="copy"
      >
        <span>Copy</span>
      </button>
    </div>
  </div>
</div>
<p>
  Somehow, the above example passes a 7 element array to a function expecting a
  1000 element array, without any copies being made. In this lesson, we’ll
  explore how this works.
</p>
<div
  class="google-auto-placed ap_container"
  style="width: 100%; height: auto; clear: both; text-align: center"
>
  <ins
    data-ad-format="auto"
    class="adsbygoogle adsbygoogle-noablate"
    data-ad-client="ca-pub-0588844875925051"
    data-adsbygoogle-status="done"
    style="
      display: block;
      margin: auto;
      background-color: transparent;
      height: 0px;
    "
    data-ad-status="unfilled"
    ><div
      id="aswift_6_host"
      style="
        border: none;
        height: 0px;
        width: 1027px;
        margin: 0px;
        padding: 0px;
        position: relative;
        visibility: visible;
        background-color: transparent;
        display: inline-block;
        overflow: hidden;
        opacity: 0;
      "
    >
      <iframe
        id="aswift_6"
        name="aswift_6"
        browsingtopics="true"
        style="
          left: 0px;
          position: absolute;
          top: 0px;
          border: 0px;
          width: 1027px;
          height: 0px;
          min-height: auto;
          max-height: none;
          min-width: auto;
          max-width: none;
        "
        sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation"
        width="1027"
        height="0"
        frameborder="0"
        marginwidth="0"
        marginheight="0"
        vspace="0"
        hspace="0"
        allowtransparency="true"
        scrolling="no"
        allow="attribution-reporting; run-ad-auction"
        src="https://googleads.g.doubleclick.net/pagead/ads?client=ca-pub-0588844875925051&amp;output=html&amp;h=280&amp;adk=3001662743&amp;adf=3988217805&amp;w=1027&amp;abgtt=11&amp;fwrn=4&amp;fwrnh=100&amp;lmt=1751566668&amp;num_ads=1&amp;rafmt=1&amp;armr=3&amp;sem=mc&amp;pwprc=4633386603&amp;ad_type=text_image&amp;format=1027x280&amp;url=https%3A%2F%2Fwww.learncpp.com%2Fcpp-tutorial%2Fc-style-array-decay%2F&amp;fwr=0&amp;pra=3&amp;rh=200&amp;rw=1026&amp;rpe=1&amp;resp_fmts=3&amp;wgl=1&amp;fa=27&amp;uach=WyJXaW5kb3dzIiwiMTkuMC4wIiwieDg2IiwiIiwiMTM3LjAuNzE1MS4xMjIiLG51bGwsMCxudWxsLCI2NCIsW1siR29vZ2xlIENocm9tZSIsIjEzNy4wLjcxNTEuMTIyIl0sWyJDaHJvbWl1bSIsIjEzNy4wLjcxNTEuMTIyIl0sWyJOb3QvQSlCcmFuZCIsIjI0LjAuMC4wIl1dLDBd&amp;dt=1751963162659&amp;bpp=1&amp;bdt=1424&amp;idt=-M&amp;shv=r20250702&amp;mjsv=m202507020101&amp;ptt=9&amp;saldr=aa&amp;abxe=1&amp;cookie=ID%3D05f6e82287d810b4%3AT%3D1751962604%3ART%3D1751962911%3AS%3DALNI_MaQYA0TSAU2k8xwY5tqlN0xFCcd6g&amp;gpic=UID%3D00001157d9e27d0a%3AT%3D1751962604%3ART%3D1751962911%3AS%3DALNI_MYgtHzQJAQQXY_151HTGSSfVxE8_A&amp;eo_id_str=ID%3D52c21936d98c6d2b%3AT%3D1751962604%3ART%3D1751962911%3AS%3DAA-AfjZsJ15yjdEPJ8d11hPojsJQ&amp;prev_fmts=0x0%2C336x280%2C160x600%2C160x600%2C1027x280&amp;nras=3&amp;correlator=5337207175728&amp;frm=20&amp;pv=1&amp;u_tz=480&amp;u_his=2&amp;u_h=600&amp;u_w=800&amp;u_ah=600&amp;u_aw=800&amp;u_cd=24&amp;u_sd=1&amp;dmc=8&amp;adx=27&amp;ady=2027&amp;biw=1080&amp;bih=1024&amp;scr_x=0&amp;scr_y=0&amp;eid=31093039%2C95353387%2C95362655%2C95365226%2C95365234%2C95365109%2C95359265%2C95365115%2C95365798&amp;oid=2&amp;pvsid=5189393279503263&amp;tmod=1708485235&amp;uas=0&amp;nvt=1&amp;fc=1408&amp;brdim=10%2C10%2C10%2C10%2C800%2C0%2C780%2C580%2C1080%2C1024&amp;vis=1&amp;rsz=%7C%7Cs%7C&amp;abl=NS&amp;fu=128&amp;bc=31&amp;bz=0.72&amp;td=1&amp;tdf=2&amp;psd=W251bGwsbnVsbCxudWxsLDNd&amp;nt=1&amp;ifi=7&amp;uci=a!7&amp;btvi=2&amp;fsb=1&amp;dtd=22"
        data-google-container-id="a!7"
        tabindex="0"
        title="Advertisement"
        aria-label="Advertisement"
        data-load-complete="true"
        data-google-query-id="CNb4qa_rrI4DFUuG6QUdrWog_w"
      ></iframe></div
  ></ins>
</div>
<div class="code-block code-block-3" style="margin: 8px 0; clear: both"></div>

<p>
  We’ll also take a look at why the solution the C designers picked is
  dangerous, and not well suited for use in modern C++.
</p>
<p>But first, we need to cover two subtopics.</p>
<p class="cpp-section cpp-topline" style="clear: both">
  Array to pointer conversions (array decay)
</p>
<p>
  In most cases, when a C-style array is used in an expression, the array will
  be implicitly converted into a pointer to the element type, initialized with
  the address of the first element (with index 0). Colloquially, this is called
  <strong>array decay</strong> (or just <strong>decay</strong> for short).
</p>
<p>You can see this in the following program:</p>
<div class="code-block code-block-4" style="margin: 8px 0; clear: both"></div>

<div class="code-toolbar">
  <pre
    class="line-numbers language-cpp"
    tabindex="0"
  ><code class="match-braces language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iomanip&gt;</span> <span class="token comment">// for std::boolalpha</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>

<span class="token keyword keyword-int">int</span> <span class="token function">main</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-24-close">(</span><span class="token punctuation brace-round brace-close brace-level-1" id="pair-24-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-33-close">{</span>
    <span class="token keyword keyword-int">int</span> arr<span class="token punctuation brace-square brace-open brace-level-2" id="pair-29-close">[</span><span class="token number">5</span><span class="token punctuation brace-square brace-close brace-level-2" id="pair-29-open">]</span><span class="token punctuation brace-curly brace-open brace-level-2" id="pair-31-close">{</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-31-open">}</span><span class="token punctuation">;</span> <span class="token comment">// our array has elements of type int</span>

    <span class="token comment">// First, let's prove that arr decays into an int* pointer</span>

    <span class="token keyword keyword-auto">auto</span> ptr<span class="token punctuation brace-curly brace-open brace-level-2" id="pair-32-close">{</span> arr <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-32-open">}</span><span class="token punctuation">;</span> <span class="token comment">// evaluation causes arr to decay, type deduction should deduce type int*</span>
    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>boolalpha <span class="token operator">&lt;&lt;</span> <span class="token punctuation brace-round brace-open brace-level-2" id="pair-27-close">(</span><span class="token keyword keyword-typeid">typeid</span><span class="token punctuation brace-round brace-open brace-level-3" id="pair-25-close">(</span>ptr<span class="token punctuation brace-round brace-close brace-level-3" id="pair-25-open">)</span> <span class="token operator">==</span> <span class="token keyword keyword-typeid">typeid</span><span class="token punctuation brace-round brace-open brace-level-3" id="pair-26-close">(</span><span class="token keyword keyword-int">int</span><span class="token operator">*</span><span class="token punctuation brace-round brace-close brace-level-3" id="pair-26-open">)</span><span class="token punctuation brace-round brace-close brace-level-2" id="pair-27-open">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span><span class="token punctuation">;</span> <span class="token comment">// Prints true if the type of ptr is int*</span>

    <span class="token comment">// Now let's prove that the pointer holds the address of the first element of the array</span>

    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>boolalpha <span class="token operator">&lt;&lt;</span> <span class="token punctuation brace-round brace-open brace-level-2" id="pair-28-close">(</span><span class="token operator">&amp;</span>arr<span class="token punctuation brace-square brace-open brace-level-3" id="pair-30-close">[</span><span class="token number">0</span><span class="token punctuation brace-square brace-close brace-level-3" id="pair-30-open">]</span> <span class="token operator">==</span> ptr<span class="token punctuation brace-round brace-close brace-level-2" id="pair-28-open">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span><span class="token punctuation">;</span>

    <span class="token keyword keyword-return">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-33-open">}</span><span aria-hidden="true" class="line-numbers-rows"><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre>
  <div class="toolbar">
    <div class="toolbar-item">
      <button
        class="copy-to-clipboard-button"
        type="button"
        data-copy-state="copy"
      >
        <span>Copy</span>
      </button>
    </div>
  </div>
</div>
<p>On the author’s machine, this printed:</p>
<div
  class="google-auto-placed ap_container"
  style="width: 100%; height: auto; clear: both; text-align: center"
>
  <ins
    data-ad-format="auto"
    class="adsbygoogle adsbygoogle-noablate"
    data-ad-client="ca-pub-0588844875925051"
    data-adsbygoogle-status="done"
    style="
      display: block;
      margin: auto;
      background-color: transparent;
      height: 0px;
    "
    data-ad-status="unfilled"
    ><div
      id="aswift_7_host"
      style="
        border: none;
        height: 0px;
        width: 1027px;
        margin: 0px;
        padding: 0px;
        position: relative;
        visibility: visible;
        background-color: transparent;
        display: inline-block;
        overflow: hidden;
        opacity: 0;
      "
    >
      <iframe
        id="aswift_7"
        name="aswift_7"
        browsingtopics="true"
        style="
          left: 0px;
          position: absolute;
          top: 0px;
          border: 0px;
          width: 1027px;
          height: 0px;
          min-height: auto;
          max-height: none;
          min-width: auto;
          max-width: none;
        "
        sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation"
        width="1027"
        height="0"
        frameborder="0"
        marginwidth="0"
        marginheight="0"
        vspace="0"
        hspace="0"
        allowtransparency="true"
        scrolling="no"
        allow="attribution-reporting; run-ad-auction"
        src="https://googleads.g.doubleclick.net/pagead/ads?client=ca-pub-0588844875925051&amp;output=html&amp;h=280&amp;adk=3001662743&amp;adf=209831049&amp;w=1027&amp;abgtt=11&amp;fwrn=4&amp;fwrnh=100&amp;lmt=1751566668&amp;num_ads=1&amp;rafmt=1&amp;armr=3&amp;sem=mc&amp;pwprc=4633386603&amp;ad_type=text_image&amp;format=1027x280&amp;url=https%3A%2F%2Fwww.learncpp.com%2Fcpp-tutorial%2Fc-style-array-decay%2F&amp;fwr=0&amp;pra=3&amp;rh=200&amp;rw=1026&amp;rpe=1&amp;resp_fmts=3&amp;wgl=1&amp;fa=27&amp;uach=WyJXaW5kb3dzIiwiMTkuMC4wIiwieDg2IiwiIiwiMTM3LjAuNzE1MS4xMjIiLG51bGwsMCxudWxsLCI2NCIsW1siR29vZ2xlIENocm9tZSIsIjEzNy4wLjcxNTEuMTIyIl0sWyJDaHJvbWl1bSIsIjEzNy4wLjcxNTEuMTIyIl0sWyJOb3QvQSlCcmFuZCIsIjI0LjAuMC4wIl1dLDBd&amp;dt=1751963162659&amp;bpp=1&amp;bdt=1424&amp;idt=-M&amp;shv=r20250702&amp;mjsv=m202507020101&amp;ptt=9&amp;saldr=aa&amp;abxe=1&amp;cookie=ID%3D05f6e82287d810b4%3AT%3D1751962604%3ART%3D1751962911%3AS%3DALNI_MaQYA0TSAU2k8xwY5tqlN0xFCcd6g&amp;gpic=UID%3D00001157d9e27d0a%3AT%3D1751962604%3ART%3D1751962911%3AS%3DALNI_MYgtHzQJAQQXY_151HTGSSfVxE8_A&amp;eo_id_str=ID%3D52c21936d98c6d2b%3AT%3D1751962604%3ART%3D1751962911%3AS%3DAA-AfjZsJ15yjdEPJ8d11hPojsJQ&amp;prev_fmts=0x0%2C336x280%2C160x600%2C160x600%2C1027x280%2C1027x280&amp;nras=4&amp;correlator=5337207175728&amp;frm=20&amp;pv=1&amp;u_tz=480&amp;u_his=2&amp;u_h=600&amp;u_w=800&amp;u_ah=600&amp;u_aw=800&amp;u_cd=24&amp;u_sd=1&amp;dmc=8&amp;adx=27&amp;ady=2890&amp;biw=1080&amp;bih=1024&amp;scr_x=0&amp;scr_y=0&amp;eid=31093039%2C95353387%2C95362655%2C95365226%2C95365234%2C95365109%2C95359265%2C95365115%2C95365798&amp;oid=2&amp;pvsid=5189393279503263&amp;tmod=1708485235&amp;uas=0&amp;nvt=1&amp;fc=1408&amp;brdim=10%2C10%2C10%2C10%2C800%2C0%2C780%2C580%2C1080%2C1024&amp;vis=1&amp;rsz=%7C%7Cs%7C&amp;abl=NS&amp;fu=128&amp;bc=31&amp;bz=0.72&amp;td=1&amp;tdf=2&amp;psd=W251bGwsbnVsbCxudWxsLDNd&amp;nt=1&amp;ifi=8&amp;uci=a!8&amp;btvi=3&amp;fsb=1&amp;dtd=23"
        data-google-container-id="a!8"
        tabindex="0"
        title="Advertisement"
        aria-label="Advertisement"
        data-load-complete="true"
        data-google-query-id="CLWQqq_rrI4DFdOg6QUduZ8mPA"
      ></iframe></div
  ></ins>
</div>
<pre>
true
true
</pre>
<p>
  There is nothing special about the pointer that an array decays into. It is a
  normal pointer that holds the address of the first element.
</p>
<p>
  Similarly, a const array (e.g. <code>const int arr[5]</code>) decays into a
  pointer-to-const (<code>const int*</code>).
</p>
<div class="cpp-note cpp-lightbluebackground">
  <p class="cpp-note-title cpp-bottomline">Tip</p>
  <p>
    In C++, there are a few common cases where an C-style array doesn’t decay:
  </p>
  <ol start="1">
    <li>
      When used as an argument to <code>sizeof()</code> or
      <code>typeid()</code>.
    </li>
    <li>
      When taking the address of the array using <code>operator&amp;</code>.
    </li>
    <li>When passed as a member of a class type.</li>
    <li>When passed by reference.</li>
  </ol>
</div>
<p>
  Because C-style arrays decay into a pointer in most cases, it’s a common
  fallacy to believe arrays <em>are</em> pointers. This is not the case. An
  array object is a sequence of elements, whereas a pointer object just holds an
  address.
</p>
<div
  class="google-auto-placed ap_container"
  style="width: 100%; height: auto; clear: both; text-align: center"
>
  <ins
    data-ad-format="auto"
    class="adsbygoogle adsbygoogle-noablate"
    data-ad-client="ca-pub-0588844875925051"
    data-adsbygoogle-status="done"
    style="
      display: block;
      margin: auto;
      background-color: transparent;
      height: 0px;
    "
    data-ad-status="unfilled"
    ><div
      id="aswift_8_host"
      style="
        border: none;
        height: 0px;
        width: 1027px;
        margin: 0px;
        padding: 0px;
        position: relative;
        visibility: visible;
        background-color: transparent;
        display: inline-block;
        overflow: hidden;
        opacity: 0;
      "
    >
      <iframe
        id="aswift_8"
        name="aswift_8"
        browsingtopics="true"
        style="
          left: 0px;
          position: absolute;
          top: 0px;
          border: 0px;
          width: 1027px;
          height: 0px;
          min-height: auto;
          max-height: none;
          min-width: auto;
          max-width: none;
        "
        sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation"
        width="1027"
        height="0"
        frameborder="0"
        marginwidth="0"
        marginheight="0"
        vspace="0"
        hspace="0"
        allowtransparency="true"
        scrolling="no"
        allow="attribution-reporting; run-ad-auction"
        src="https://googleads.g.doubleclick.net/pagead/ads?client=ca-pub-0588844875925051&amp;output=html&amp;h=280&amp;adk=3001662743&amp;adf=1308451925&amp;w=1027&amp;abgtt=11&amp;fwrn=4&amp;fwrnh=100&amp;lmt=1751566668&amp;num_ads=1&amp;rafmt=1&amp;armr=3&amp;sem=mc&amp;pwprc=4633386603&amp;ad_type=text_image&amp;format=1027x280&amp;url=https%3A%2F%2Fwww.learncpp.com%2Fcpp-tutorial%2Fc-style-array-decay%2F&amp;fwr=0&amp;pra=3&amp;rh=200&amp;rw=1026&amp;rpe=1&amp;resp_fmts=3&amp;wgl=1&amp;fa=27&amp;uach=WyJXaW5kb3dzIiwiMTkuMC4wIiwieDg2IiwiIiwiMTM3LjAuNzE1MS4xMjIiLG51bGwsMCxudWxsLCI2NCIsW1siR29vZ2xlIENocm9tZSIsIjEzNy4wLjcxNTEuMTIyIl0sWyJDaHJvbWl1bSIsIjEzNy4wLjcxNTEuMTIyIl0sWyJOb3QvQSlCcmFuZCIsIjI0LjAuMC4wIl1dLDBd&amp;dt=1751963162659&amp;bpp=1&amp;bdt=1423&amp;idt=0&amp;shv=r20250702&amp;mjsv=m202507020101&amp;ptt=9&amp;saldr=aa&amp;abxe=1&amp;cookie=ID%3D05f6e82287d810b4%3AT%3D1751962604%3ART%3D1751962911%3AS%3DALNI_MaQYA0TSAU2k8xwY5tqlN0xFCcd6g&amp;gpic=UID%3D00001157d9e27d0a%3AT%3D1751962604%3ART%3D1751962911%3AS%3DALNI_MYgtHzQJAQQXY_151HTGSSfVxE8_A&amp;eo_id_str=ID%3D52c21936d98c6d2b%3AT%3D1751962604%3ART%3D1751962911%3AS%3DAA-AfjZsJ15yjdEPJ8d11hPojsJQ&amp;prev_fmts=0x0%2C336x280%2C160x600%2C160x600%2C1027x280%2C1027x280%2C1027x280&amp;nras=5&amp;correlator=5337207175728&amp;frm=20&amp;pv=1&amp;u_tz=480&amp;u_his=2&amp;u_h=600&amp;u_w=800&amp;u_ah=600&amp;u_aw=800&amp;u_cd=24&amp;u_sd=1&amp;dmc=8&amp;adx=27&amp;ady=3577&amp;biw=1080&amp;bih=1024&amp;scr_x=0&amp;scr_y=0&amp;eid=31093039%2C95353387%2C95362655%2C95365226%2C95365234%2C95365109%2C95359265%2C95365115%2C95365798&amp;oid=2&amp;pvsid=5189393279503263&amp;tmod=1708485235&amp;uas=0&amp;nvt=1&amp;fc=1408&amp;brdim=10%2C10%2C10%2C10%2C800%2C0%2C780%2C580%2C1080%2C1024&amp;vis=1&amp;rsz=%7C%7Cs%7C&amp;abl=NS&amp;fu=128&amp;bc=31&amp;bz=0.72&amp;td=1&amp;tdf=2&amp;psd=W251bGwsbnVsbCxudWxsLDNd&amp;nt=1&amp;ifi=9&amp;uci=a!9&amp;btvi=4&amp;fsb=1&amp;dtd=24"
        data-google-container-id="a!9"
        tabindex="0"
        title="Advertisement"
        aria-label="Advertisement"
        data-load-complete="true"
        data-google-query-id="CIrIqq_rrI4DFZ2H6QUdw_AfWw"
      ></iframe></div
  ></ins>
</div>
<p>
  The type information of an array and a decayed array is different. In the
  example above, the array <code>arr</code> has type <code>int[5]</code>,
  whereas the decayed array has type <code>int*</code>. Notably, the array type
  <code>int[5]</code> contains length information, whereas the decayed array
  pointer type <code>int*</code> does not.
</p>
<div class="code-block code-block-5" style="margin: 8px 0; clear: both"></div>

<div class="cpp-note cpp-lightbluebackground">
  <p class="cpp-note-title cpp-bottomline">Key insight</p>
  <p>
    A decayed array pointer does not know how long the array it is pointing to
    is. The term “decay” indicates this loss of length type information.
  </p>
</div>
<p class="cpp-section cpp-topline" style="clear: both">
  Subscripting a C-style array actually applies <code>operator[]</code> to the
  decayed pointer
</p>
<p>
  Because a C-style arrays decays to a pointer when evaluated, when a C-style
  array is subscripted, the subscript is actually operating on the decayed array
  pointer:
</p>
<div class="code-toolbar">
  <pre
    class="line-numbers language-cpp"
    tabindex="0"
  ><code class="match-braces language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>

<span class="token keyword keyword-int">int</span> <span class="token function">main</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-34-close">(</span><span class="token punctuation brace-round brace-close brace-level-1" id="pair-34-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-38-close">{</span>
    <span class="token keyword keyword-const">const</span> <span class="token keyword keyword-int">int</span> arr<span class="token punctuation brace-square brace-open brace-level-2" id="pair-35-close">[</span><span class="token punctuation brace-square brace-close brace-level-2" id="pair-35-open">]</span> <span class="token punctuation brace-curly brace-open brace-level-2" id="pair-37-close">{</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-37-open">}</span><span class="token punctuation">;</span>
    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> arr<span class="token punctuation brace-square brace-open brace-level-2" id="pair-36-close">[</span><span class="token number">2</span><span class="token punctuation brace-square brace-close brace-level-2" id="pair-36-open">]</span><span class="token punctuation">;</span> <span class="token comment">// subscript decayed array to get element 2, prints 5</span>

    <span class="token keyword keyword-return">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-38-open">}</span><span aria-hidden="true" class="line-numbers-rows"><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre>
  <div class="toolbar">
    <div class="toolbar-item">
      <button
        class="copy-to-clipboard-button"
        type="button"
        data-copy-state="copy"
      >
        <span>Copy</span>
      </button>
    </div>
  </div>
</div>
<p>
  We can also use <code>operator[]</code> directly on a pointer. If that pointer
  is holding the address of the first element, the result will be identical:
</p>
<div class="code-toolbar">
  <pre
    class="line-numbers language-cpp"
    tabindex="0"
  ><code class="match-braces language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>

<span class="token keyword keyword-int">int</span> <span class="token function">main</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-39-close">(</span><span class="token punctuation brace-round brace-close brace-level-1" id="pair-39-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-44-close">{</span>
    <span class="token keyword keyword-const">const</span> <span class="token keyword keyword-int">int</span> arr<span class="token punctuation brace-square brace-open brace-level-2" id="pair-40-close">[</span><span class="token punctuation brace-square brace-close brace-level-2" id="pair-40-open">]</span> <span class="token punctuation brace-curly brace-open brace-level-2" id="pair-42-close">{</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-42-open">}</span><span class="token punctuation">;</span>

    <span class="token keyword keyword-const">const</span> <span class="token keyword keyword-int">int</span><span class="token operator">*</span> ptr<span class="token punctuation brace-curly brace-open brace-level-2" id="pair-43-close">{</span> arr <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-43-open">}</span><span class="token punctuation">;</span>  <span class="token comment">// arr decays into a pointer</span>
    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> ptr<span class="token punctuation brace-square brace-open brace-level-2" id="pair-41-close">[</span><span class="token number">2</span><span class="token punctuation brace-square brace-close brace-level-2" id="pair-41-open">]</span><span class="token punctuation">;</span>    <span class="token comment">// subscript ptr to get element 2, prints 5</span>

    <span class="token keyword keyword-return">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-44-open">}</span><span aria-hidden="true" class="line-numbers-rows"><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre>
  <div class="toolbar">
    <div class="toolbar-item">
      <button
        class="copy-to-clipboard-button"
        type="button"
        data-copy-state="copy"
      >
        <span>Copy</span>
      </button>
    </div>
  </div>
</div>
<p>
  We’ll see where this is convenient in a moment, and take a deeper look at how
  this actually works (as well as what happens when the pointer is holding
  something other than the address of the first element) in the next lesson
  <a
    href="https://www.learncpp.com/cpp-tutorial/pointer-arithmetic-and-subscripting/"
    >17.9 -- Pointer arithmetic and subscripting</a
  >.
</p>
<div
  class="google-auto-placed ap_container"
  style="width: 100%; height: auto; clear: both; text-align: center"
>
  <ins
    data-ad-format="auto"
    class="adsbygoogle adsbygoogle-noablate"
    data-ad-client="ca-pub-0588844875925051"
    data-adsbygoogle-status="done"
    style="
      display: block;
      margin: auto;
      background-color: transparent;
      height: 0px;
    "
    data-ad-status="unfilled"
    ><div
      id="aswift_9_host"
      style="
        border: none;
        height: 0px;
        width: 1027px;
        margin: 0px;
        padding: 0px;
        position: relative;
        visibility: visible;
        background-color: transparent;
        display: inline-block;
        overflow: hidden;
        opacity: 0;
      "
    >
      <iframe
        id="aswift_9"
        name="aswift_9"
        browsingtopics="true"
        style="
          left: 0px;
          position: absolute;
          top: 0px;
          border: 0px;
          width: 1027px;
          height: 0px;
          min-height: auto;
          max-height: none;
          min-width: auto;
          max-width: none;
        "
        sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation"
        width="1027"
        height="0"
        frameborder="0"
        marginwidth="0"
        marginheight="0"
        vspace="0"
        hspace="0"
        allowtransparency="true"
        scrolling="no"
        allow="attribution-reporting; run-ad-auction"
        src="https://googleads.g.doubleclick.net/pagead/ads?client=ca-pub-0588844875925051&amp;output=html&amp;h=280&amp;adk=3001662743&amp;adf=800740953&amp;w=1027&amp;abgtt=11&amp;fwrn=4&amp;fwrnh=100&amp;lmt=1751566668&amp;num_ads=1&amp;rafmt=1&amp;armr=3&amp;sem=mc&amp;pwprc=4633386603&amp;ad_type=text_image&amp;format=1027x280&amp;url=https%3A%2F%2Fwww.learncpp.com%2Fcpp-tutorial%2Fc-style-array-decay%2F&amp;fwr=0&amp;pra=3&amp;rh=200&amp;rw=1026&amp;rpe=1&amp;resp_fmts=3&amp;wgl=1&amp;fa=27&amp;uach=WyJXaW5kb3dzIiwiMTkuMC4wIiwieDg2IiwiIiwiMTM3LjAuNzE1MS4xMjIiLG51bGwsMCxudWxsLCI2NCIsW1siR29vZ2xlIENocm9tZSIsIjEzNy4wLjcxNTEuMTIyIl0sWyJDaHJvbWl1bSIsIjEzNy4wLjcxNTEuMTIyIl0sWyJOb3QvQSlCcmFuZCIsIjI0LjAuMC4wIl1dLDBd&amp;dt=1751963162662&amp;bpp=1&amp;bdt=1426&amp;idt=0&amp;shv=r20250702&amp;mjsv=m202507020101&amp;ptt=9&amp;saldr=aa&amp;abxe=1&amp;cookie=ID%3D05f6e82287d810b4%3AT%3D1751962604%3ART%3D1751962911%3AS%3DALNI_MaQYA0TSAU2k8xwY5tqlN0xFCcd6g&amp;gpic=UID%3D00001157d9e27d0a%3AT%3D1751962604%3ART%3D1751962911%3AS%3DALNI_MYgtHzQJAQQXY_151HTGSSfVxE8_A&amp;eo_id_str=ID%3D52c21936d98c6d2b%3AT%3D1751962604%3ART%3D1751962911%3AS%3DAA-AfjZsJ15yjdEPJ8d11hPojsJQ&amp;prev_fmts=0x0%2C336x280%2C160x600%2C160x600%2C1027x280%2C1027x280%2C1027x280%2C1027x280&amp;nras=6&amp;correlator=5337207175728&amp;frm=20&amp;pv=1&amp;u_tz=480&amp;u_his=2&amp;u_h=600&amp;u_w=800&amp;u_ah=600&amp;u_aw=800&amp;u_cd=24&amp;u_sd=1&amp;dmc=8&amp;adx=27&amp;ady=3482&amp;biw=1080&amp;bih=1024&amp;scr_x=0&amp;scr_y=0&amp;eid=31093039%2C95353387%2C95362655%2C95365226%2C95365234%2C95365109%2C95359265%2C95365115%2C95365798&amp;oid=2&amp;pvsid=5189393279503263&amp;tmod=1708485235&amp;uas=0&amp;nvt=1&amp;fc=1408&amp;brdim=10%2C10%2C10%2C10%2C800%2C0%2C780%2C580%2C1080%2C1024&amp;vis=1&amp;rsz=%7C%7Cs%7C&amp;abl=NS&amp;fu=128&amp;bc=31&amp;bz=0.72&amp;td=1&amp;tdf=2&amp;psd=W251bGwsbnVsbCxudWxsLDNd&amp;nt=1&amp;ifi=10&amp;uci=a!a&amp;btvi=5&amp;fsb=1&amp;dtd=271"
        data-google-container-id="a!a"
        tabindex="0"
        title="Advertisement"
        aria-label="Advertisement"
        data-load-complete="true"
        data-google-query-id="CNy0ua_rrI4DFU-i6QUdpJgHXQ"
      ></iframe></div
  ></ins>
</div>
<p class="cpp-section cpp-topline" style="clear: both">
  Array decay solves our C-style array passing issue
</p>
<div class="code-block code-block-6" style="margin: 8px 0; clear: both"></div>

<p>
  Array decay solves both challenges we encountered at the top of the lesson.
</p>
<p>
  When passing a C-style array as an argument, the array decays into a pointer,
  and the pointer holding the address of the first element of the array is what
  gets passed to the function. So although it looks like we’re passing the
  C-style array by value, we’re actually passing it by address! This is how
  making a copy of the C-style array argument is avoided.
</p>
<div class="cpp-note cpp-lightbluebackground">
  <p class="cpp-note-title cpp-bottomline">Key insight</p>
  <p>
    C-style arrays are passed by address, even when it looks like they are
    passed by value.
  </p>
</div>
<p>
  Now consider two different arrays of the same element type but different
  lengths (e.g. <code>int[5]</code> and <code>int[7]</code>). These are distinct
  types, incompatible with each other. However, they will both decay into the
  same pointer type (e.g. <code>int*</code>). Their decayed versions are
  interchangable! Dropping the length information from the type allows us to
  pass arrays of different lengths without a type mismatch.
</p>
<div class="cpp-note cpp-lightbluebackground">
  <p class="cpp-note-title cpp-bottomline">Key insight</p>
  <p>
    Two C-style arrays with the same element type but different lengths will
    decay into the same pointer type.
  </p>
</div>
<p>In the following example, we’ll illustrate two things:</p>
<div
  class="google-auto-placed ap_container"
  style="width: 100%; height: auto; clear: both; text-align: center"
>
  <ins
    data-ad-format="auto"
    class="adsbygoogle adsbygoogle-noablate"
    data-ad-client="ca-pub-0588844875925051"
    data-adsbygoogle-status="done"
    style="
      display: block;
      margin: auto;
      background-color: transparent;
      height: 0px;
    "
    data-ad-status="unfilled"
    ><div
      id="aswift_10_host"
      style="
        border: none;
        height: 0px;
        width: 1027px;
        margin: 0px;
        padding: 0px;
        position: relative;
        visibility: visible;
        background-color: transparent;
        display: inline-block;
        overflow: hidden;
        opacity: 0;
      "
    >
      <iframe
        id="aswift_10"
        name="aswift_10"
        browsingtopics="true"
        style="
          left: 0px;
          position: absolute;
          top: 0px;
          border: 0px;
          width: 1027px;
          height: 0px;
          min-height: auto;
          max-height: none;
          min-width: auto;
          max-width: none;
        "
        sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation"
        width="1027"
        height="0"
        frameborder="0"
        marginwidth="0"
        marginheight="0"
        vspace="0"
        hspace="0"
        allowtransparency="true"
        scrolling="no"
        allow="attribution-reporting; run-ad-auction"
        src="https://googleads.g.doubleclick.net/pagead/ads?client=ca-pub-0588844875925051&amp;output=html&amp;h=280&amp;adk=3001662743&amp;adf=171544763&amp;w=1027&amp;abgtt=11&amp;fwrn=4&amp;fwrnh=100&amp;lmt=1751566668&amp;num_ads=1&amp;rafmt=1&amp;armr=3&amp;sem=mc&amp;pwprc=4633386603&amp;ad_type=text_image&amp;format=1027x280&amp;url=https%3A%2F%2Fwww.learncpp.com%2Fcpp-tutorial%2Fc-style-array-decay%2F&amp;fwr=0&amp;pra=3&amp;rh=200&amp;rw=1026&amp;rpe=1&amp;resp_fmts=3&amp;wgl=1&amp;fa=27&amp;uach=WyJXaW5kb3dzIiwiMTkuMC4wIiwieDg2IiwiIiwiMTM3LjAuNzE1MS4xMjIiLG51bGwsMCxudWxsLCI2NCIsW1siR29vZ2xlIENocm9tZSIsIjEzNy4wLjcxNTEuMTIyIl0sWyJDaHJvbWl1bSIsIjEzNy4wLjcxNTEuMTIyIl0sWyJOb3QvQSlCcmFuZCIsIjI0LjAuMC4wIl1dLDBd&amp;dt=1751963162664&amp;bpp=1&amp;bdt=1429&amp;idt=1&amp;shv=r20250702&amp;mjsv=m202507020101&amp;ptt=9&amp;saldr=aa&amp;abxe=1&amp;cookie=ID%3D05f6e82287d810b4%3AT%3D1751962604%3ART%3D1751962911%3AS%3DALNI_MaQYA0TSAU2k8xwY5tqlN0xFCcd6g&amp;gpic=UID%3D00001157d9e27d0a%3AT%3D1751962604%3ART%3D1751962911%3AS%3DALNI_MYgtHzQJAQQXY_151HTGSSfVxE8_A&amp;eo_id_str=ID%3D52c21936d98c6d2b%3AT%3D1751962604%3ART%3D1751962911%3AS%3DAA-AfjZsJ15yjdEPJ8d11hPojsJQ&amp;prev_fmts=0x0%2C336x280%2C160x600%2C160x600%2C1027x280%2C1027x280%2C1027x280%2C1027x280%2C1027x280&amp;nras=7&amp;correlator=5337207175728&amp;frm=20&amp;pv=1&amp;u_tz=480&amp;u_his=2&amp;u_h=600&amp;u_w=800&amp;u_ah=600&amp;u_aw=800&amp;u_cd=24&amp;u_sd=1&amp;dmc=8&amp;adx=27&amp;ady=3947&amp;biw=1080&amp;bih=1024&amp;scr_x=0&amp;scr_y=0&amp;eid=31093039%2C95353387%2C95362655%2C95365226%2C95365234%2C95365109%2C95359265%2C95365115%2C95365798&amp;oid=2&amp;pvsid=5189393279503263&amp;tmod=1708485235&amp;uas=0&amp;nvt=1&amp;fc=1408&amp;brdim=10%2C10%2C10%2C10%2C800%2C0%2C780%2C580%2C1080%2C1024&amp;vis=1&amp;rsz=%7C%7Cs%7C&amp;abl=NS&amp;fu=128&amp;bc=31&amp;bz=0.72&amp;td=1&amp;tdf=2&amp;psd=W251bGwsbnVsbCxudWxsLDNd&amp;nt=1&amp;ifi=11&amp;uci=a!b&amp;btvi=6&amp;fsb=1&amp;dtd=436"
        data-google-container-id="a!b"
        tabindex="0"
        title="Advertisement"
        aria-label="Advertisement"
        data-google-query-id="CJ64w6_rrI4DFaBOwgUd1zQhaA"
        data-load-complete="true"
      ></iframe></div
  ></ins>
</div>
<ul>
  <li>
    That we can pass arrays of different lengths to a single function (because
    both decay to the same pointer type).
  </li>
  <li>
    That our function parameter receiving the array can be a (const) pointer of
    the array’s element type.
  </li>
</ul>
<div class="code-toolbar">
  <pre
    class="line-numbers language-cpp"
    tabindex="0"
  ><code class="match-braces language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>

<span class="token keyword keyword-void">void</span> <span class="token function">printElementZero</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-45-close">(</span><span class="token keyword keyword-const">const</span> <span class="token keyword keyword-int">int</span><span class="token operator">*</span> arr<span class="token punctuation brace-round brace-close brace-level-1" id="pair-45-open">)</span> <span class="token comment">// pass by const address</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-52-close">{</span>
    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> arr<span class="token punctuation brace-square brace-open brace-level-2" id="pair-49-close">[</span><span class="token number">0</span><span class="token punctuation brace-square brace-close brace-level-2" id="pair-49-open">]</span><span class="token punctuation">;</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-52-open">}</span>

<span class="token keyword keyword-int">int</span> <span class="token function">main</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-46-close">(</span><span class="token punctuation brace-round brace-close brace-level-1" id="pair-46-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-55-close">{</span>
    <span class="token keyword keyword-const">const</span> <span class="token keyword keyword-int">int</span> prime<span class="token punctuation brace-square brace-open brace-level-2" id="pair-50-close">[</span><span class="token punctuation brace-square brace-close brace-level-2" id="pair-50-open">]</span> <span class="token punctuation brace-curly brace-open brace-level-2" id="pair-53-close">{</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">11</span> <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-53-open">}</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-const">const</span> <span class="token keyword keyword-int">int</span> squares<span class="token punctuation brace-square brace-open brace-level-2" id="pair-51-close">[</span><span class="token punctuation brace-square brace-close brace-level-2" id="pair-51-open">]</span> <span class="token punctuation brace-curly brace-open brace-level-2" id="pair-54-close">{</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">36</span><span class="token punctuation">,</span> <span class="token number">49</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">81</span> <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-54-open">}</span><span class="token punctuation">;</span>

    <span class="token function">printElementZero</span><span class="token punctuation brace-round brace-open brace-level-2" id="pair-47-close">(</span>prime<span class="token punctuation brace-round brace-close brace-level-2" id="pair-47-open">)</span><span class="token punctuation">;</span>   <span class="token comment">// prime decays to an const int* pointer</span>
    <span class="token function">printElementZero</span><span class="token punctuation brace-round brace-open brace-level-2" id="pair-48-close">(</span>squares<span class="token punctuation brace-round brace-close brace-level-2" id="pair-48-open">)</span><span class="token punctuation">;</span> <span class="token comment">// squares decays to an const int* pointer</span>

    <span class="token keyword keyword-return">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-55-open">}</span><span aria-hidden="true" class="line-numbers-rows"><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre>
  <div class="toolbar">
    <div class="toolbar-item">
      <button
        class="copy-to-clipboard-button"
        type="button"
        data-copy-state="copy"
      >
        <span>Copy</span>
      </button>
    </div>
  </div>
</div>
<p>This example works just fine, and prints:</p>
<div
  class="google-auto-placed ap_container"
  style="width: 100%; height: auto; clear: both; text-align: center"
>
  <ins
    data-ad-format="auto"
    class="adsbygoogle adsbygoogle-noablate"
    data-ad-client="ca-pub-0588844875925051"
    data-adsbygoogle-status="done"
    style="
      display: block;
      margin: auto;
      background-color: transparent;
      height: 280px;
    "
    ><div
      id="aswift_11_host"
      style="
        border: none;
        height: 280px;
        width: 1027px;
        margin: 0px;
        padding: 0px;
        position: relative;
        visibility: visible;
        background-color: transparent;
        display: inline-block;
      "
    ></div
  ></ins>
</div>
<div class="code-block code-block-7" style="margin: 8px 0; clear: both"></div>

<pre>
2
1
</pre>
<p>
  Within <code>main()</code>, when we call <code>printElementZero(prime)</code>,
  the <code>prime</code> array decays from an array of type
  <code>const int[5]</code> to a pointer of type <code>const int*</code> that is
  holding the address of the first element of <code>prime</code>. Similarly,
  when we call <code>printElementZero(squares)</code>,
  <code>squares</code> decays from an array of type <code>const int[8]</code> to
  a pointer of type <code>const int*</code> that is holding the address of the
  first element of <code>squares</code>. These pointers of type
  <code>const int*</code> are what are actually passed to the function as an
  argument.
</p>
<p>
  Since we’re passing pointers of type <code>const int*</code>, our
  <code>printElementZero()</code> function needs to have a parameter of the same
  pointer type (<code>const int*</code>).
</p>
<p>
  Within this function, we’re subscripting the pointer to access the selected
  array element.
</p>
<p>
  Because a C-style array is passed by address, the function has direct access
  to the array passed in (not a copy) and can modify its elements. For this
  reason, it’s a good idea to make sure your function parameter is const if your
  function does not intend to modify the array elements.
</p>
<div
  class="google-auto-placed ap_container"
  style="width: 100%; height: auto; clear: both; text-align: center"
>
  <ins
    data-ad-format="auto"
    class="adsbygoogle adsbygoogle-noablate"
    data-ad-client="ca-pub-0588844875925051"
    data-adsbygoogle-status="done"
    style="
      display: block;
      margin: auto;
      background-color: transparent;
      height: 280px;
    "
    ><div
      id="aswift_12_host"
      style="
        border: none;
        height: 280px;
        width: 1027px;
        margin: 0px;
        padding: 0px;
        position: relative;
        visibility: visible;
        background-color: transparent;
        display: inline-block;
      "
    ></div
  ></ins>
</div>
<p class="cpp-section cpp-topline" style="clear: both">
  C-style array function parameter syntax
</p>
<div class="code-block code-block-8" style="margin: 8px 0; clear: both"></div>

<p>
  One problem with declaring the function parameter as <code>int* arr</code> is
  that it’s not obvious that <code>arr</code> is supposed to be a pointer to an
  array of values rather than a pointer to a single integer. For this reason,
  when passing a C-style array, its preferable to use the alternate declaration
  form <code>int arr[]</code>:
</p>
<div class="code-toolbar">
  <pre
    class="line-numbers language-cpp"
    tabindex="0"
  ><code class="match-braces language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>

<span class="token keyword keyword-void">void</span> <span class="token function">printElementZero</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-56-close">(</span><span class="token keyword keyword-const">const</span> <span class="token keyword keyword-int">int</span> arr<span class="token punctuation brace-square brace-open brace-level-2" id="pair-60-close">[</span><span class="token punctuation brace-square brace-close brace-level-2" id="pair-60-open">]</span><span class="token punctuation brace-round brace-close brace-level-1" id="pair-56-open">)</span> <span class="token comment">// treated the same as const int*</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-64-close">{</span>
    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> arr<span class="token punctuation brace-square brace-open brace-level-2" id="pair-61-close">[</span><span class="token number">0</span><span class="token punctuation brace-square brace-close brace-level-2" id="pair-61-open">]</span><span class="token punctuation">;</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-64-open">}</span>

<span class="token keyword keyword-int">int</span> <span class="token function">main</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-57-close">(</span><span class="token punctuation brace-round brace-close brace-level-1" id="pair-57-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-67-close">{</span>
    <span class="token keyword keyword-const">const</span> <span class="token keyword keyword-int">int</span> prime<span class="token punctuation brace-square brace-open brace-level-2" id="pair-62-close">[</span><span class="token punctuation brace-square brace-close brace-level-2" id="pair-62-open">]</span> <span class="token punctuation brace-curly brace-open brace-level-2" id="pair-65-close">{</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">11</span> <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-65-open">}</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-const">const</span> <span class="token keyword keyword-int">int</span> squares<span class="token punctuation brace-square brace-open brace-level-2" id="pair-63-close">[</span><span class="token punctuation brace-square brace-close brace-level-2" id="pair-63-open">]</span> <span class="token punctuation brace-curly brace-open brace-level-2" id="pair-66-close">{</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">36</span><span class="token punctuation">,</span> <span class="token number">49</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">81</span> <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-66-open">}</span><span class="token punctuation">;</span>

    <span class="token function">printElementZero</span><span class="token punctuation brace-round brace-open brace-level-2" id="pair-58-close">(</span>prime<span class="token punctuation brace-round brace-close brace-level-2" id="pair-58-open">)</span><span class="token punctuation">;</span>  <span class="token comment">// prime decays to a pointer</span>
    <span class="token function">printElementZero</span><span class="token punctuation brace-round brace-open brace-level-2" id="pair-59-close">(</span>squares<span class="token punctuation brace-round brace-close brace-level-2" id="pair-59-open">)</span><span class="token punctuation">;</span> <span class="token comment">// squares decays to a pointer</span>

    <span class="token keyword keyword-return">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-67-open">}</span><span aria-hidden="true" class="line-numbers-rows"><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre>
  <div class="toolbar">
    <div class="toolbar-item">
      <button
        class="copy-to-clipboard-button"
        type="button"
        data-copy-state="copy"
      >
        <span>Copy</span>
      </button>
    </div>
  </div>
</div>
<p>
  This program behaves identically to the prior one, as the compiler will
  interpret function parameter <code>const int arr[]</code> the same as
  <code>const int*</code>. However, this has the advantage of communicating to
  the caller that <code>arr</code> is expected to be a decayed C-style array,
  not a pointer to a single value. Note that no length information is required
  between the square brackets (since it is not used anyway). If a length is
  provided, it will be ignored.
</p>
<div class="cpp-note cpp-lightgreenbackground">
  <p class="cpp-note-title cpp-bottomline">Best practice</p>
  <p>
    A function parameter expecting a C-style array type should use the array
    syntax (e.g. <code>int arr[]</code>) rather than pointer syntax (e.g.
    <code>int *arr</code>).
  </p>
</div>
<p>
  The downside of using this syntax is that it makes it less obvious that
  <code>arr</code> has decayed (whereas it’s quite clear with the pointer
  syntax), so you’ll need to take extra care not to do anything that doesn’t
  work as expected with a decayed array (we’ll cover some of these in a moment).
</p>
<div
  class="google-auto-placed ap_container"
  style="width: 100%; height: auto; clear: both; text-align: center"
>
  <ins
    data-ad-format="auto"
    class="adsbygoogle adsbygoogle-noablate"
    data-ad-client="ca-pub-0588844875925051"
    data-adsbygoogle-status="done"
    style="
      display: block;
      margin: auto;
      background-color: transparent;
      height: 280px;
    "
    ><div
      id="aswift_13_host"
      style="
        border: none;
        height: 280px;
        width: 1027px;
        margin: 0px;
        padding: 0px;
        position: relative;
        visibility: visible;
        background-color: transparent;
        display: inline-block;
      "
    ></div
  ></ins>
</div>
<p class="cpp-section cpp-topline" style="clear: both">
  The problems with array decay
</p>
<p>
  Although array decay was a clever solution to ensure C-style arrays of
  different lengths could be passed to a function without making expensive
  copies, the loss of array length information makes it easy for several types
  of mistakes to be made.
</p>
<p>
  First, <code>sizeof()</code> will return different values for arrays and
  decayed arrays:
</p>
<div class="code-toolbar">
  <pre
    class="line-numbers language-cpp"
    tabindex="0"
  ><code class="match-braces language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>

<span class="token keyword keyword-void">void</span> <span class="token function">printArraySize</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-68-close">(</span><span class="token keyword keyword-int">int</span> arr<span class="token punctuation brace-square brace-open brace-level-2" id="pair-73-close">[</span><span class="token punctuation brace-square brace-close brace-level-2" id="pair-73-open">]</span><span class="token punctuation brace-round brace-close brace-level-1" id="pair-68-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-75-close">{</span>
    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token keyword keyword-sizeof">sizeof</span><span class="token punctuation brace-round brace-open brace-level-2" id="pair-69-close">(</span>arr<span class="token punctuation brace-round brace-close brace-level-2" id="pair-69-open">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span><span class="token punctuation">;</span> <span class="token comment">// prints 4 (assuming 32-bit addresses)</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-75-open">}</span>

<span class="token keyword keyword-int">int</span> <span class="token function">main</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-70-close">(</span><span class="token punctuation brace-round brace-close brace-level-1" id="pair-70-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-77-close">{</span>
    <span class="token keyword keyword-int">int</span> arr<span class="token punctuation brace-square brace-open brace-level-2" id="pair-74-close">[</span><span class="token punctuation brace-square brace-close brace-level-2" id="pair-74-open">]</span><span class="token punctuation brace-curly brace-open brace-level-2" id="pair-76-close">{</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-76-open">}</span><span class="token punctuation">;</span>

    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token keyword keyword-sizeof">sizeof</span><span class="token punctuation brace-round brace-open brace-level-2" id="pair-71-close">(</span>arr<span class="token punctuation brace-round brace-close brace-level-2" id="pair-71-open">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span><span class="token punctuation">;</span> <span class="token comment">// prints 12 (assuming 4 byte ints)</span>

    <span class="token function">printArraySize</span><span class="token punctuation brace-round brace-open brace-level-2" id="pair-72-close">(</span>arr<span class="token punctuation brace-round brace-close brace-level-2" id="pair-72-open">)</span><span class="token punctuation">;</span>

    <span class="token keyword keyword-return">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-77-open">}</span><span aria-hidden="true" class="line-numbers-rows"><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre>
  <div class="toolbar">
    <div class="toolbar-item">
      <button
        class="copy-to-clipboard-button"
        type="button"
        data-copy-state="copy"
      >
        <span>Copy</span>
      </button>
    </div>
  </div>
</div>
<p>
  This means using <code>sizeof()</code> on a C-style array is potentially
  dangerous, as you have to ensure you are using it only when you can access the
  actual array object, not the decayed array or pointer.
</p>
<p>
  In the prior lesson (<a
    href="https://www.learncpp.com/cpp-tutorial/introduction-to-c-style-arrays/"
    >17.7 -- Introduction to C-style arrays</a
  >), we mentioned that <code>sizeof(arr)/sizeof(*arr)</code> was historically
  used as a hack to get the size of a C-style array. This hack is dangerous
  because if <code>arr</code> has decayed, <code>sizeof(arr)</code> will return
  the size of a pointer rather than the size of the array, producing the wrong
  array length as a result, likely causing the program to malfunction.
</p>
<p>
  Fortunately, C++17’s better replacement <code>std::size()</code> (and C++20’s
  <code>std::ssize()</code>) will fail to compile if passed a pointer value:
</p>
<div class="code-toolbar">
  <pre
    class="line-numbers language-cpp"
    tabindex="0"
  ><code class="match-braces language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>

<span class="token keyword keyword-int">int</span> <span class="token function">printArrayLength</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-78-close">(</span><span class="token keyword keyword-int">int</span> arr<span class="token punctuation brace-square brace-open brace-level-2" id="pair-83-close">[</span><span class="token punctuation brace-square brace-close brace-level-2" id="pair-83-open">]</span><span class="token punctuation brace-round brace-close brace-level-1" id="pair-78-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-85-close">{</span>
    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span><span class="token function">size</span><span class="token punctuation brace-round brace-open brace-level-2" id="pair-79-close">(</span>arr<span class="token punctuation brace-round brace-close brace-level-2" id="pair-79-open">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span><span class="token punctuation">;</span> <span class="token comment">// compile error: std::size() won't work on a pointer</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-85-open">}</span>

<span class="token keyword keyword-int">int</span> <span class="token function">main</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-80-close">(</span><span class="token punctuation brace-round brace-close brace-level-1" id="pair-80-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-87-close">{</span>
    <span class="token keyword keyword-int">int</span> arr<span class="token punctuation brace-square brace-open brace-level-2" id="pair-84-close">[</span><span class="token punctuation brace-square brace-close brace-level-2" id="pair-84-open">]</span><span class="token punctuation brace-curly brace-open brace-level-2" id="pair-86-close">{</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-86-open">}</span><span class="token punctuation">;</span>

    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span><span class="token function">size</span><span class="token punctuation brace-round brace-open brace-level-2" id="pair-81-close">(</span>arr<span class="token punctuation brace-round brace-close brace-level-2" id="pair-81-open">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span><span class="token punctuation">;</span> <span class="token comment">// prints 3</span>

    <span class="token function">printArrayLength</span><span class="token punctuation brace-round brace-open brace-level-2" id="pair-82-close">(</span>arr<span class="token punctuation brace-round brace-close brace-level-2" id="pair-82-open">)</span><span class="token punctuation">;</span>

    <span class="token keyword keyword-return">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-87-open">}</span><span aria-hidden="true" class="line-numbers-rows"><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre>
  <div class="toolbar">
    <div class="toolbar-item">
      <button
        class="copy-to-clipboard-button"
        type="button"
        data-copy-state="copy"
      >
        <span>Copy</span>
      </button>
    </div>
  </div>
</div>
<p>
  Second, and perhaps most importantly, array decay can make refactoring
  (breaking long functions into shorter, more modular functions) difficult. Code
  that works as expected with a non-decayed array may not compile (or worse, may
  silently malfunction) when the same code is using a decayed array.
</p>
<p>
  Third, not having length information creates several programmatic challenges.
  Without length information, it is difficult to sanity check the length of the
  array. Users can easily pass in arrays that are shorter than expected (or even
  pointers to a single value), which will then cause undefined behavior when
  they are subscripted with an invalid index.
</p>
<div class="code-toolbar">
  <pre
    class="line-numbers language-cpp"
    tabindex="0"
  ><code class="match-braces language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>

<span class="token keyword keyword-void">void</span> <span class="token function">printElement2</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-88-close">(</span><span class="token keyword keyword-int">int</span> arr<span class="token punctuation brace-square brace-open brace-level-2" id="pair-93-close">[</span><span class="token punctuation brace-square brace-close brace-level-2" id="pair-93-open">]</span><span class="token punctuation brace-round brace-close brace-level-1" id="pair-88-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-97-close">{</span>
    <span class="token comment">// How do we ensure that arr has at least three elements?</span>
    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> arr<span class="token punctuation brace-square brace-open brace-level-2" id="pair-94-close">[</span><span class="token number">2</span><span class="token punctuation brace-square brace-close brace-level-2" id="pair-94-open">]</span> <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span><span class="token punctuation">;</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-97-open">}</span>

<span class="token keyword keyword-int">int</span> <span class="token function">main</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-89-close">(</span><span class="token punctuation brace-round brace-close brace-level-1" id="pair-89-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-101-close">{</span>
    <span class="token keyword keyword-int">int</span> a<span class="token punctuation brace-square brace-open brace-level-2" id="pair-95-close">[</span><span class="token punctuation brace-square brace-close brace-level-2" id="pair-95-open">]</span><span class="token punctuation brace-curly brace-open brace-level-2" id="pair-98-close">{</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-98-open">}</span><span class="token punctuation">;</span>
    <span class="token function">printElement2</span><span class="token punctuation brace-round brace-open brace-level-2" id="pair-90-close">(</span>a<span class="token punctuation brace-round brace-close brace-level-2" id="pair-90-open">)</span><span class="token punctuation">;</span>  <span class="token comment">// ok</span>

    <span class="token keyword keyword-int">int</span> b<span class="token punctuation brace-square brace-open brace-level-2" id="pair-96-close">[</span><span class="token punctuation brace-square brace-close brace-level-2" id="pair-96-open">]</span><span class="token punctuation brace-curly brace-open brace-level-2" id="pair-99-close">{</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">6</span> <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-99-open">}</span><span class="token punctuation">;</span>
    <span class="token function">printElement2</span><span class="token punctuation brace-round brace-open brace-level-2" id="pair-91-close">(</span>b<span class="token punctuation brace-round brace-close brace-level-2" id="pair-91-open">)</span><span class="token punctuation">;</span>  <span class="token comment">// compiles but produces undefined behavior</span>

    <span class="token keyword keyword-int">int</span> c<span class="token punctuation brace-curly brace-open brace-level-2" id="pair-100-close">{</span> <span class="token number">9</span> <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-100-open">}</span><span class="token punctuation">;</span>
    <span class="token function">printElement2</span><span class="token punctuation brace-round brace-open brace-level-2" id="pair-92-close">(</span><span class="token operator">&amp;</span>c<span class="token punctuation brace-round brace-close brace-level-2" id="pair-92-open">)</span><span class="token punctuation">;</span> <span class="token comment">// compiles but produces undefined behavior</span>

    <span class="token keyword keyword-return">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-101-open">}</span><span aria-hidden="true" class="line-numbers-rows"><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre>
  <div class="toolbar">
    <div class="toolbar-item">
      <button
        class="copy-to-clipboard-button"
        type="button"
        data-copy-state="copy"
      >
        <span>Copy</span>
      </button>
    </div>
  </div>
</div>
<p>
  Not having the array length also create challenges when traversing the array
  -- how do we know when we’ve reached the end?
</p>
<p>
  There are solutions to these issues, but these solutions add both complexity
  and fragility to a program.
</p>
<p class="cpp-section cpp-topline" style="clear: both">
  Working around array length issues
</p>
<p>
  Historically, programmers have worked around the lack of array length
  information via one of two methods.
</p>
<p>
  First, we can pass in both the array and the array length as separate
  arguments:
</p>
<div class="code-toolbar">
  <pre
    class="line-numbers language-cpp"
    tabindex="0"
  ><code class="match-braces language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;cassert&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>

<span class="token keyword keyword-void">void</span> <span class="token function">printElement2</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-102-close">(</span><span class="token keyword keyword-const">const</span> <span class="token keyword keyword-int">int</span> arr<span class="token punctuation brace-square brace-open brace-level-2" id="pair-111-close">[</span><span class="token punctuation brace-square brace-close brace-level-2" id="pair-111-open">]</span><span class="token punctuation">,</span> <span class="token keyword keyword-int">int</span> length<span class="token punctuation brace-round brace-close brace-level-1" id="pair-102-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-115-close">{</span>
    <span class="token function">assert</span><span class="token punctuation brace-round brace-open brace-level-2" id="pair-103-close">(</span>length <span class="token operator">&gt;</span> <span class="token number">2</span> <span class="token operator">&amp;&amp;</span> <span class="token string">"printElement2: Array too short"</span><span class="token punctuation brace-round brace-close brace-level-2" id="pair-103-open">)</span><span class="token punctuation">;</span> <span class="token comment">// can't static_assert on length</span>

    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> arr<span class="token punctuation brace-square brace-open brace-level-2" id="pair-112-close">[</span><span class="token number">2</span><span class="token punctuation brace-square brace-close brace-level-2" id="pair-112-open">]</span> <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span><span class="token punctuation">;</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-115-open">}</span>

<span class="token keyword keyword-int">int</span> <span class="token function">main</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-104-close">(</span><span class="token punctuation brace-round brace-close brace-level-1" id="pair-104-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-118-close">{</span>
    <span class="token keyword keyword-constexpr">constexpr</span> <span class="token keyword keyword-int">int</span> a<span class="token punctuation brace-square brace-open brace-level-2" id="pair-113-close">[</span><span class="token punctuation brace-square brace-close brace-level-2" id="pair-113-open">]</span><span class="token punctuation brace-curly brace-open brace-level-2" id="pair-116-close">{</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-116-open">}</span><span class="token punctuation">;</span>
    <span class="token function">printElement2</span><span class="token punctuation brace-round brace-open brace-level-2" id="pair-107-close">(</span>a<span class="token punctuation">,</span> <span class="token generic-function"><span class="token function">static_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword keyword-int">int</span><span class="token operator">&gt;</span></span></span><span class="token punctuation brace-round brace-open brace-level-3" id="pair-106-close">(</span>std<span class="token double-colon punctuation">::</span><span class="token function">size</span><span class="token punctuation brace-round brace-open brace-level-4" id="pair-105-close">(</span>a<span class="token punctuation brace-round brace-close brace-level-4" id="pair-105-open">)</span><span class="token punctuation brace-round brace-close brace-level-3" id="pair-106-open">)</span><span class="token punctuation brace-round brace-close brace-level-2" id="pair-107-open">)</span><span class="token punctuation">;</span>  <span class="token comment">// ok</span>

    <span class="token keyword keyword-constexpr">constexpr</span> <span class="token keyword keyword-int">int</span> b<span class="token punctuation brace-square brace-open brace-level-2" id="pair-114-close">[</span><span class="token punctuation brace-square brace-close brace-level-2" id="pair-114-open">]</span><span class="token punctuation brace-curly brace-open brace-level-2" id="pair-117-close">{</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">6</span> <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-117-open">}</span><span class="token punctuation">;</span>
    <span class="token function">printElement2</span><span class="token punctuation brace-round brace-open brace-level-2" id="pair-110-close">(</span>b<span class="token punctuation">,</span> <span class="token generic-function"><span class="token function">static_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword keyword-int">int</span><span class="token operator">&gt;</span></span></span><span class="token punctuation brace-round brace-open brace-level-3" id="pair-109-close">(</span>std<span class="token double-colon punctuation">::</span><span class="token function">size</span><span class="token punctuation brace-round brace-open brace-level-4" id="pair-108-close">(</span>b<span class="token punctuation brace-round brace-close brace-level-4" id="pair-108-open">)</span><span class="token punctuation brace-round brace-close brace-level-3" id="pair-109-open">)</span><span class="token punctuation brace-round brace-close brace-level-2" id="pair-110-open">)</span><span class="token punctuation">;</span>  <span class="token comment">// will trigger assert</span>

    <span class="token keyword keyword-return">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-118-open">}</span><span aria-hidden="true" class="line-numbers-rows"><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre>
  <div class="toolbar">
    <div class="toolbar-item">
      <button
        class="copy-to-clipboard-button"
        type="button"
        data-copy-state="copy"
      >
        <span>Copy</span>
      </button>
    </div>
  </div>
</div>
<p>However, this still has a number of issues:</p>
<ul>
  <li>
    The caller needs to make sure that the array and the array length are paired
    -- if the wrong value for length is passed in, the function will still
    malfunction.
  </li>
  <li>
    There are potential sign conversion issues if you’re using
    <code>std::size()</code> or a function that returns a length as
    <code>std::size_t</code>.
  </li>
  <li>
    Runtime asserts only trigger when encountered at runtime. If our testing
    path doesn’t cover all calls to the function, there’s a risk of shipping a
    program to the customer that will assert when they do something we didn’t
    explicitly test for. In modern C++, we’d want to use
    <code>static_assert</code> for compile-time validation of the array length
    of constexpr arrays, but there’s no easy way to do this (as function
    parameters can’t be constexpr, even in constexpr or consteval functions!).
  </li>
  <li>
    This method only works if we’re making an explicit function call. If the
    function call is implicit (e.g. we’re calling an operator with the array as
    an operand), then there’s no opportunity to pass in the length.
  </li>
</ul>
<p>
  Second, if there is an element value that is not semantically valid (e.g. a
  test score of <code>-1</code>), we can instead mark the end of the array using
  an element of that value. That way, the length of the array can be calculated
  by counting how many elements exist between the start of the array and this
  terminating element. The array can also be traversed by iterating from the
  start until we hit the terminating element. The nice thing about this method
  is that it works even with implicit function calls.
</p>
<div class="cpp-note cpp-lightbluebackground">
  <p class="cpp-note-title cpp-bottomline">Key insight</p>
  <p>
    C-style strings (which are C-style arrays) use a null-terminator to mark the
    end of the string, so that they can be traversed even if they have decayed.
  </p>
</div>
<p>But this method also has a number of issues:</p>
<ul>
  <li>
    If the terminating element does not exist, traversal will walk right off the
    end of the array, causing undefined behavior.
  </li>
  <li>
    Functions that traverse the array need special handling for the terminating
    element (e.g. a C-style string print function needs to know not to print the
    terminating element).
  </li>
  <li>
    There is a mismatch between the actual array length and the number of
    semantically valid elements. If the wrong length is used, the semantically
    invalid terminating element may be “processed”.
  </li>
  <li>
    This approach only works if a semantically invalid value exists, which is
    often not the case.
  </li>
</ul>
<p class="cpp-section cpp-topline" style="clear: both">
  C-style arrays should be avoided in most cases
</p>
<p>
  Because of the non-standard passing semantics (pass by address is used instead
  of pass by value) and risks associated with decayed arrays losing their length
  information, C-style arrays have generally fallen out of favor. We recommend
  avoiding them as much as possible.
</p>
<div class="cpp-note cpp-lightgreenbackground">
  <p class="cpp-note-title cpp-bottomline">Best practice</p>
  <p>Avoid C-style arrays whenever practical.</p>
  <ul>
    <li>
      Prefer <code>std::string_view</code> for read-only strings (string literal
      symbolic constants and string parameters).
    </li>
    <li>Prefer <code>std::string</code> for modifiable strings.</li>
    <li>Prefer <code>std::array</code> for non-global constexpr arrays.</li>
    <li>Prefer <code>std::vector</code> for non-constexpr arrays.</li>
  </ul>
  <p>
    It is okay to use C-style arrays for global constexpr arrays. We’ll discuss
    this in a moment.
  </p>
</div>
<div class="cpp-note cpp-lightgraybackground">
  <p class="cpp-note-title cpp-bottomline">As an aside…</p>
  <p>
    In C++, arrays can be passed by reference, in which case the array argument
    won’t decay when passed to a function (but the reference to the array will
    still decay when evaluated). However, it’s easy to forget to apply this
    consistently, and one missed reference will lead to decaying arguments.
    Also, array reference parameters must have a fixed length, meaning the
    function can only handle arrays of one particular length. If we want a
    function that can handle arrays of different lengths, then we also have to
    use function templates. But if you’re going to do both of those things to
    “fix” C-style arrays, then you might as well just use
    <code>std::array</code>!
  </p>
</div>
<p class="cpp-section cpp-topline" style="clear: both">
  So when are C-style arrays used in modern C++?
</p>
<p>In modern C++, C-style arrays are typically used in two cases:</p>
<ol start="1">
  <li>
    To store constexpr global (or constexpr static local) program data. Because
    such arrays can be accessed directly from anywhere in the program, we do not
    need to pass the array, which avoids decay-related issues. The syntax for
    defining C-style arrays can be a little less wonky than
    <code>std::array</code>. More importantly, indexing such arrays does not
    have sign conversion issues like the standard library container classes do.
  </li>
  <li>
    As parameters to functions or classes that want to handle non-constexpr
    C-style string arguments directly (rather than requiring a conversion to
    <code>std::string_view</code>). There are two possible reasons for this:
    First, converting a non-constexpr C-style string to a
    <code>std::string_view</code> requires traversing the C-style string to
    determine its length. If the function is in a performance critical section
    of code and the length isn’t needed (e.g. because the function is going to
    traverse the string anyway) then avoiding the conversion may be useful.
    Second, if the function (or class) calls other functions that expect C-style
    strings, converting to a <code>std::string_view</code> just to convert back
    may be suboptimal (unless you have other reasons for wanting a
    <code>std::string_view</code>).
  </li>
</ol>
<p></p>
<p class="cpp-section cpp-topline" style="clear: both">Quiz time</p>
<p class="cpp-quiz-question" style="clear: both">Question #1</p>
<p></p>
<p>What is array decay, and why is it a problem?</p>
<p>
  <a
    class="solution_link_show"
    href="javascript:void(0)"
    onclick="cppSolutionToggle(document.getElementById('cpp_solution_id_0'), this, 'Show Solution', 'Hide Solution')"
    >Show Solution</a
  >
</p>
<div class="wpsolution" id="cpp_solution_id_0" style="display: none">
  <p>
    When a C-style array is evaluated, in most contexts it will be implicitly
    converted to a pointer to the array’s element type.
  </p>
  <p>
    Decayed arrays lose their length information, which makes it easier for
    length-related bugs to be introduced into the program.
  </p>
</div>
<p class="cpp-quiz-question cpp-topline" style="clear: both">Question #2</p>
<p>Why do C-style strings (which are C-style arrays) use a null terminator?</p>
<p>
  <a
    class="solution_link_show"
    href="javascript:void(0)"
    onclick="cppSolutionToggle(document.getElementById('cpp_solution_id_1'), this, 'Show Solution', 'Hide Solution')"
    >Show Solution</a
  >
</p>
<div class="wpsolution" id="cpp_solution_id_1" style="display: none">
  <p>
    When a C-style array is passed to a function, it decays and loses its length
    information. If the C-style string didn’t have a null terminator, the
    function would not be able to determine how long the string was.
  </p>
</div>
<p class="cpp-quiz-question cpp-topline" style="clear: both">Question #3</p>
<p>
  Extra credit: Why do C-style strings use a null-terminator instead of
  requiring both the decayed C-style string and explicit length information to
  be passed to a function?
</p>
<p>
  <a
    class="solution_link_show"
    href="javascript:void(0)"
    onclick="cppSolutionToggle(document.getElementById('cpp_solution_id_2'), this, 'Show Solution', 'Hide Solution')"
    >Show Solution</a
  >
</p>
<div class="wpsolution" id="cpp_solution_id_2" style="display: none">
  <p>There are probably many answers to this question, but here are some:</p>
  <ul>
    <li>
      The ergonomics would be horrible, as we’d have extra parameters and magic
      numbers everywhere (e.g. <code>printString("Hello", 5)</code>).
    </li>
    <li>
      It would be very easy for the string and the provided string length to not
      match properly. The string length is essentially an invariant of the
      string itself. Relying on the user to maintain this invariant will
      invariably lead to errors (e.g. <code>printString("Hello", 6)</code>).
    </li>
  </ul>
</div>
<p>
  Extra Credit #2: Even if C++ wanted to implement having to pass explicit
  length information, why wouldn’t it work?
</p>
<p>
  <a
    class="hint_link_show"
    href="javascript:void(0)"
    onclick="cppHintToggle(document.getElementById('cpp_hint_id_0'), this, 'Show Hint', '')"
    >Show Hint</a
  >
</p>
<div
  class="wphint"
  id="cpp_hint_id_0"
  style="display: none; margin-bottom: 1em"
>
  Hint: Consider the case where we are printing a string using
  <code>std::cout</code>.
</div>
<p>
  <a
    class="solution_link_show"
    href="javascript:void(0)"
    onclick="cppSolutionToggle(document.getElementById('cpp_solution_id_3'), this, 'Show Solution', 'Hide Solution')"
    >Show Solution</a
  >
</p>
<div class="wpsolution" id="cpp_solution_id_3" style="display: none">
  <p>
    Passing both the C-style string and explicit length information is only
    possible if a function is called explicitly. If a function is called
    implicitly, there is no way to pass along the length information.
  </p>
  <p>
    Consider a statement like <code>std::cout &lt;&lt; cstr</code>. Binary
    <code>operator&lt;&lt;</code> can only take two operands:
    <code>std::cout</code> and <code>cstr</code>. There is no way to pass
    another argument representing the length information. The null-terminator
    approach doesn’t have this issue.
  </p>
</div>
<div class="prevnext">
  <div class="prevnext-inline">
    <a
      class="nav-link"
      href="https://www.learncpp.com/cpp-tutorial/pointer-arithmetic-and-subscripting/"
    >
      <div class="nav-button nav-button-next">
        <div class="nav-button-icon">
          <i class="fa fa-chevron-circle-right" aria-hidden="true"></i>
        </div>
        <div class="nav-button-text">
          <div class="nav-button-title">Next lesson</div>
          <div class="nav-button-lesson">
            <span class="nav-button-lesson-number">17.9</span>Pointer arithmetic
            and subscripting
          </div>
        </div>
      </div></a
    >
    <a class="nav-link" href="/">
      <div class="nav-button nav-button-index">
        <div class="nav-button-icon">
          <i class="fa fa-home" aria-hidden="true"></i>
        </div>
        <div class="nav-button-text">
          <div class="nav-button-title">Back to table of contents</div>
        </div>
      </div></a
    >
    <a
      class="nav-link"
      href="https://www.learncpp.com/cpp-tutorial/introduction-to-c-style-arrays/"
    >
      <div class="nav-button nav-button-prev">
        <div class="nav-button-icon">
          <i class="fa fa-chevron-circle-left" aria-hidden="true"></i>
        </div>
        <div class="nav-button-text">
          <div class="nav-button-title">Previous lesson</div>
          <div class="nav-button-lesson">
            <span class="nav-button-lesson-number">17.7</span>Introduction to
            C-style arrays
          </div>
        </div>
      </div></a
    >
  </div>
</div>
<div class="code-block code-block-10" style="margin: 8px 0; clear: both"></div>

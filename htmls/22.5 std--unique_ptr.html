<div
  class="code-block code-block-1"
  style="margin: 8px 8px 8px 0; float: left"
></div>
<p>
  At the beginning of the chapter, we discussed how the use of pointers can lead
  to bugs and memory leaks in some situations. For example, this can happen when
  a function early returns, or throws an exception, and the pointer is not
  properly deleted.
</p>
<div class="code-toolbar">
  <pre
    class="line-numbers language-cpp"
    tabindex="0"
  ><code class="match-braces language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>

<span class="token keyword keyword-void">void</span> <span class="token function">someFunction</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-0-close">(</span><span class="token punctuation brace-round brace-close brace-level-1" id="pair-0-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-5-close">{</span>
    <span class="token keyword keyword-auto">auto</span><span class="token operator">*</span> ptr<span class="token punctuation brace-curly brace-open brace-level-2" id="pair-3-close">{</span> <span class="token keyword keyword-new">new</span> <span class="token function">Resource</span><span class="token punctuation brace-round brace-open brace-level-3" id="pair-1-close">(</span><span class="token punctuation brace-round brace-close brace-level-3" id="pair-1-open">)</span> <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-3-open">}</span><span class="token punctuation">;</span>

    <span class="token keyword keyword-int">int</span> x<span class="token punctuation brace-curly brace-open brace-level-2" id="pair-4-close">{</span><span class="token punctuation brace-curly brace-close brace-level-2" id="pair-4-open">}</span><span class="token punctuation">;</span>
    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Enter an integer: "</span><span class="token punctuation">;</span>
    std<span class="token double-colon punctuation">::</span>cin <span class="token operator">&gt;&gt;</span> x<span class="token punctuation">;</span>

    <span class="token keyword keyword-if">if</span> <span class="token punctuation brace-round brace-open brace-level-2" id="pair-2-close">(</span>x <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation brace-round brace-close brace-level-2" id="pair-2-open">)</span>
        <span class="token keyword keyword-throw">throw</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// the function returns early, and ptr won’t be deleted!</span>

    <span class="token comment">// do stuff with ptr here</span>

    <span class="token keyword keyword-delete">delete</span> ptr<span class="token punctuation">;</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-5-open">}</span><span aria-hidden="true" class="line-numbers-rows"><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre>
  <div class="toolbar">
    <div class="toolbar-item">
      <button
        class="copy-to-clipboard-button"
        type="button"
        data-copy-state="copy"
      >
        <span>Copy</span>
      </button>
    </div>
  </div>
</div>
<p>
  Now that we’ve covered the fundamentals of move semantics, we can return to
  the topic of smart pointer classes. Although smart pointers can offer other
  features, the defining characteristic of a smart pointer is that it manages a
  dynamically allocated resource provided by the user of the smart pointer, and
  ensures the dynamically allocated object is properly cleaned up at the
  appropriate time (usually when the smart pointer goes out of scope).
</p>
<p>
  Because of this, smart pointers should never be dynamically allocated
  themselves (otherwise, there is the risk that the smart pointer may not be
  properly deallocated, which means the object it owns would not be deallocated,
  causing a memory leak). By always allocating smart pointers on the stack (as
  local variables or composition members of a class), we’re guaranteed that the
  smart pointer will properly go out of scope when the function or object it is
  contained within ends, ensuring the object the smart pointer owns is properly
  deallocated.
</p>
<p>
  C++11 standard library ships with 4 smart pointer classes: std::auto_ptr
  (removed in C++17), std::unique_ptr, std::shared_ptr, and std::weak_ptr.
  std::unique_ptr is by far the most used smart pointer class, so we’ll cover
  that one first. In the following lessons, we’ll cover std::shared_ptr and
  std::weak_ptr.
</p>
<div
  class="google-auto-placed ap_container"
  style="width: 100%; height: auto; clear: both; text-align: center"
>
  <ins
    data-ad-format="auto"
    class="adsbygoogle adsbygoogle-noablate"
    data-ad-client="ca-pub-0588844875925051"
    data-adsbygoogle-status="done"
    style="
      display: block;
      margin: auto;
      background-color: transparent;
      height: 0px;
    "
    data-ad-status="unfilled"
    ><div
      id="aswift_5_host"
      style="
        border: none;
        height: 0px;
        width: 1027px;
        margin: 0px;
        padding: 0px;
        position: relative;
        visibility: visible;
        background-color: transparent;
        display: inline-block;
        overflow: hidden;
        opacity: 0;
      "
    >
      <iframe
        id="aswift_5"
        name="aswift_5"
        browsingtopics="true"
        style="
          left: 0px;
          position: absolute;
          top: 0px;
          border: 0px;
          width: 1027px;
          height: 0px;
          min-height: auto;
          max-height: none;
          min-width: auto;
          max-width: none;
        "
        sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation"
        width="1027"
        height="0"
        frameborder="0"
        marginwidth="0"
        marginheight="0"
        vspace="0"
        hspace="0"
        allowtransparency="true"
        scrolling="no"
        allow="attribution-reporting; run-ad-auction"
        src="https://googleads.g.doubleclick.net/pagead/ads?client=ca-pub-0588844875925051&amp;output=html&amp;h=280&amp;adk=74038387&amp;adf=1968262057&amp;w=1027&amp;abgtt=11&amp;fwrn=4&amp;fwrnh=100&amp;lmt=1750391393&amp;num_ads=1&amp;rafmt=1&amp;armr=3&amp;sem=mc&amp;pwprc=4633386603&amp;ad_type=text_image&amp;format=1027x280&amp;url=https%3A%2F%2Fwww.learncpp.com%2Fcpp-tutorial%2Fstdunique_ptr%2F&amp;fwr=0&amp;pra=3&amp;rh=200&amp;rw=1026&amp;rpe=1&amp;resp_fmts=3&amp;wgl=1&amp;fa=27&amp;uach=WyJXaW5kb3dzIiwiMTkuMC4wIiwieDg2IiwiIiwiMTM3LjAuNzE1MS4xMjIiLG51bGwsMCxudWxsLCI2NCIsW1siR29vZ2xlIENocm9tZSIsIjEzNy4wLjcxNTEuMTIyIl0sWyJDaHJvbWl1bSIsIjEzNy4wLjcxNTEuMTIyIl0sWyJOb3QvQSlCcmFuZCIsIjI0LjAuMC4wIl1dLDBd&amp;dt=1751963412794&amp;bpp=1&amp;bdt=791&amp;idt=-M&amp;shv=r20250702&amp;mjsv=m202507020101&amp;ptt=9&amp;saldr=aa&amp;abxe=1&amp;cookie=ID%3D05f6e82287d810b4%3AT%3D1751962604%3ART%3D1751963214%3AS%3DALNI_MaQYA0TSAU2k8xwY5tqlN0xFCcd6g&amp;gpic=UID%3D00001157d9e27d0a%3AT%3D1751962604%3ART%3D1751963214%3AS%3DALNI_MYgtHzQJAQQXY_151HTGSSfVxE8_A&amp;eo_id_str=ID%3D52c21936d98c6d2b%3AT%3D1751962604%3ART%3D1751963214%3AS%3DAA-AfjZsJ15yjdEPJ8d11hPojsJQ&amp;prev_fmts=0x0%2C336x280%2C160x600%2C160x600&amp;nras=2&amp;correlator=766581528464&amp;frm=20&amp;pv=1&amp;u_tz=480&amp;u_his=2&amp;u_h=600&amp;u_w=800&amp;u_ah=600&amp;u_aw=800&amp;u_cd=24&amp;u_sd=1&amp;dmc=8&amp;adx=27&amp;ady=1050&amp;biw=1080&amp;bih=1024&amp;scr_x=0&amp;scr_y=0&amp;eid=31093235%2C95353386%2C95362655%2C95365226%2C95365234%2C42533293%2C95359265%2C95365122%2C95365798&amp;oid=2&amp;pvsid=4647814794486465&amp;tmod=1708485235&amp;uas=0&amp;nvt=1&amp;fc=1408&amp;brdim=10%2C10%2C10%2C10%2C800%2C0%2C780%2C580%2C1080%2C1024&amp;vis=1&amp;rsz=%7C%7Cs%7C&amp;abl=NS&amp;fu=128&amp;bc=31&amp;bz=0.72&amp;td=1&amp;tdf=2&amp;psd=W251bGwsbnVsbCxudWxsLDNd&amp;nt=1&amp;ifi=6&amp;uci=a!6&amp;btvi=1&amp;fsb=1&amp;dtd=18"
        data-google-container-id="a!6"
        tabindex="0"
        title="Advertisement"
        aria-label="Advertisement"
        data-load-complete="true"
        data-google-query-id="CNC9zKbsrI4DFcpaDwIdPvkEkQ"
      ></iframe></div
  ></ins>
</div>
<p class="cpp-section cpp-topline" style="clear: both">std::unique_ptr</p>
<p>
  std::unique_ptr is the C++11 replacement for std::auto_ptr. It should be used
  to manage any dynamically allocated object that is not shared by multiple
  objects. That is, std::unique_ptr should completely own the object it manages,
  not share that ownership with other classes. std::unique_ptr lives in the
  &lt;memory&gt; header.
</p>
<div class="code-block code-block-2" style="margin: 8px 0; clear: both"></div>

<p>Let’s take a look at a simple smart pointer example:</p>
<div class="code-toolbar">
  <pre
    class="line-numbers language-cpp"
    tabindex="0"
  ><code class="match-braces language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;memory&gt;</span> <span class="token comment">// for std::unique_ptr</span></span>

<span class="token keyword keyword-class">class</span> <span class="token class-name">Resource</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-12-close">{</span>
<span class="token keyword keyword-public">public</span><span class="token operator">:</span>
	<span class="token function">Resource</span><span class="token punctuation brace-round brace-open brace-level-2" id="pair-6-close">(</span><span class="token punctuation brace-round brace-close brace-level-2" id="pair-6-open">)</span> <span class="token punctuation brace-curly brace-open brace-level-2" id="pair-10-close">{</span> std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Resource acquired\n"</span><span class="token punctuation">;</span> <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-10-open">}</span>
	<span class="token operator">~</span><span class="token function">Resource</span><span class="token punctuation brace-round brace-open brace-level-2" id="pair-7-close">(</span><span class="token punctuation brace-round brace-close brace-level-2" id="pair-7-open">)</span> <span class="token punctuation brace-curly brace-open brace-level-2" id="pair-11-close">{</span> std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Resource destroyed\n"</span><span class="token punctuation">;</span> <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-11-open">}</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-12-open">}</span><span class="token punctuation">;</span>

<span class="token keyword keyword-int">int</span> <span class="token function">main</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-8-close">(</span><span class="token punctuation brace-round brace-close brace-level-1" id="pair-8-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-14-close">{</span>
	<span class="token comment">// allocate a Resource object and have it owned by std::unique_ptr</span>
	std<span class="token double-colon punctuation">::</span>unique_ptr<span class="token operator">&lt;</span>Resource<span class="token operator">&gt;</span> res<span class="token punctuation brace-curly brace-open brace-level-2" id="pair-13-close">{</span> <span class="token keyword keyword-new">new</span> <span class="token function">Resource</span><span class="token punctuation brace-round brace-open brace-level-3" id="pair-9-close">(</span><span class="token punctuation brace-round brace-close brace-level-3" id="pair-9-open">)</span> <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-13-open">}</span><span class="token punctuation">;</span>

	<span class="token keyword keyword-return">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-14-open">}</span> <span class="token comment">// res goes out of scope here, and the allocated Resource is destroyed</span><span aria-hidden="true" class="line-numbers-rows"><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre>
  <div class="toolbar">
    <div class="toolbar-item">
      <button
        class="copy-to-clipboard-button"
        type="button"
        data-copy-state="copy"
      >
        <span>Copy</span>
      </button>
    </div>
  </div>
</div>
<div
  class="google-auto-placed ap_container"
  style="width: 100%; height: auto; clear: both; text-align: center"
>
  <ins
    data-ad-format="auto"
    class="adsbygoogle adsbygoogle-noablate"
    data-ad-client="ca-pub-0588844875925051"
    data-adsbygoogle-status="done"
    style="
      display: block;
      margin: auto;
      background-color: transparent;
      height: 0px;
    "
    data-ad-status="unfilled"
    ><div
      id="aswift_6_host"
      style="
        border: none;
        height: 0px;
        width: 1027px;
        margin: 0px;
        padding: 0px;
        position: relative;
        visibility: visible;
        background-color: transparent;
        display: inline-block;
        overflow: hidden;
        opacity: 0;
      "
    >
      <iframe
        id="aswift_6"
        name="aswift_6"
        browsingtopics="true"
        style="
          left: 0px;
          position: absolute;
          top: 0px;
          border: 0px;
          width: 1027px;
          height: 0px;
          min-height: auto;
          max-height: none;
          min-width: auto;
          max-width: none;
        "
        sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation"
        width="1027"
        height="0"
        frameborder="0"
        marginwidth="0"
        marginheight="0"
        vspace="0"
        hspace="0"
        allowtransparency="true"
        scrolling="no"
        allow="attribution-reporting; run-ad-auction"
        src="https://googleads.g.doubleclick.net/pagead/ads?client=ca-pub-0588844875925051&amp;output=html&amp;h=280&amp;adk=74038387&amp;adf=2676406664&amp;w=1027&amp;abgtt=11&amp;fwrn=4&amp;fwrnh=100&amp;lmt=1750391393&amp;num_ads=1&amp;rafmt=1&amp;armr=3&amp;sem=mc&amp;pwprc=4633386603&amp;ad_type=text_image&amp;format=1027x280&amp;url=https%3A%2F%2Fwww.learncpp.com%2Fcpp-tutorial%2Fstdunique_ptr%2F&amp;fwr=0&amp;pra=3&amp;rh=200&amp;rw=1026&amp;rpe=1&amp;resp_fmts=3&amp;wgl=1&amp;fa=27&amp;uach=WyJXaW5kb3dzIiwiMTkuMC4wIiwieDg2IiwiIiwiMTM3LjAuNzE1MS4xMjIiLG51bGwsMCxudWxsLCI2NCIsW1siR29vZ2xlIENocm9tZSIsIjEzNy4wLjcxNTEuMTIyIl0sWyJDaHJvbWl1bSIsIjEzNy4wLjcxNTEuMTIyIl0sWyJOb3QvQSlCcmFuZCIsIjI0LjAuMC4wIl1dLDBd&amp;dt=1751963412794&amp;bpp=1&amp;bdt=791&amp;idt=-M&amp;shv=r20250702&amp;mjsv=m202507020101&amp;ptt=9&amp;saldr=aa&amp;abxe=1&amp;cookie=ID%3D05f6e82287d810b4%3AT%3D1751962604%3ART%3D1751963214%3AS%3DALNI_MaQYA0TSAU2k8xwY5tqlN0xFCcd6g&amp;gpic=UID%3D00001157d9e27d0a%3AT%3D1751962604%3ART%3D1751963214%3AS%3DALNI_MYgtHzQJAQQXY_151HTGSSfVxE8_A&amp;eo_id_str=ID%3D52c21936d98c6d2b%3AT%3D1751962604%3ART%3D1751963214%3AS%3DAA-AfjZsJ15yjdEPJ8d11hPojsJQ&amp;prev_fmts=0x0%2C336x280%2C160x600%2C160x600%2C1027x280&amp;nras=3&amp;correlator=766581528464&amp;frm=20&amp;pv=1&amp;u_tz=480&amp;u_his=2&amp;u_h=600&amp;u_w=800&amp;u_ah=600&amp;u_aw=800&amp;u_cd=24&amp;u_sd=1&amp;dmc=8&amp;adx=27&amp;ady=1785&amp;biw=1080&amp;bih=1024&amp;scr_x=0&amp;scr_y=0&amp;eid=31093235%2C95353386%2C95362655%2C95365226%2C95365234%2C42533293%2C95359265%2C95365122%2C95365798&amp;oid=2&amp;pvsid=4647814794486465&amp;tmod=1708485235&amp;uas=0&amp;nvt=1&amp;fc=1408&amp;brdim=10%2C10%2C10%2C10%2C800%2C0%2C780%2C580%2C1080%2C1024&amp;vis=1&amp;rsz=%7C%7Cs%7C&amp;abl=NS&amp;fu=128&amp;bc=31&amp;bz=0.72&amp;td=1&amp;tdf=2&amp;psd=W251bGwsbnVsbCxudWxsLDNd&amp;nt=1&amp;ifi=7&amp;uci=a!7&amp;btvi=2&amp;fsb=1&amp;dtd=19"
        data-google-container-id="a!7"
        tabindex="0"
        title="Advertisement"
        aria-label="Advertisement"
        data-load-complete="true"
        data-google-query-id="CLLkzKbsrI4DFTlaDwIdXas7kQ"
      ></iframe></div
  ></ins>
</div>
<p>
  Because the std::unique_ptr is allocated on the stack here, it’s guaranteed to
  eventually go out of scope, and when it does, it will delete the Resource it
  is managing.
</p>
<p>Unlike std::auto_ptr, std::unique_ptr properly implements move semantics.</p>
<div class="code-toolbar">
  <pre
    class="line-numbers language-cpp"
    tabindex="0"
  ><code class="match-braces language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;memory&gt;</span> <span class="token comment">// for std::unique_ptr</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;utility&gt;</span> <span class="token comment">// for std::move</span></span>

<span class="token keyword keyword-class">class</span> <span class="token class-name">Resource</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-25-close">{</span>
<span class="token keyword keyword-public">public</span><span class="token operator">:</span>
	<span class="token function">Resource</span><span class="token punctuation brace-round brace-open brace-level-2" id="pair-15-close">(</span><span class="token punctuation brace-round brace-close brace-level-2" id="pair-15-open">)</span> <span class="token punctuation brace-curly brace-open brace-level-2" id="pair-23-close">{</span> std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Resource acquired\n"</span><span class="token punctuation">;</span> <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-23-open">}</span>
	<span class="token operator">~</span><span class="token function">Resource</span><span class="token punctuation brace-round brace-open brace-level-2" id="pair-16-close">(</span><span class="token punctuation brace-round brace-close brace-level-2" id="pair-16-open">)</span> <span class="token punctuation brace-curly brace-open brace-level-2" id="pair-24-close">{</span> std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Resource destroyed\n"</span><span class="token punctuation">;</span> <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-24-open">}</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-25-open">}</span><span class="token punctuation">;</span>

<span class="token keyword keyword-int">int</span> <span class="token function">main</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-17-close">(</span><span class="token punctuation brace-round brace-close brace-level-1" id="pair-17-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-29-close">{</span>
	std<span class="token double-colon punctuation">::</span>unique_ptr<span class="token operator">&lt;</span>Resource<span class="token operator">&gt;</span> res1<span class="token punctuation brace-curly brace-open brace-level-2" id="pair-27-close">{</span> <span class="token keyword keyword-new">new</span> Resource<span class="token punctuation brace-curly brace-open brace-level-3" id="pair-26-close">{</span><span class="token punctuation brace-curly brace-close brace-level-3" id="pair-26-open">}</span> <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-27-open">}</span><span class="token punctuation">;</span> <span class="token comment">// Resource created here</span>
	std<span class="token double-colon punctuation">::</span>unique_ptr<span class="token operator">&lt;</span>Resource<span class="token operator">&gt;</span> res2<span class="token punctuation brace-curly brace-open brace-level-2" id="pair-28-close">{</span><span class="token punctuation brace-curly brace-close brace-level-2" id="pair-28-open">}</span><span class="token punctuation">;</span> <span class="token comment">// Start as nullptr</span>

	std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"res1 is "</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation brace-round brace-open brace-level-2" id="pair-18-close">(</span>res1 <span class="token operator">?</span> <span class="token string">"not null\n"</span> <span class="token operator">:</span> <span class="token string">"null\n"</span><span class="token punctuation brace-round brace-close brace-level-2" id="pair-18-open">)</span><span class="token punctuation">;</span>
	std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"res2 is "</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation brace-round brace-open brace-level-2" id="pair-19-close">(</span>res2 <span class="token operator">?</span> <span class="token string">"not null\n"</span> <span class="token operator">:</span> <span class="token string">"null\n"</span><span class="token punctuation brace-round brace-close brace-level-2" id="pair-19-open">)</span><span class="token punctuation">;</span>

	<span class="token comment">// res2 = res1; // Won't compile: copy assignment is disabled</span>
	res2 <span class="token operator">=</span> std<span class="token double-colon punctuation">::</span><span class="token function">move</span><span class="token punctuation brace-round brace-open brace-level-2" id="pair-20-close">(</span>res1<span class="token punctuation brace-round brace-close brace-level-2" id="pair-20-open">)</span><span class="token punctuation">;</span> <span class="token comment">// res2 assumes ownership, res1 is set to null</span>

	std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Ownership transferred\n"</span><span class="token punctuation">;</span>

	std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"res1 is "</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation brace-round brace-open brace-level-2" id="pair-21-close">(</span>res1 <span class="token operator">?</span> <span class="token string">"not null\n"</span> <span class="token operator">:</span> <span class="token string">"null\n"</span><span class="token punctuation brace-round brace-close brace-level-2" id="pair-21-open">)</span><span class="token punctuation">;</span>
	std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"res2 is "</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation brace-round brace-open brace-level-2" id="pair-22-close">(</span>res2 <span class="token operator">?</span> <span class="token string">"not null\n"</span> <span class="token operator">:</span> <span class="token string">"null\n"</span><span class="token punctuation brace-round brace-close brace-level-2" id="pair-22-open">)</span><span class="token punctuation">;</span>

	<span class="token keyword keyword-return">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-29-open">}</span> <span class="token comment">// Resource destroyed here when res2 goes out of scope</span><span aria-hidden="true" class="line-numbers-rows"><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre>
  <div class="toolbar">
    <div class="toolbar-item">
      <button
        class="copy-to-clipboard-button"
        type="button"
        data-copy-state="copy"
      >
        <span>Copy</span>
      </button>
    </div>
  </div>
</div>
<div
  class="google-auto-placed ap_container"
  style="width: 100%; height: auto; clear: both; text-align: center"
>
  <ins
    data-ad-format="auto"
    class="adsbygoogle adsbygoogle-noablate"
    data-ad-client="ca-pub-0588844875925051"
    data-adsbygoogle-status="done"
    style="
      display: block;
      margin: auto;
      background-color: transparent;
      height: 0px;
    "
    data-ad-status="unfilled"
    ><div
      id="aswift_7_host"
      style="
        border: none;
        height: 0px;
        width: 1027px;
        margin: 0px;
        padding: 0px;
        position: relative;
        visibility: visible;
        background-color: transparent;
        display: inline-block;
        overflow: hidden;
        opacity: 0;
      "
    >
      <iframe
        id="aswift_7"
        name="aswift_7"
        browsingtopics="true"
        style="
          left: 0px;
          position: absolute;
          top: 0px;
          border: 0px;
          width: 1027px;
          height: 0px;
          min-height: auto;
          max-height: none;
          min-width: auto;
          max-width: none;
        "
        sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation"
        width="1027"
        height="0"
        frameborder="0"
        marginwidth="0"
        marginheight="0"
        vspace="0"
        hspace="0"
        allowtransparency="true"
        scrolling="no"
        allow="attribution-reporting; run-ad-auction"
        src="https://googleads.g.doubleclick.net/pagead/ads?client=ca-pub-0588844875925051&amp;output=html&amp;h=280&amp;adk=74038387&amp;adf=631958980&amp;w=1027&amp;abgtt=11&amp;fwrn=4&amp;fwrnh=100&amp;lmt=1750391393&amp;num_ads=1&amp;rafmt=1&amp;armr=3&amp;sem=mc&amp;pwprc=4633386603&amp;ad_type=text_image&amp;format=1027x280&amp;url=https%3A%2F%2Fwww.learncpp.com%2Fcpp-tutorial%2Fstdunique_ptr%2F&amp;fwr=0&amp;pra=3&amp;rh=200&amp;rw=1026&amp;rpe=1&amp;resp_fmts=3&amp;wgl=1&amp;fa=27&amp;uach=WyJXaW5kb3dzIiwiMTkuMC4wIiwieDg2IiwiIiwiMTM3LjAuNzE1MS4xMjIiLG51bGwsMCxudWxsLCI2NCIsW1siR29vZ2xlIENocm9tZSIsIjEzNy4wLjcxNTEuMTIyIl0sWyJDaHJvbWl1bSIsIjEzNy4wLjcxNTEuMTIyIl0sWyJOb3QvQSlCcmFuZCIsIjI0LjAuMC4wIl1dLDBd&amp;dt=1751963412794&amp;bpp=1&amp;bdt=791&amp;idt=-M&amp;shv=r20250702&amp;mjsv=m202507020101&amp;ptt=9&amp;saldr=aa&amp;abxe=1&amp;cookie=ID%3D05f6e82287d810b4%3AT%3D1751962604%3ART%3D1751963214%3AS%3DALNI_MaQYA0TSAU2k8xwY5tqlN0xFCcd6g&amp;gpic=UID%3D00001157d9e27d0a%3AT%3D1751962604%3ART%3D1751963214%3AS%3DALNI_MYgtHzQJAQQXY_151HTGSSfVxE8_A&amp;eo_id_str=ID%3D52c21936d98c6d2b%3AT%3D1751962604%3ART%3D1751963214%3AS%3DAA-AfjZsJ15yjdEPJ8d11hPojsJQ&amp;prev_fmts=0x0%2C336x280%2C160x600%2C160x600%2C1027x280%2C1027x280&amp;nras=4&amp;correlator=766581528464&amp;frm=20&amp;pv=1&amp;u_tz=480&amp;u_his=2&amp;u_h=600&amp;u_w=800&amp;u_ah=600&amp;u_aw=800&amp;u_cd=24&amp;u_sd=1&amp;dmc=8&amp;adx=27&amp;ady=2644&amp;biw=1080&amp;bih=1024&amp;scr_x=0&amp;scr_y=0&amp;eid=31093235%2C95353386%2C95362655%2C95365226%2C95365234%2C42533293%2C95359265%2C95365122%2C95365798&amp;oid=2&amp;pvsid=4647814794486465&amp;tmod=1708485235&amp;uas=0&amp;nvt=1&amp;fc=1408&amp;brdim=10%2C10%2C10%2C10%2C800%2C0%2C780%2C580%2C1080%2C1024&amp;vis=1&amp;rsz=%7C%7Cs%7C&amp;abl=NS&amp;fu=128&amp;bc=31&amp;bz=0.72&amp;td=1&amp;tdf=2&amp;psd=W251bGwsbnVsbCxudWxsLDNd&amp;nt=1&amp;ifi=8&amp;uci=a!8&amp;btvi=3&amp;fsb=1&amp;dtd=20"
        data-google-container-id="a!8"
        tabindex="0"
        title="Advertisement"
        aria-label="Advertisement"
        data-google-query-id="CNe51qbsrI4DFZdgDwId2n4djg"
        data-load-complete="true"
      ></iframe></div
  ></ins>
</div>
<p>This prints:</p>
<pre>
Resource acquired
res1 is not null
res2 is null
Ownership transferred
res1 is null
res2 is not null
Resource destroyed
</pre>
<p>
  Because std::unique_ptr is designed with move semantics in mind, copy
  initialization and copy assignment are disabled. If you want to transfer the
  contents managed by std::unique_ptr, you must use move semantics. In the
  program above, we accomplish this via std::move (which converts res1 into an
  r-value, which triggers a move assignment instead of a copy assignment).
</p>
<p class="cpp-section cpp-topline" style="clear: both">
  Accessing the managed object
</p>
<div
  class="google-auto-placed ap_container"
  style="width: 100%; height: auto; clear: both; text-align: center"
>
  <ins
    data-ad-format="auto"
    class="adsbygoogle adsbygoogle-noablate"
    data-ad-client="ca-pub-0588844875925051"
    data-adsbygoogle-status="done"
    style="
      display: block;
      margin: auto;
      background-color: transparent;
      height: 0px;
    "
    data-ad-status="unfilled"
    ><div
      id="aswift_8_host"
      style="
        border: none;
        height: 0px;
        width: 1027px;
        margin: 0px;
        padding: 0px;
        position: relative;
        visibility: visible;
        background-color: transparent;
        display: inline-block;
        overflow: hidden;
        opacity: 0;
      "
    >
      <iframe
        id="aswift_8"
        name="aswift_8"
        browsingtopics="true"
        style="
          left: 0px;
          position: absolute;
          top: 0px;
          border: 0px;
          width: 1027px;
          height: 0px;
          min-height: auto;
          max-height: none;
          min-width: auto;
          max-width: none;
        "
        sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation"
        width="1027"
        height="0"
        frameborder="0"
        marginwidth="0"
        marginheight="0"
        vspace="0"
        hspace="0"
        allowtransparency="true"
        scrolling="no"
        allow="attribution-reporting; run-ad-auction"
        src="https://googleads.g.doubleclick.net/pagead/ads?client=ca-pub-0588844875925051&amp;output=html&amp;h=280&amp;adk=74038387&amp;adf=2307335036&amp;w=1027&amp;abgtt=11&amp;fwrn=4&amp;fwrnh=100&amp;lmt=1750391393&amp;num_ads=1&amp;rafmt=1&amp;armr=3&amp;sem=mc&amp;pwprc=4633386603&amp;ad_type=text_image&amp;format=1027x280&amp;url=https%3A%2F%2Fwww.learncpp.com%2Fcpp-tutorial%2Fstdunique_ptr%2F&amp;fwr=0&amp;pra=3&amp;rh=200&amp;rw=1026&amp;rpe=1&amp;resp_fmts=3&amp;wgl=1&amp;fa=27&amp;uach=WyJXaW5kb3dzIiwiMTkuMC4wIiwieDg2IiwiIiwiMTM3LjAuNzE1MS4xMjIiLG51bGwsMCxudWxsLCI2NCIsW1siR29vZ2xlIENocm9tZSIsIjEzNy4wLjcxNTEuMTIyIl0sWyJDaHJvbWl1bSIsIjEzNy4wLjcxNTEuMTIyIl0sWyJOb3QvQSlCcmFuZCIsIjI0LjAuMC4wIl1dLDBd&amp;dt=1751963412794&amp;bpp=1&amp;bdt=791&amp;idt=1&amp;shv=r20250702&amp;mjsv=m202507020101&amp;ptt=9&amp;saldr=aa&amp;abxe=1&amp;cookie=ID%3D05f6e82287d810b4%3AT%3D1751962604%3ART%3D1751963214%3AS%3DALNI_MaQYA0TSAU2k8xwY5tqlN0xFCcd6g&amp;gpic=UID%3D00001157d9e27d0a%3AT%3D1751962604%3ART%3D1751963214%3AS%3DALNI_MYgtHzQJAQQXY_151HTGSSfVxE8_A&amp;eo_id_str=ID%3D52c21936d98c6d2b%3AT%3D1751962604%3ART%3D1751963214%3AS%3DAA-AfjZsJ15yjdEPJ8d11hPojsJQ&amp;prev_fmts=0x0%2C336x280%2C160x600%2C160x600%2C1027x280%2C1027x280%2C1027x280&amp;nras=5&amp;correlator=766581528464&amp;frm=20&amp;pv=1&amp;u_tz=480&amp;u_his=2&amp;u_h=600&amp;u_w=800&amp;u_ah=600&amp;u_aw=800&amp;u_cd=24&amp;u_sd=1&amp;dmc=8&amp;adx=27&amp;ady=3273&amp;biw=1080&amp;bih=1024&amp;scr_x=0&amp;scr_y=0&amp;eid=31093235%2C95353386%2C95362655%2C95365226%2C95365234%2C42533293%2C95359265%2C95365122%2C95365798&amp;oid=2&amp;pvsid=4647814794486465&amp;tmod=1708485235&amp;uas=0&amp;nvt=1&amp;fc=1408&amp;brdim=10%2C10%2C10%2C10%2C800%2C0%2C780%2C580%2C1080%2C1024&amp;vis=1&amp;rsz=%7C%7Cs%7C&amp;abl=NS&amp;fu=128&amp;bc=31&amp;bz=0.72&amp;td=1&amp;tdf=2&amp;psd=W251bGwsbnVsbCxudWxsLDNd&amp;nt=1&amp;ifi=9&amp;uci=a!9&amp;btvi=4&amp;fsb=1&amp;dtd=21"
        data-google-container-id="a!9"
        tabindex="0"
        title="Advertisement"
        aria-label="Advertisement"
        data-load-complete="true"
        data-google-query-id="CPro1qbsrI4DFX5kDwIdNT4AvA"
      ></iframe></div
  ></ins>
</div>
<p>
  std::unique_ptr has an overloaded operator* and operator-&gt; that can be used
  to return the resource being managed. Operator* returns a reference to the
  managed resource, and operator-&gt; returns a pointer.
</p>
<div class="code-block code-block-3" style="margin: 8px 0; clear: both"></div>

<p>
  Remember that std::unique_ptr may not always be managing an object -- either
  because it was created empty (using the default constructor or passing in a
  nullptr as the parameter), or because the resource it was managing got moved
  to another std::unique_ptr. So before we use either of these operators, we
  should check whether the std::unique_ptr actually has a resource. Fortunately,
  this is easy: std::unique_ptr has a cast to bool that returns true if the
  std::unique_ptr is managing a resource.
</p>
<p>Here’s an example of this:</p>
<div class="code-toolbar">
  <pre
    class="line-numbers language-cpp"
    tabindex="0"
  ><code class="match-braces language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;memory&gt;</span> <span class="token comment">// for std::unique_ptr</span></span>

<span class="token keyword keyword-class">class</span> <span class="token class-name">Resource</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-37-close">{</span>
<span class="token keyword keyword-public">public</span><span class="token operator">:</span>
	<span class="token function">Resource</span><span class="token punctuation brace-round brace-open brace-level-2" id="pair-30-close">(</span><span class="token punctuation brace-round brace-close brace-level-2" id="pair-30-open">)</span> <span class="token punctuation brace-curly brace-open brace-level-2" id="pair-35-close">{</span> std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Resource acquired\n"</span><span class="token punctuation">;</span> <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-35-open">}</span>
	<span class="token operator">~</span><span class="token function">Resource</span><span class="token punctuation brace-round brace-open brace-level-2" id="pair-31-close">(</span><span class="token punctuation brace-round brace-close brace-level-2" id="pair-31-open">)</span> <span class="token punctuation brace-curly brace-open brace-level-2" id="pair-36-close">{</span> std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Resource destroyed\n"</span><span class="token punctuation">;</span> <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-36-open">}</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-37-open">}</span><span class="token punctuation">;</span>

std<span class="token double-colon punctuation">::</span>ostream<span class="token operator">&amp;</span> <span class="token keyword keyword-operator">operator</span><span class="token operator">&lt;&lt;</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-32-close">(</span>std<span class="token double-colon punctuation">::</span>ostream<span class="token operator">&amp;</span> out<span class="token punctuation">,</span> <span class="token keyword keyword-const">const</span> Resource<span class="token operator">&amp;</span><span class="token punctuation brace-round brace-close brace-level-1" id="pair-32-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-38-close">{</span>
	out <span class="token operator">&lt;&lt;</span> <span class="token string">"I am a resource"</span><span class="token punctuation">;</span>
	<span class="token keyword keyword-return">return</span> out<span class="token punctuation">;</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-38-open">}</span>

<span class="token keyword keyword-int">int</span> <span class="token function">main</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-33-close">(</span><span class="token punctuation brace-round brace-close brace-level-1" id="pair-33-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-41-close">{</span>
	std<span class="token double-colon punctuation">::</span>unique_ptr<span class="token operator">&lt;</span>Resource<span class="token operator">&gt;</span> res<span class="token punctuation brace-curly brace-open brace-level-2" id="pair-40-close">{</span> <span class="token keyword keyword-new">new</span> Resource<span class="token punctuation brace-curly brace-open brace-level-3" id="pair-39-close">{</span><span class="token punctuation brace-curly brace-close brace-level-3" id="pair-39-open">}</span> <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-40-open">}</span><span class="token punctuation">;</span>

	<span class="token keyword keyword-if">if</span> <span class="token punctuation brace-round brace-open brace-level-2" id="pair-34-close">(</span>res<span class="token punctuation brace-round brace-close brace-level-2" id="pair-34-open">)</span> <span class="token comment">// use implicit cast to bool to ensure res contains a Resource</span>
		std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span>res <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span><span class="token punctuation">;</span> <span class="token comment">// print the Resource that res is owning</span>

	<span class="token keyword keyword-return">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-41-open">}</span><span aria-hidden="true" class="line-numbers-rows"><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre>
  <div class="toolbar">
    <div class="toolbar-item">
      <button
        class="copy-to-clipboard-button"
        type="button"
        data-copy-state="copy"
      >
        <span>Copy</span>
      </button>
    </div>
  </div>
</div>
<div
  class="google-auto-placed ap_container"
  style="width: 100%; height: auto; clear: both; text-align: center"
>
  <ins
    data-ad-format="auto"
    class="adsbygoogle adsbygoogle-noablate"
    data-ad-client="ca-pub-0588844875925051"
    data-adsbygoogle-status="done"
    style="
      display: block;
      margin: auto;
      background-color: transparent;
      height: 0px;
    "
    data-ad-status="unfilled"
    ><div
      id="aswift_9_host"
      style="
        border: none;
        height: 0px;
        width: 1027px;
        margin: 0px;
        padding: 0px;
        position: relative;
        visibility: visible;
        background-color: transparent;
        display: inline-block;
        overflow: hidden;
        opacity: 0;
      "
    >
      <iframe
        id="aswift_9"
        name="aswift_9"
        browsingtopics="true"
        style="
          left: 0px;
          position: absolute;
          top: 0px;
          border: 0px;
          width: 1027px;
          height: 0px;
          min-height: auto;
          max-height: none;
          min-width: auto;
          max-width: none;
        "
        sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation"
        width="1027"
        height="0"
        frameborder="0"
        marginwidth="0"
        marginheight="0"
        vspace="0"
        hspace="0"
        allowtransparency="true"
        scrolling="no"
        allow="attribution-reporting; run-ad-auction"
        src="https://googleads.g.doubleclick.net/pagead/ads?client=ca-pub-0588844875925051&amp;output=html&amp;h=280&amp;adk=74038387&amp;adf=2149844514&amp;w=1027&amp;abgtt=11&amp;fwrn=4&amp;fwrnh=100&amp;lmt=1750391393&amp;num_ads=1&amp;rafmt=1&amp;armr=3&amp;sem=mc&amp;pwprc=4633386603&amp;ad_type=text_image&amp;format=1027x280&amp;url=https%3A%2F%2Fwww.learncpp.com%2Fcpp-tutorial%2Fstdunique_ptr%2F&amp;fwr=0&amp;pra=3&amp;rh=200&amp;rw=1026&amp;rpe=1&amp;resp_fmts=3&amp;wgl=1&amp;fa=27&amp;uach=WyJXaW5kb3dzIiwiMTkuMC4wIiwieDg2IiwiIiwiMTM3LjAuNzE1MS4xMjIiLG51bGwsMCxudWxsLCI2NCIsW1siR29vZ2xlIENocm9tZSIsIjEzNy4wLjcxNTEuMTIyIl0sWyJDaHJvbWl1bSIsIjEzNy4wLjcxNTEuMTIyIl0sWyJOb3QvQSlCcmFuZCIsIjI0LjAuMC4wIl1dLDBd&amp;dt=1751963412796&amp;bpp=1&amp;bdt=793&amp;idt=1&amp;shv=r20250702&amp;mjsv=m202507020101&amp;ptt=9&amp;saldr=aa&amp;abxe=1&amp;cookie=ID%3D05f6e82287d810b4%3AT%3D1751962604%3ART%3D1751963214%3AS%3DALNI_MaQYA0TSAU2k8xwY5tqlN0xFCcd6g&amp;gpic=UID%3D00001157d9e27d0a%3AT%3D1751962604%3ART%3D1751963214%3AS%3DALNI_MYgtHzQJAQQXY_151HTGSSfVxE8_A&amp;eo_id_str=ID%3D52c21936d98c6d2b%3AT%3D1751962604%3ART%3D1751963214%3AS%3DAA-AfjZsJ15yjdEPJ8d11hPojsJQ&amp;prev_fmts=0x0%2C336x280%2C160x600%2C160x600%2C1027x280%2C1027x280%2C1027x280%2C1027x280&amp;nras=6&amp;correlator=766581528464&amp;frm=20&amp;pv=1&amp;u_tz=480&amp;u_his=2&amp;u_h=600&amp;u_w=800&amp;u_ah=600&amp;u_aw=800&amp;u_cd=24&amp;u_sd=1&amp;dmc=8&amp;adx=27&amp;ady=3887&amp;biw=1080&amp;bih=1024&amp;scr_x=0&amp;scr_y=0&amp;eid=31093235%2C95353386%2C95362655%2C95365226%2C95365234%2C42533293%2C95359265%2C95365122%2C95365798&amp;oid=2&amp;pvsid=4647814794486465&amp;tmod=1708485235&amp;uas=0&amp;nvt=1&amp;fc=1408&amp;brdim=10%2C10%2C10%2C10%2C800%2C0%2C780%2C580%2C1080%2C1024&amp;vis=1&amp;rsz=%7C%7Cs%7C&amp;abl=NS&amp;fu=128&amp;bc=31&amp;bz=0.72&amp;td=1&amp;tdf=2&amp;psd=W251bGwsbnVsbCxudWxsLDNd&amp;nt=1&amp;ifi=10&amp;uci=a!a&amp;btvi=5&amp;fsb=1&amp;dtd=159"
        data-google-container-id="a!a"
        tabindex="0"
        title="Advertisement"
        aria-label="Advertisement"
        data-load-complete="true"
        data-google-query-id="CJrV1qbsrI4DFe1fDwIdMEwg3Q"
      ></iframe></div
  ></ins>
</div>
<p>This prints:</p>
<pre>
Resource acquired
I am a resource
Resource destroyed
</pre>
<p>
  In the above program, we use the overloaded operator* to get the Resource
  object owned by std::unique_ptr res, which we then send to std::cout for
  printing.
</p>
<p class="cpp-section cpp-topline" style="clear: both">
  std::unique_ptr and arrays
</p>
<p>
  Unlike std::auto_ptr, std::unique_ptr is smart enough to know whether to use
  scalar delete or array delete, so std::unique_ptr is okay to use with both
  scalar objects and arrays.
</p>
<p>
  However, std::array or std::vector (or std::string) are almost always better
  choices than using std::unique_ptr with a fixed array, dynamic array, or
  C-style string.
</p>
<div class="code-block code-block-4" style="margin: 8px 0; clear: both"></div>

<div class="cpp-note cpp-lightgreenbackground">
  <p class="cpp-note-title cpp-bottomline">Best practice</p>
  <p>
    Favor std::array, std::vector, or std::string over a smart pointer managing
    a fixed array, dynamic array, or C-style string.
  </p>
</div>
<p class="cpp-section cpp-topline" style="clear: both">std::make_unique</p>
<div
  class="google-auto-placed ap_container"
  style="width: 100%; height: auto; clear: both; text-align: center"
>
  <ins
    data-ad-format="auto"
    class="adsbygoogle adsbygoogle-noablate"
    data-ad-client="ca-pub-0588844875925051"
    data-adsbygoogle-status="done"
    style="
      display: block;
      margin: auto;
      background-color: transparent;
      height: 0px;
    "
    data-ad-status="unfilled"
    ><div
      id="aswift_10_host"
      style="
        border: none;
        height: 0px;
        width: 1027px;
        margin: 0px;
        padding: 0px;
        position: relative;
        visibility: visible;
        background-color: transparent;
        display: inline-block;
        overflow: hidden;
        opacity: 0;
      "
    >
      <iframe
        id="aswift_10"
        name="aswift_10"
        browsingtopics="true"
        style="
          left: 0px;
          position: absolute;
          top: 0px;
          border: 0px;
          width: 1027px;
          height: 0px;
          min-height: auto;
          max-height: none;
          min-width: auto;
          max-width: none;
        "
        sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation"
        width="1027"
        height="0"
        frameborder="0"
        marginwidth="0"
        marginheight="0"
        vspace="0"
        hspace="0"
        allowtransparency="true"
        scrolling="no"
        allow="attribution-reporting; run-ad-auction"
        src="https://googleads.g.doubleclick.net/pagead/ads?client=ca-pub-0588844875925051&amp;output=html&amp;h=280&amp;adk=74038387&amp;adf=2639662204&amp;w=1027&amp;abgtt=11&amp;fwrn=4&amp;fwrnh=100&amp;lmt=1750391393&amp;num_ads=1&amp;rafmt=1&amp;armr=3&amp;sem=mc&amp;pwprc=4633386603&amp;ad_type=text_image&amp;format=1027x280&amp;url=https%3A%2F%2Fwww.learncpp.com%2Fcpp-tutorial%2Fstdunique_ptr%2F&amp;fwr=0&amp;pra=3&amp;rh=200&amp;rw=1026&amp;rpe=1&amp;resp_fmts=3&amp;wgl=1&amp;fa=27&amp;uach=WyJXaW5kb3dzIiwiMTkuMC4wIiwieDg2IiwiIiwiMTM3LjAuNzE1MS4xMjIiLG51bGwsMCxudWxsLCI2NCIsW1siR29vZ2xlIENocm9tZSIsIjEzNy4wLjcxNTEuMTIyIl0sWyJDaHJvbWl1bSIsIjEzNy4wLjcxNTEuMTIyIl0sWyJOb3QvQSlCcmFuZCIsIjI0LjAuMC4wIl1dLDBd&amp;dt=1751963412798&amp;bpp=1&amp;bdt=795&amp;idt=1&amp;shv=r20250702&amp;mjsv=m202507020101&amp;ptt=9&amp;saldr=aa&amp;abxe=1&amp;cookie=ID%3D05f6e82287d810b4%3AT%3D1751962604%3ART%3D1751963214%3AS%3DALNI_MaQYA0TSAU2k8xwY5tqlN0xFCcd6g&amp;gpic=UID%3D00001157d9e27d0a%3AT%3D1751962604%3ART%3D1751963214%3AS%3DALNI_MYgtHzQJAQQXY_151HTGSSfVxE8_A&amp;eo_id_str=ID%3D52c21936d98c6d2b%3AT%3D1751962604%3ART%3D1751963214%3AS%3DAA-AfjZsJ15yjdEPJ8d11hPojsJQ&amp;prev_fmts=0x0%2C336x280%2C160x600%2C160x600%2C1027x280%2C1027x280%2C1027x280%2C1027x280%2C1027x280&amp;nras=7&amp;correlator=766581528464&amp;frm=20&amp;pv=1&amp;u_tz=480&amp;u_his=2&amp;u_h=600&amp;u_w=800&amp;u_ah=600&amp;u_aw=800&amp;u_cd=24&amp;u_sd=1&amp;dmc=8&amp;adx=27&amp;ady=4067&amp;biw=1080&amp;bih=1024&amp;scr_x=0&amp;scr_y=0&amp;eid=31093235%2C95353386%2C95362655%2C95365226%2C95365234%2C42533293%2C95359265%2C95365122%2C95365798&amp;oid=2&amp;pvsid=4647814794486465&amp;tmod=1708485235&amp;uas=0&amp;nvt=1&amp;fc=1408&amp;brdim=10%2C10%2C10%2C10%2C800%2C0%2C780%2C580%2C1080%2C1024&amp;vis=1&amp;rsz=%7C%7Cs%7C&amp;abl=NS&amp;fu=128&amp;bc=31&amp;bz=0.72&amp;td=1&amp;tdf=2&amp;psd=W251bGwsbnVsbCxudWxsLDNd&amp;nt=1&amp;ifi=11&amp;uci=a!b&amp;btvi=6&amp;fsb=1&amp;dtd=331"
        data-google-container-id="a!b"
        tabindex="0"
        title="Advertisement"
        aria-label="Advertisement"
        data-load-complete="true"
        data-google-query-id="CI3u36bsrI4DFb1dDwIdhFEpyw"
      ></iframe></div
  ></ins>
</div>
<p>
  C++14 comes with an additional function named std::make_unique(). This
  templated function constructs an object of the template type and initializes
  it with the arguments passed into the function.
</p>
<div class="code-toolbar">
  <pre
    class="line-numbers language-cpp"
    tabindex="0"
  ><code class="match-braces language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;memory&gt;</span> <span class="token comment">// for std::unique_ptr and std::make_unique</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>

<span class="token keyword keyword-class">class</span> <span class="token class-name">Fraction</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-55-close">{</span>
<span class="token keyword keyword-private">private</span><span class="token operator">:</span>
	<span class="token keyword keyword-int">int</span> m_numerator<span class="token punctuation brace-curly brace-open brace-level-2" id="pair-49-close">{</span> <span class="token number">0</span> <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-49-open">}</span><span class="token punctuation">;</span>
	<span class="token keyword keyword-int">int</span> m_denominator<span class="token punctuation brace-curly brace-open brace-level-2" id="pair-50-close">{</span> <span class="token number">1</span> <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-50-open">}</span><span class="token punctuation">;</span>

<span class="token keyword keyword-public">public</span><span class="token operator">:</span>
	<span class="token function">Fraction</span><span class="token punctuation brace-round brace-open brace-level-2" id="pair-42-close">(</span><span class="token keyword keyword-int">int</span> numerator <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword keyword-int">int</span> denominator <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation brace-round brace-close brace-level-2" id="pair-42-open">)</span> <span class="token operator">:</span>
		m_numerator<span class="token punctuation brace-curly brace-open brace-level-2" id="pair-51-close">{</span> numerator <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-51-open">}</span><span class="token punctuation">,</span> m_denominator<span class="token punctuation brace-curly brace-open brace-level-2" id="pair-52-close">{</span> denominator <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-52-open">}</span>
	<span class="token punctuation brace-curly brace-open brace-level-2" id="pair-53-close">{</span>
	<span class="token punctuation brace-curly brace-close brace-level-2" id="pair-53-open">}</span>

	<span class="token keyword keyword-friend">friend</span> std<span class="token double-colon punctuation">::</span>ostream<span class="token operator">&amp;</span> <span class="token keyword keyword-operator">operator</span><span class="token operator">&lt;&lt;</span><span class="token punctuation brace-round brace-open brace-level-2" id="pair-43-close">(</span>std<span class="token double-colon punctuation">::</span>ostream<span class="token operator">&amp;</span> out<span class="token punctuation">,</span> <span class="token keyword keyword-const">const</span> Fraction <span class="token operator">&amp;</span>f1<span class="token punctuation brace-round brace-close brace-level-2" id="pair-43-open">)</span>
	<span class="token punctuation brace-curly brace-open brace-level-2" id="pair-54-close">{</span>
		out <span class="token operator">&lt;&lt;</span> f1<span class="token punctuation">.</span>m_numerator <span class="token operator">&lt;&lt;</span> <span class="token string">'/'</span> <span class="token operator">&lt;&lt;</span> f1<span class="token punctuation">.</span>m_denominator<span class="token punctuation">;</span>
		<span class="token keyword keyword-return">return</span> out<span class="token punctuation">;</span>
	<span class="token punctuation brace-curly brace-close brace-level-2" id="pair-54-open">}</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-55-open">}</span><span class="token punctuation">;</span>


<span class="token keyword keyword-int">int</span> <span class="token function">main</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-44-close">(</span><span class="token punctuation brace-round brace-close brace-level-1" id="pair-44-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-58-close">{</span>
	<span class="token comment">// Create a single dynamically allocated Fraction with numerator 3 and denominator 5</span>
	<span class="token comment">// We can also use automatic type deduction to good effect here</span>
	<span class="token keyword keyword-auto">auto</span> f1<span class="token punctuation brace-curly brace-open brace-level-2" id="pair-56-close">{</span> std<span class="token double-colon punctuation">::</span><span class="token generic-function"><span class="token function">make_unique</span><span class="token generic class-name"><span class="token operator">&lt;</span>Fraction<span class="token operator">&gt;</span></span></span><span class="token punctuation brace-round brace-open brace-level-3" id="pair-45-close">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation brace-round brace-close brace-level-3" id="pair-45-open">)</span> <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-56-open">}</span><span class="token punctuation">;</span>
	std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span>f1 <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span><span class="token punctuation">;</span>

	<span class="token comment">// Create a dynamically allocated array of Fractions of length 4</span>
	<span class="token keyword keyword-auto">auto</span> f2<span class="token punctuation brace-curly brace-open brace-level-2" id="pair-57-close">{</span> std<span class="token double-colon punctuation">::</span><span class="token generic-function"><span class="token function">make_unique</span><span class="token generic class-name"><span class="token operator">&lt;</span>Fraction<span class="token punctuation brace-square brace-open brace-level-3" id="pair-47-close">[</span><span class="token punctuation brace-square brace-close brace-level-3" id="pair-47-open">]</span><span class="token operator">&gt;</span></span></span><span class="token punctuation brace-round brace-open brace-level-3" id="pair-46-close">(</span><span class="token number">4</span><span class="token punctuation brace-round brace-close brace-level-3" id="pair-46-open">)</span> <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-57-open">}</span><span class="token punctuation">;</span>
	std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> f2<span class="token punctuation brace-square brace-open brace-level-2" id="pair-48-close">[</span><span class="token number">0</span><span class="token punctuation brace-square brace-close brace-level-2" id="pair-48-open">]</span> <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span><span class="token punctuation">;</span>

	<span class="token keyword keyword-return">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-58-open">}</span><span aria-hidden="true" class="line-numbers-rows"><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre>
  <div class="toolbar">
    <div class="toolbar-item">
      <button
        class="copy-to-clipboard-button"
        type="button"
        data-copy-state="copy"
      >
        <span>Copy</span>
      </button>
    </div>
  </div>
</div>
<div
  class="google-auto-placed ap_container"
  style="width: 100%; height: auto; clear: both; text-align: center"
>
  <ins
    data-ad-format="auto"
    class="adsbygoogle adsbygoogle-noablate"
    data-ad-client="ca-pub-0588844875925051"
    data-adsbygoogle-status="done"
    style="
      display: block;
      margin: auto;
      background-color: transparent;
      height: 280px;
    "
    ><div
      id="aswift_11_host"
      style="
        border: none;
        height: 280px;
        width: 1027px;
        margin: 0px;
        padding: 0px;
        position: relative;
        visibility: visible;
        background-color: transparent;
        display: inline-block;
      "
    ></div
  ></ins>
</div>
<p>The code above prints:</p>
<pre>
3/5
0/1
</pre>
<p>
  Use of std::make_unique() is optional, but is recommended over creating
  std::unique_ptr yourself. This is because code using std::make_unique is
  simpler, and it also requires less typing (when used with automatic type
  deduction). Furthermore, in C++14 it resolves an exception safety issue that
  can result from C++ leaving the order of evaluation for function arguments
  unspecified.
</p>
<div class="cpp-note cpp-lightgreenbackground">
  <p class="cpp-note-title cpp-bottomline">Best practice</p>
  <p>
    Use std::make_unique() instead of creating std::unique_ptr and using new
    yourself.
  </p>
</div>
<p class="cpp-section cpp-topline" style="clear: both">
  <a name="smartpointerexceptionsafety"></a>The exception safety issue in more
  detail
  <a href="#smartpointerexceptionsafety"
    ><i class="fa fa-link" style="font-size: 0.8em"></i
  ></a>
</p>
<div
  class="google-auto-placed ap_container"
  style="width: 100%; height: auto; clear: both; text-align: center"
>
  <ins
    data-ad-format="auto"
    class="adsbygoogle adsbygoogle-noablate"
    data-ad-client="ca-pub-0588844875925051"
    data-adsbygoogle-status="done"
    style="
      display: block;
      margin: auto;
      background-color: transparent;
      height: 280px;
    "
    ><div
      id="aswift_12_host"
      style="
        border: none;
        height: 280px;
        width: 1027px;
        margin: 0px;
        padding: 0px;
        position: relative;
        visibility: visible;
        background-color: transparent;
        display: inline-block;
      "
    ></div
  ></ins>
</div>
<p>
  For those wondering what the “exception safety issue” mentioned above is,
  here’s a description of the issue.
</p>
<p>Consider an expression like this one:</p>
<div class="code-block code-block-5" style="margin: 8px 0; clear: both"></div>

<div class="code-toolbar">
  <pre
    class="line-numbers language-cpp"
    tabindex="0"
  ><code class="match-braces language-cpp"><span class="token function">some_function</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-61-close">(</span>std<span class="token double-colon punctuation">::</span><span class="token generic-function"><span class="token function">unique_ptr</span><span class="token generic class-name"><span class="token operator">&lt;</span>T<span class="token operator">&gt;</span></span></span><span class="token punctuation brace-round brace-open brace-level-2" id="pair-59-close">(</span><span class="token keyword keyword-new">new</span> T<span class="token punctuation brace-round brace-close brace-level-2" id="pair-59-open">)</span><span class="token punctuation">,</span> <span class="token function">function_that_can_throw_exception</span><span class="token punctuation brace-round brace-open brace-level-2" id="pair-60-close">(</span><span class="token punctuation brace-round brace-close brace-level-2" id="pair-60-open">)</span><span class="token punctuation brace-round brace-close brace-level-1" id="pair-61-open">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span style="height: 16px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre>
  <div class="toolbar">
    <div class="toolbar-item">
      <button
        class="copy-to-clipboard-button"
        type="button"
        data-copy-state="copy"
      >
        <span>Copy</span>
      </button>
    </div>
  </div>
</div>
<p>
  The compiler is given a lot of flexibility in terms of how it handles this
  call. It could create a new T, then call function_that_can_throw_exception(),
  then create the std::unique_ptr that manages the dynamically allocated T. If
  function_that_can_throw_exception() throws an exception, then the T that was
  allocated will not be deallocated, because the smart pointer to do the
  deallocation hasn’t been created yet. This leads to T being leaked.
</p>
<p>
  std::make_unique() doesn’t suffer from this problem because the creation of
  the object T and the creation of the std::unique_ptr happen inside the
  std::make_unique() function, where there’s no ambiguity about order of
  execution.
</p>
<p>
  This issue was fixed in C++17, as evaluation of function arguments can no
  longer be interleaved.
</p>
<div
  class="google-auto-placed ap_container"
  style="width: 100%; height: auto; clear: both; text-align: center"
>
  <ins
    data-ad-format="auto"
    class="adsbygoogle adsbygoogle-noablate"
    data-ad-client="ca-pub-0588844875925051"
    data-adsbygoogle-status="done"
    style="
      display: block;
      margin: auto;
      background-color: transparent;
      height: 280px;
    "
    ><div
      id="aswift_13_host"
      style="
        border: none;
        height: 280px;
        width: 1027px;
        margin: 0px;
        padding: 0px;
        position: relative;
        visibility: visible;
        background-color: transparent;
        display: inline-block;
      "
    ></div
  ></ins>
</div>
<p class="cpp-section cpp-topline" style="clear: both">
  Returning std::unique_ptr from a function
</p>
<p>std::unique_ptr can be safely returned from a function by value:</p>
<div class="code-block code-block-6" style="margin: 8px 0; clear: both"></div>

<div class="code-toolbar">
  <pre
    class="line-numbers language-cpp"
    tabindex="0"
  ><code class="match-braces language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;memory&gt;</span> <span class="token comment">// for std::unique_ptr</span></span>

std<span class="token double-colon punctuation">::</span>unique_ptr<span class="token operator">&lt;</span>Resource<span class="token operator">&gt;</span> <span class="token function">createResource</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-62-close">(</span><span class="token punctuation brace-round brace-close brace-level-1" id="pair-62-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-66-close">{</span>
     <span class="token keyword keyword-return">return</span> std<span class="token double-colon punctuation">::</span><span class="token generic-function"><span class="token function">make_unique</span><span class="token generic class-name"><span class="token operator">&lt;</span>Resource<span class="token operator">&gt;</span></span></span><span class="token punctuation brace-round brace-open brace-level-2" id="pair-63-close">(</span><span class="token punctuation brace-round brace-close brace-level-2" id="pair-63-open">)</span><span class="token punctuation">;</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-66-open">}</span>

<span class="token keyword keyword-int">int</span> <span class="token function">main</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-64-close">(</span><span class="token punctuation brace-round brace-close brace-level-1" id="pair-64-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-68-close">{</span>
    <span class="token keyword keyword-auto">auto</span> ptr<span class="token punctuation brace-curly brace-open brace-level-2" id="pair-67-close">{</span> <span class="token function">createResource</span><span class="token punctuation brace-round brace-open brace-level-3" id="pair-65-close">(</span><span class="token punctuation brace-round brace-close brace-level-3" id="pair-65-open">)</span> <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-67-open">}</span><span class="token punctuation">;</span>

    <span class="token comment">// do whatever</span>

    <span class="token keyword keyword-return">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-68-open">}</span><span aria-hidden="true" class="line-numbers-rows"><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre>
  <div class="toolbar">
    <div class="toolbar-item">
      <button
        class="copy-to-clipboard-button"
        type="button"
        data-copy-state="copy"
      >
        <span>Copy</span>
      </button>
    </div>
  </div>
</div>
<p>
  In the above code, createResource() returns a std::unique_ptr by value. If
  this value is not assigned to anything, the temporary return value will go out
  of scope and the Resource will be cleaned up. If it is assigned (as shown in
  main()), in C++14 or earlier, move semantics will be employed to transfer the
  Resource from the return value to the object assigned to (in the above
  example, ptr), and in C++17 or newer, the return will be elided. This makes
  returning a resource by std::unique_ptr much safer than returning raw
  pointers!
</p>
<p>
  In general, you should not return std::unique_ptr by pointer (ever) or
  reference (unless you have a specific compelling reason to).
</p>
<p class="cpp-section cpp-topline" style="clear: both">
  Passing std::unique_ptr to a function
</p>
<p>
  If you want the function to take ownership of the contents of the pointer,
  pass the std::unique_ptr by value. Note that because copy semantics have been
  disabled, you’ll need to use std::move to actually pass the variable in.
</p>
<div class="code-toolbar">
  <pre
    class="line-numbers language-cpp"
    tabindex="0"
  ><code class="match-braces language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;memory&gt;</span> <span class="token comment">// for std::unique_ptr</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;utility&gt;</span> <span class="token comment">// for std::move</span></span>

<span class="token keyword keyword-class">class</span> <span class="token class-name">Resource</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-80-close">{</span>
<span class="token keyword keyword-public">public</span><span class="token operator">:</span>
	<span class="token function">Resource</span><span class="token punctuation brace-round brace-open brace-level-2" id="pair-69-close">(</span><span class="token punctuation brace-round brace-close brace-level-2" id="pair-69-open">)</span> <span class="token punctuation brace-curly brace-open brace-level-2" id="pair-78-close">{</span> std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Resource acquired\n"</span><span class="token punctuation">;</span> <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-78-open">}</span>
	<span class="token operator">~</span><span class="token function">Resource</span><span class="token punctuation brace-round brace-open brace-level-2" id="pair-70-close">(</span><span class="token punctuation brace-round brace-close brace-level-2" id="pair-70-open">)</span> <span class="token punctuation brace-curly brace-open brace-level-2" id="pair-79-close">{</span> std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Resource destroyed\n"</span><span class="token punctuation">;</span> <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-79-open">}</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-80-open">}</span><span class="token punctuation">;</span>

std<span class="token double-colon punctuation">::</span>ostream<span class="token operator">&amp;</span> <span class="token keyword keyword-operator">operator</span><span class="token operator">&lt;&lt;</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-71-close">(</span>std<span class="token double-colon punctuation">::</span>ostream<span class="token operator">&amp;</span> out<span class="token punctuation">,</span> <span class="token keyword keyword-const">const</span> Resource<span class="token operator">&amp;</span><span class="token punctuation brace-round brace-close brace-level-1" id="pair-71-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-81-close">{</span>
	out <span class="token operator">&lt;&lt;</span> <span class="token string">"I am a resource"</span><span class="token punctuation">;</span>
	<span class="token keyword keyword-return">return</span> out<span class="token punctuation">;</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-81-open">}</span>

<span class="token comment">// This function takes ownership of the Resource, which isn't what we want</span>
<span class="token keyword keyword-void">void</span> <span class="token function">takeOwnership</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-72-close">(</span>std<span class="token double-colon punctuation">::</span>unique_ptr<span class="token operator">&lt;</span>Resource<span class="token operator">&gt;</span> res<span class="token punctuation brace-round brace-close brace-level-1" id="pair-72-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-82-close">{</span>
     <span class="token keyword keyword-if">if</span> <span class="token punctuation brace-round brace-open brace-level-2" id="pair-73-close">(</span>res<span class="token punctuation brace-round brace-close brace-level-2" id="pair-73-open">)</span>
          std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span>res <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span><span class="token punctuation">;</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-82-open">}</span> <span class="token comment">// the Resource is destroyed here</span>

<span class="token keyword keyword-int">int</span> <span class="token function">main</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-74-close">(</span><span class="token punctuation brace-round brace-close brace-level-1" id="pair-74-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-84-close">{</span>
    <span class="token keyword keyword-auto">auto</span> ptr<span class="token punctuation brace-curly brace-open brace-level-2" id="pair-83-close">{</span> std<span class="token double-colon punctuation">::</span><span class="token generic-function"><span class="token function">make_unique</span><span class="token generic class-name"><span class="token operator">&lt;</span>Resource<span class="token operator">&gt;</span></span></span><span class="token punctuation brace-round brace-open brace-level-3" id="pair-75-close">(</span><span class="token punctuation brace-round brace-close brace-level-3" id="pair-75-open">)</span> <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-83-open">}</span><span class="token punctuation">;</span>

<span class="token comment">//    takeOwnership(ptr); // This doesn't work, need to use move semantics</span>
    <span class="token function">takeOwnership</span><span class="token punctuation brace-round brace-open brace-level-2" id="pair-77-close">(</span>std<span class="token double-colon punctuation">::</span><span class="token function">move</span><span class="token punctuation brace-round brace-open brace-level-3" id="pair-76-close">(</span>ptr<span class="token punctuation brace-round brace-close brace-level-3" id="pair-76-open">)</span><span class="token punctuation brace-round brace-close brace-level-2" id="pair-77-open">)</span><span class="token punctuation">;</span> <span class="token comment">// ok: use move semantics</span>

    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Ending program\n"</span><span class="token punctuation">;</span>

    <span class="token keyword keyword-return">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-84-open">}</span><span aria-hidden="true" class="line-numbers-rows"><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre>
  <div class="toolbar">
    <div class="toolbar-item">
      <button
        class="copy-to-clipboard-button"
        type="button"
        data-copy-state="copy"
      >
        <span>Copy</span>
      </button>
    </div>
  </div>
</div>
<p>The above program prints:</p>
<pre>
Resource acquired
I am a resource
Resource destroyed
Ending program
</pre>
<p>
  Note that in this case, ownership of the Resource was transferred to
  takeOwnership(), so the Resource was destroyed at the end of takeOwnership()
  rather than the end of main().
</p>
<div class="code-block code-block-7" style="margin: 8px 0; clear: both"></div>

<p>
  However, most of the time, you won’t want the function to take ownership of
  the resource.
</p>
<p>
  Although you can pass a std::unique_ptr by const reference (which will allow
  the function to use the object without assuming ownership), it’s better to
  just pass the resource itself (by pointer or reference, depending on whether
  null is a valid argument). This allows the function to remain agnostic of how
  the caller is managing its resources.
</p>
<p>
  To get a raw pointer from a std::unique_ptr, you can use the get() member
  function:
</p>
<div class="code-toolbar">
  <pre
    class="line-numbers language-cpp"
    tabindex="0"
  ><code class="match-braces language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;memory&gt;</span> <span class="token comment">// for std::unique_ptr</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>

<span class="token keyword keyword-class">class</span> <span class="token class-name">Resource</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-96-close">{</span>
<span class="token keyword keyword-public">public</span><span class="token operator">:</span>
	<span class="token function">Resource</span><span class="token punctuation brace-round brace-open brace-level-2" id="pair-85-close">(</span><span class="token punctuation brace-round brace-close brace-level-2" id="pair-85-open">)</span> <span class="token punctuation brace-curly brace-open brace-level-2" id="pair-94-close">{</span> std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Resource acquired\n"</span><span class="token punctuation">;</span> <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-94-open">}</span>
	<span class="token operator">~</span><span class="token function">Resource</span><span class="token punctuation brace-round brace-open brace-level-2" id="pair-86-close">(</span><span class="token punctuation brace-round brace-close brace-level-2" id="pair-86-open">)</span> <span class="token punctuation brace-curly brace-open brace-level-2" id="pair-95-close">{</span> std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Resource destroyed\n"</span><span class="token punctuation">;</span> <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-95-open">}</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-96-open">}</span><span class="token punctuation">;</span>

std<span class="token double-colon punctuation">::</span>ostream<span class="token operator">&amp;</span> <span class="token keyword keyword-operator">operator</span><span class="token operator">&lt;&lt;</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-87-close">(</span>std<span class="token double-colon punctuation">::</span>ostream<span class="token operator">&amp;</span> out<span class="token punctuation">,</span> <span class="token keyword keyword-const">const</span> Resource<span class="token operator">&amp;</span><span class="token punctuation brace-round brace-close brace-level-1" id="pair-87-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-97-close">{</span>
	out <span class="token operator">&lt;&lt;</span> <span class="token string">"I am a resource"</span><span class="token punctuation">;</span>
	<span class="token keyword keyword-return">return</span> out<span class="token punctuation">;</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-97-open">}</span>

<span class="token comment">// The function only uses the resource, so we'll accept a pointer to the resource, not a reference to the whole std::unique_ptr&lt;Resource&gt;</span>
<span class="token keyword keyword-void">void</span> <span class="token function">useResource</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-88-close">(</span><span class="token keyword keyword-const">const</span> Resource<span class="token operator">*</span> res<span class="token punctuation brace-round brace-close brace-level-1" id="pair-88-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-98-close">{</span>
	<span class="token keyword keyword-if">if</span> <span class="token punctuation brace-round brace-open brace-level-2" id="pair-89-close">(</span>res<span class="token punctuation brace-round brace-close brace-level-2" id="pair-89-open">)</span>
		std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span>res <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span><span class="token punctuation">;</span>
	<span class="token keyword keyword-else">else</span>
		std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"No resource\n"</span><span class="token punctuation">;</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-98-open">}</span>

<span class="token keyword keyword-int">int</span> <span class="token function">main</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-90-close">(</span><span class="token punctuation brace-round brace-close brace-level-1" id="pair-90-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-100-close">{</span>
	<span class="token keyword keyword-auto">auto</span> ptr<span class="token punctuation brace-curly brace-open brace-level-2" id="pair-99-close">{</span> std<span class="token double-colon punctuation">::</span><span class="token generic-function"><span class="token function">make_unique</span><span class="token generic class-name"><span class="token operator">&lt;</span>Resource<span class="token operator">&gt;</span></span></span><span class="token punctuation brace-round brace-open brace-level-3" id="pair-91-close">(</span><span class="token punctuation brace-round brace-close brace-level-3" id="pair-91-open">)</span> <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-99-open">}</span><span class="token punctuation">;</span>

	<span class="token function">useResource</span><span class="token punctuation brace-round brace-open brace-level-2" id="pair-93-close">(</span>ptr<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation brace-round brace-open brace-level-3" id="pair-92-close">(</span><span class="token punctuation brace-round brace-close brace-level-3" id="pair-92-open">)</span><span class="token punctuation brace-round brace-close brace-level-2" id="pair-93-open">)</span><span class="token punctuation">;</span> <span class="token comment">// note: get() used here to get a pointer to the Resource</span>

	std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Ending program\n"</span><span class="token punctuation">;</span>

	<span class="token keyword keyword-return">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-100-open">}</span> <span class="token comment">// The Resource is destroyed here</span><span aria-hidden="true" class="line-numbers-rows"><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 32px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre>
  <div class="toolbar">
    <div class="toolbar-item">
      <button
        class="copy-to-clipboard-button"
        type="button"
        data-copy-state="copy"
      >
        <span>Copy</span>
      </button>
    </div>
  </div>
</div>
<p>The above program prints:</p>
<pre>
Resource acquired
I am a resource
Ending program
Resource destroyed
</pre>
<p class="cpp-section cpp-topline" style="clear: both">
  std::unique_ptr and classes
</p>
<p>
  You can, of course, use std::unique_ptr as a composition member of your class.
  This way, you don’t have to worry about ensuring your class destructor deletes
  the dynamic memory, as the std::unique_ptr will be automatically destroyed
  when the class object is destroyed.
</p>
<p>
  However, if the class object is not destroyed properly (e.g. it is dynamically
  allocated and not deallocated properly), then the std::unique_ptr member will
  not be destroyed either, and the object being managed by the std::unique_ptr
  will not be deallocated.
</p>
<div class="code-block code-block-8" style="margin: 8px 0; clear: both"></div>

<p class="cpp-section cpp-topline" style="clear: both">
  Misusing std::unique_ptr
</p>
<p>
  There are two easy ways to misuse std::unique_ptrs, both of which are easily
  avoided. First, don’t let multiple objects manage the same resource. For
  example:
</p>
<div class="code-toolbar">
  <pre
    class="line-numbers language-cpp"
    tabindex="0"
  ><code class="match-braces language-cpp">Resource<span class="token operator">*</span> res<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-102-close">{</span> <span class="token keyword keyword-new">new</span> <span class="token function">Resource</span><span class="token punctuation brace-round brace-open brace-level-2" id="pair-101-close">(</span><span class="token punctuation brace-round brace-close brace-level-2" id="pair-101-open">)</span> <span class="token punctuation brace-curly brace-close brace-level-1" id="pair-102-open">}</span><span class="token punctuation">;</span>
std<span class="token double-colon punctuation">::</span>unique_ptr<span class="token operator">&lt;</span>Resource<span class="token operator">&gt;</span> res1<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-103-close">{</span> res <span class="token punctuation brace-curly brace-close brace-level-1" id="pair-103-open">}</span><span class="token punctuation">;</span>
std<span class="token double-colon punctuation">::</span>unique_ptr<span class="token operator">&lt;</span>Resource<span class="token operator">&gt;</span> res2<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-104-close">{</span> res <span class="token punctuation brace-curly brace-close brace-level-1" id="pair-104-open">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre>
  <div class="toolbar">
    <div class="toolbar-item">
      <button
        class="copy-to-clipboard-button"
        type="button"
        data-copy-state="copy"
      >
        <span>Copy</span>
      </button>
    </div>
  </div>
</div>
<p>
  While this is legal syntactically, the end result will be that both res1 and
  res2 will try to delete the Resource, which will lead to undefined behavior.
</p>
<p>
  Second, don’t manually delete the resource out from underneath the
  std::unique_ptr.
</p>
<div class="code-toolbar">
  <pre
    class="line-numbers language-cpp"
    tabindex="0"
  ><code class="match-braces language-cpp">Resource<span class="token operator">*</span> res<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-106-close">{</span> <span class="token keyword keyword-new">new</span> <span class="token function">Resource</span><span class="token punctuation brace-round brace-open brace-level-2" id="pair-105-close">(</span><span class="token punctuation brace-round brace-close brace-level-2" id="pair-105-open">)</span> <span class="token punctuation brace-curly brace-close brace-level-1" id="pair-106-open">}</span><span class="token punctuation">;</span>
std<span class="token double-colon punctuation">::</span>unique_ptr<span class="token operator">&lt;</span>Resource<span class="token operator">&gt;</span> res1<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-107-close">{</span> res <span class="token punctuation brace-curly brace-close brace-level-1" id="pair-107-open">}</span><span class="token punctuation">;</span>
<span class="token keyword keyword-delete">delete</span> res<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre>
  <div class="toolbar">
    <div class="toolbar-item">
      <button
        class="copy-to-clipboard-button"
        type="button"
        data-copy-state="copy"
      >
        <span>Copy</span>
      </button>
    </div>
  </div>
</div>
<p>
  If you do, the std::unique_ptr will try to delete an already deleted resource,
  again leading to undefined behavior.
</p>
<p>
  Note that std::make_unique() prevents both of the above cases from happening
  inadvertently.
</p>
<p class="cpp-section cpp-topline" style="clear: both">Quiz time</p>
<div class="quiz" style="clear: both">
  <p class="quiz-header">Question #1</p>
  <p>
    Convert the following program from using a normal pointer to using
    std::unique_ptr where appropriate:
  </p>
  <div class="code-toolbar">
    <pre
      class="line-numbers language-cpp"
      tabindex="0"
    ><code class="match-braces language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>

<span class="token keyword keyword-class">class</span> <span class="token class-name">Fraction</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-120-close">{</span>
<span class="token keyword keyword-private">private</span><span class="token operator">:</span>
	<span class="token keyword keyword-int">int</span> m_numerator<span class="token punctuation brace-curly brace-open brace-level-2" id="pair-114-close">{</span> <span class="token number">0</span> <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-114-open">}</span><span class="token punctuation">;</span>
	<span class="token keyword keyword-int">int</span> m_denominator<span class="token punctuation brace-curly brace-open brace-level-2" id="pair-115-close">{</span> <span class="token number">1</span> <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-115-open">}</span><span class="token punctuation">;</span>

<span class="token keyword keyword-public">public</span><span class="token operator">:</span>
	<span class="token function">Fraction</span><span class="token punctuation brace-round brace-open brace-level-2" id="pair-108-close">(</span><span class="token keyword keyword-int">int</span> numerator <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword keyword-int">int</span> denominator <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation brace-round brace-close brace-level-2" id="pair-108-open">)</span> <span class="token operator">:</span>
		m_numerator<span class="token punctuation brace-curly brace-open brace-level-2" id="pair-116-close">{</span> numerator <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-116-open">}</span><span class="token punctuation">,</span> m_denominator<span class="token punctuation brace-curly brace-open brace-level-2" id="pair-117-close">{</span> denominator <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-117-open">}</span>
	<span class="token punctuation brace-curly brace-open brace-level-2" id="pair-118-close">{</span>
	<span class="token punctuation brace-curly brace-close brace-level-2" id="pair-118-open">}</span>

	<span class="token keyword keyword-friend">friend</span> std<span class="token double-colon punctuation">::</span>ostream<span class="token operator">&amp;</span> <span class="token keyword keyword-operator">operator</span><span class="token operator">&lt;&lt;</span><span class="token punctuation brace-round brace-open brace-level-2" id="pair-109-close">(</span>std<span class="token double-colon punctuation">::</span>ostream<span class="token operator">&amp;</span> out<span class="token punctuation">,</span> <span class="token keyword keyword-const">const</span> Fraction <span class="token operator">&amp;</span>f1<span class="token punctuation brace-round brace-close brace-level-2" id="pair-109-open">)</span>
	<span class="token punctuation brace-curly brace-open brace-level-2" id="pair-119-close">{</span>
		out <span class="token operator">&lt;&lt;</span> f1<span class="token punctuation">.</span>m_numerator <span class="token operator">&lt;&lt;</span> <span class="token string">'/'</span> <span class="token operator">&lt;&lt;</span> f1<span class="token punctuation">.</span>m_denominator<span class="token punctuation">;</span>
		<span class="token keyword keyword-return">return</span> out<span class="token punctuation">;</span>
	<span class="token punctuation brace-curly brace-close brace-level-2" id="pair-119-open">}</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-120-open">}</span><span class="token punctuation">;</span>

<span class="token keyword keyword-void">void</span> <span class="token function">printFraction</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-110-close">(</span><span class="token keyword keyword-const">const</span> Fraction<span class="token operator">*</span> ptr<span class="token punctuation brace-round brace-close brace-level-1" id="pair-110-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-121-close">{</span>
	<span class="token keyword keyword-if">if</span> <span class="token punctuation brace-round brace-open brace-level-2" id="pair-111-close">(</span>ptr<span class="token punctuation brace-round brace-close brace-level-2" id="pair-111-open">)</span>
		std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span>ptr <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span><span class="token punctuation">;</span>
	<span class="token keyword keyword-else">else</span>
		std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"No fraction\n"</span><span class="token punctuation">;</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-121-open">}</span>

<span class="token keyword keyword-int">int</span> <span class="token function">main</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-112-close">(</span><span class="token punctuation brace-round brace-close brace-level-1" id="pair-112-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-124-close">{</span>
	<span class="token keyword keyword-auto">auto</span><span class="token operator">*</span> ptr<span class="token punctuation brace-curly brace-open brace-level-2" id="pair-123-close">{</span> <span class="token keyword keyword-new">new</span> Fraction<span class="token punctuation brace-curly brace-open brace-level-3" id="pair-122-close">{</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span> <span class="token punctuation brace-curly brace-close brace-level-3" id="pair-122-open">}</span> <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-123-open">}</span><span class="token punctuation">;</span>

	<span class="token function">printFraction</span><span class="token punctuation brace-round brace-open brace-level-2" id="pair-113-close">(</span>ptr<span class="token punctuation brace-round brace-close brace-level-2" id="pair-113-open">)</span><span class="token punctuation">;</span>

	<span class="token keyword keyword-delete">delete</span> ptr<span class="token punctuation">;</span>

	<span class="token keyword keyword-return">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-124-open">}</span><span aria-hidden="true" class="line-numbers-rows"><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre>
    <div class="toolbar">
      <div class="toolbar-item">
        <button
          class="copy-to-clipboard-button"
          type="button"
          data-copy-state="copy"
        >
          <span>Copy</span>
        </button>
      </div>
    </div>
  </div>
  <p>
    <a
      class="solution_link_show"
      href="javascript:void(0)"
      onclick="cppSolutionToggle(document.getElementById('cpp_solution_id_0'), this, 'Show Solution', 'Hide Solution')"
      >Show Solution</a
    >
  </p>
  <div class="wpsolution" id="cpp_solution_id_0" style="display: none">
    <div class="code-toolbar">
      <pre
        class="line-numbers language-cpp"
        tabindex="0"
      ><code class="match-braces language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;memory&gt;</span> <span class="token comment">// for std::unique_ptr</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>

<span class="token keyword keyword-class">class</span> <span class="token class-name">Fraction</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-139-close">{</span>
<span class="token keyword keyword-private">private</span><span class="token operator">:</span>
	<span class="token keyword keyword-int">int</span> m_numerator<span class="token punctuation brace-curly brace-open brace-level-2" id="pair-133-close">{</span> <span class="token number">0</span> <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-133-open">}</span><span class="token punctuation">;</span>
	<span class="token keyword keyword-int">int</span> m_denominator<span class="token punctuation brace-curly brace-open brace-level-2" id="pair-134-close">{</span> <span class="token number">1</span> <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-134-open">}</span><span class="token punctuation">;</span>

<span class="token keyword keyword-public">public</span><span class="token operator">:</span>
	<span class="token function">Fraction</span><span class="token punctuation brace-round brace-open brace-level-2" id="pair-125-close">(</span><span class="token keyword keyword-int">int</span> numerator <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword keyword-int">int</span> denominator <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation brace-round brace-close brace-level-2" id="pair-125-open">)</span> <span class="token operator">:</span>
		m_numerator<span class="token punctuation brace-curly brace-open brace-level-2" id="pair-135-close">{</span> numerator <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-135-open">}</span><span class="token punctuation">,</span> m_denominator<span class="token punctuation brace-curly brace-open brace-level-2" id="pair-136-close">{</span> denominator <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-136-open">}</span>
	<span class="token punctuation brace-curly brace-open brace-level-2" id="pair-137-close">{</span>
	<span class="token punctuation brace-curly brace-close brace-level-2" id="pair-137-open">}</span>

	<span class="token keyword keyword-friend">friend</span> std<span class="token double-colon punctuation">::</span>ostream<span class="token operator">&amp;</span> <span class="token keyword keyword-operator">operator</span><span class="token operator">&lt;&lt;</span><span class="token punctuation brace-round brace-open brace-level-2" id="pair-126-close">(</span>std<span class="token double-colon punctuation">::</span>ostream<span class="token operator">&amp;</span> out<span class="token punctuation">,</span> <span class="token keyword keyword-const">const</span> Fraction <span class="token operator">&amp;</span>f1<span class="token punctuation brace-round brace-close brace-level-2" id="pair-126-open">)</span>
	<span class="token punctuation brace-curly brace-open brace-level-2" id="pair-138-close">{</span>
		out <span class="token operator">&lt;&lt;</span> f1<span class="token punctuation">.</span>m_numerator <span class="token operator">&lt;&lt;</span> <span class="token string">'/'</span> <span class="token operator">&lt;&lt;</span> f1<span class="token punctuation">.</span>m_denominator<span class="token punctuation">;</span>
		<span class="token keyword keyword-return">return</span> out<span class="token punctuation">;</span>
	<span class="token punctuation brace-curly brace-close brace-level-2" id="pair-138-open">}</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-139-open">}</span><span class="token punctuation">;</span>

<span class="token comment">// This function uses a Fraction object, so we just pass the Fraction itself</span>
<span class="token comment">// That way we don't have to worry about what kind of smart pointer (if any) the caller may be using</span>
<span class="token keyword keyword-void">void</span> <span class="token function">printFraction</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-127-close">(</span><span class="token keyword keyword-const">const</span> Fraction<span class="token operator">*</span> ptr<span class="token punctuation brace-round brace-close brace-level-1" id="pair-127-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-140-close">{</span>
	<span class="token keyword keyword-if">if</span> <span class="token punctuation brace-round brace-open brace-level-2" id="pair-128-close">(</span>ptr<span class="token punctuation brace-round brace-close brace-level-2" id="pair-128-open">)</span>
		std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span>ptr <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span><span class="token punctuation">;</span>
	<span class="token keyword keyword-else">else</span>
		std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"No fraction\n"</span><span class="token punctuation">;</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-140-open">}</span>

<span class="token keyword keyword-int">int</span> <span class="token function">main</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-129-close">(</span><span class="token punctuation brace-round brace-close brace-level-1" id="pair-129-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-142-close">{</span>
	<span class="token keyword keyword-auto">auto</span> ptr<span class="token punctuation brace-curly brace-open brace-level-2" id="pair-141-close">{</span> std<span class="token double-colon punctuation">::</span><span class="token generic-function"><span class="token function">make_unique</span><span class="token generic class-name"><span class="token operator">&lt;</span>Fraction<span class="token operator">&gt;</span></span></span><span class="token punctuation brace-round brace-open brace-level-3" id="pair-130-close">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation brace-round brace-close brace-level-3" id="pair-130-open">)</span> <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-141-open">}</span><span class="token punctuation">;</span>

	<span class="token function">printFraction</span><span class="token punctuation brace-round brace-open brace-level-2" id="pair-132-close">(</span>ptr<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation brace-round brace-open brace-level-3" id="pair-131-close">(</span><span class="token punctuation brace-round brace-close brace-level-3" id="pair-131-open">)</span><span class="token punctuation brace-round brace-close brace-level-2" id="pair-132-open">)</span><span class="token punctuation">;</span>

	<span class="token keyword keyword-return">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-142-open">}</span><span aria-hidden="true" class="line-numbers-rows"><span style="height: 0px;"></span><span style="height: 0px;"></span><span style="height: 0px;"></span><span style="height: 0px;"></span><span style="height: 0px;"></span><span style="height: 0px;"></span><span style="height: 0px;"></span><span style="height: 0px;"></span><span style="height: 0px;"></span><span style="height: 0px;"></span><span style="height: 0px;"></span><span style="height: 0px;"></span><span style="height: 0px;"></span><span style="height: 0px;"></span><span style="height: 0px;"></span><span style="height: 0px;"></span><span style="height: 0px;"></span><span style="height: 0px;"></span><span style="height: 0px;"></span><span style="height: 0px;"></span><span style="height: 0px;"></span><span style="height: 0px;"></span><span style="height: 0px;"></span><span style="height: 0px;"></span><span style="height: 0px;"></span><span style="height: 0px;"></span><span style="height: 0px;"></span><span style="height: 0px;"></span><span style="height: 0px;"></span><span style="height: 0px;"></span><span style="height: 0px;"></span><span style="height: 0px;"></span><span style="height: 0px;"></span><span style="height: 0px;"></span><span style="height: 0px;"></span><span style="height: 0px;"></span><span style="height: 0px;"></span><span style="height: 0px;"></span><span style="height: 0px;"></span><span style="height: 0px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre>
      <div class="toolbar">
        <div class="toolbar-item">
          <button
            class="copy-to-clipboard-button"
            type="button"
            data-copy-state="copy"
          >
            <span>Copy</span>
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="prevnext">
  <div class="prevnext-inline">
    <a
      class="nav-link"
      href="https://www.learncpp.com/cpp-tutorial/stdshared_ptr/"
    >
      <div class="nav-button nav-button-next">
        <div class="nav-button-icon">
          <i class="fa fa-chevron-circle-right" aria-hidden="true"></i>
        </div>
        <div class="nav-button-text">
          <div class="nav-button-title">Next lesson</div>
          <div class="nav-button-lesson">
            <span class="nav-button-lesson-number">22.6</span>std::shared_ptr
          </div>
        </div>
      </div></a
    >
    <a class="nav-link" href="/">
      <div class="nav-button nav-button-index">
        <div class="nav-button-icon">
          <i class="fa fa-home" aria-hidden="true"></i>
        </div>
        <div class="nav-button-text">
          <div class="nav-button-title">Back to table of contents</div>
        </div>
      </div></a
    >
    <a class="nav-link" href="https://www.learncpp.com/cpp-tutorial/stdmove/">
      <div class="nav-button nav-button-prev">
        <div class="nav-button-icon">
          <i class="fa fa-chevron-circle-left" aria-hidden="true"></i>
        </div>
        <div class="nav-button-text">
          <div class="nav-button-title">Previous lesson</div>
          <div class="nav-button-lesson">
            <span class="nav-button-lesson-number">22.4</span>std::move
          </div>
        </div>
      </div></a
    >
  </div>
</div>
<div class="code-block code-block-10" style="margin: 8px 0; clear: both"></div>

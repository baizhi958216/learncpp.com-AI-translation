<div
  class="code-block code-block-1"
  style="margin: 8px 8px 8px 0; float: left"
></div>
<p class="cpp-section cpp-topline" style="clear: both">
  The need for dynamic memory allocation
</p>
<p>
  C++ supports three basic types of memory allocation, of which you’ve already
  seen two.
</p>
<ul>
  <li>
    <strong>Static memory allocation</strong> happens for static and global
    variables. Memory for these types of variables is allocated once when your
    program is run and persists throughout the life of your program.
  </li>
  <li>
    <strong>Automatic memory allocation</strong> happens for function parameters
    and local variables. Memory for these types of variables is allocated when
    the relevant block is entered, and freed when the block is exited, as many
    times as necessary.
  </li>
  <li>
    <strong>Dynamic memory allocation</strong> is the topic of this article.
  </li>
</ul>
<p>Both static and automatic allocation have two things in common:</p>
<ul>
  <li>The size of the variable / array must be known at compile time.</li>
  <li>
    Memory allocation and deallocation happens automatically (when the variable
    is instantiated / destroyed).
  </li>
</ul>
<p>
  Most of the time, this is just fine. However, you will come across situations
  where one or both of these constraints cause problems, usually when dealing
  with external (user or file) input.
</p>
<p>
  For example, we may want to use a string to hold someone’s name, but we do not
  know how long their name is until they enter it. Or we may want to read in a
  number of records from disk, but we don’t know in advance how many records
  there are. Or we may be creating a game, with a variable number of monsters
  (that changes over time as some monsters die and new ones are spawned) trying
  to kill the player.
</p>
<div class="code-block code-block-2" style="margin: 8px 0; clear: both"></div>

<p>
  If we have to declare the size of everything at compile time, the best we can
  do is try to make a guess the maximum size of variables we’ll need and hope
  that’s enough:
</p>
<div class="code-toolbar">
  <pre
    class="line-numbers language-cpp"
    tabindex="0"
  ><code class="match-braces language-cpp"><span class="token keyword keyword-char">char</span> name<span class="token punctuation brace-square brace-open brace-level-1" id="pair-0-close">[</span><span class="token number">25</span><span class="token punctuation brace-square brace-close brace-level-1" id="pair-0-open">]</span><span class="token punctuation">;</span> <span class="token comment">// let's hope their name is less than 25 chars!</span>
Record record<span class="token punctuation brace-square brace-open brace-level-1" id="pair-1-close">[</span><span class="token number">500</span><span class="token punctuation brace-square brace-close brace-level-1" id="pair-1-open">]</span><span class="token punctuation">;</span> <span class="token comment">// let's hope there are less than 500 records!</span>
Monster monster<span class="token punctuation brace-square brace-open brace-level-1" id="pair-2-close">[</span><span class="token number">40</span><span class="token punctuation brace-square brace-close brace-level-1" id="pair-2-open">]</span><span class="token punctuation">;</span> <span class="token comment">// 40 monsters maximum</span>
Polygon rendering<span class="token punctuation brace-square brace-open brace-level-1" id="pair-3-close">[</span><span class="token number">30000</span><span class="token punctuation brace-square brace-close brace-level-1" id="pair-3-open">]</span><span class="token punctuation">;</span> <span class="token comment">// this 3d rendering better not have more than 30,000 polygons!</span><span aria-hidden="true" class="line-numbers-rows"><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre>
  <div class="toolbar">
    <div class="toolbar-item">
      <button
        class="copy-to-clipboard-button"
        type="button"
        data-copy-state="copy"
      >
        <span>Copy</span>
      </button>
    </div>
  </div>
</div>
<p>This is a poor solution for at least four reasons:</p>
<div
  class="google-auto-placed ap_container"
  style="width: 100%; height: auto; clear: both; text-align: center"
>
  <ins
    data-ad-format="auto"
    class="adsbygoogle adsbygoogle-noablate"
    data-ad-client="ca-pub-0588844875925051"
    data-adsbygoogle-status="done"
    style="
      display: block;
      margin: auto;
      background-color: transparent;
      height: 0px;
    "
    data-ad-status="unfilled"
    ><div
      id="aswift_5_host"
      style="
        border: none;
        height: 0px;
        width: 1027px;
        margin: 0px;
        padding: 0px;
        position: relative;
        visibility: visible;
        background-color: transparent;
        display: inline-block;
        overflow: hidden;
        opacity: 0;
      "
    >
      <iframe
        id="aswift_5"
        name="aswift_5"
        browsingtopics="true"
        style="
          left: 0px;
          position: absolute;
          top: 0px;
          border: 0px;
          width: 1027px;
          height: 0px;
          min-height: auto;
          max-height: none;
          min-width: auto;
          max-width: none;
        "
        sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation"
        width="1027"
        height="0"
        frameborder="0"
        marginwidth="0"
        marginheight="0"
        vspace="0"
        hspace="0"
        allowtransparency="true"
        scrolling="no"
        allow="attribution-reporting; run-ad-auction"
        src="https://googleads.g.doubleclick.net/pagead/ads?client=ca-pub-0588844875925051&amp;output=html&amp;h=280&amp;adk=880962766&amp;adf=1055490099&amp;w=1027&amp;abgtt=11&amp;fwrn=4&amp;fwrnh=100&amp;lmt=1751641354&amp;num_ads=1&amp;rafmt=1&amp;armr=3&amp;sem=mc&amp;pwprc=4633386603&amp;ad_type=text_image&amp;format=1027x280&amp;url=https%3A%2F%2Fwww.learncpp.com%2Fcpp-tutorial%2Fdynamic-memory-allocation-with-new-and-delete%2F&amp;fwr=0&amp;pra=3&amp;rh=200&amp;rw=1026&amp;rpe=1&amp;resp_fmts=3&amp;wgl=1&amp;fa=27&amp;uach=WyJXaW5kb3dzIiwiMTkuMC4wIiwieDg2IiwiIiwiMTM3LjAuNzE1MS4xMjIiLG51bGwsMCxudWxsLCI2NCIsW1siR29vZ2xlIENocm9tZSIsIjEzNy4wLjcxNTEuMTIyIl0sWyJDaHJvbWl1bSIsIjEzNy4wLjcxNTEuMTIyIl0sWyJOb3QvQSlCcmFuZCIsIjI0LjAuMC4wIl1dLDBd&amp;dt=1751963211465&amp;bpp=1&amp;bdt=485&amp;idt=-M&amp;shv=r20250702&amp;mjsv=m202507020101&amp;ptt=9&amp;saldr=aa&amp;abxe=1&amp;cookie=ID%3D05f6e82287d810b4%3AT%3D1751962604%3ART%3D1751962911%3AS%3DALNI_MaQYA0TSAU2k8xwY5tqlN0xFCcd6g&amp;gpic=UID%3D00001157d9e27d0a%3AT%3D1751962604%3ART%3D1751962911%3AS%3DALNI_MYgtHzQJAQQXY_151HTGSSfVxE8_A&amp;eo_id_str=ID%3D52c21936d98c6d2b%3AT%3D1751962604%3ART%3D1751962911%3AS%3DAA-AfjZsJ15yjdEPJ8d11hPojsJQ&amp;prev_fmts=0x0%2C336x280%2C160x600%2C160x600&amp;nras=2&amp;correlator=1989182826611&amp;frm=20&amp;pv=1&amp;u_tz=480&amp;u_his=2&amp;u_h=600&amp;u_w=800&amp;u_ah=600&amp;u_aw=800&amp;u_cd=24&amp;u_sd=1&amp;dmc=8&amp;adx=27&amp;ady=1125&amp;biw=1080&amp;bih=1024&amp;scr_x=0&amp;scr_y=0&amp;eid=31093233%2C31093235%2C42531705%2C95353387%2C95362656%2C95365225%2C95365235%2C95344788%2C95359266%2C95365115%2C95365798&amp;oid=2&amp;pvsid=1567181035466612&amp;tmod=1708485235&amp;uas=0&amp;nvt=1&amp;fc=1408&amp;brdim=10%2C10%2C10%2C10%2C800%2C0%2C780%2C580%2C1080%2C1024&amp;vis=1&amp;rsz=%7C%7Cs%7C&amp;abl=NS&amp;fu=128&amp;bc=31&amp;bz=0.72&amp;td=1&amp;tdf=2&amp;psd=W251bGwsbnVsbCxudWxsLDNd&amp;nt=1&amp;ifi=6&amp;uci=a!6&amp;btvi=1&amp;fsb=1&amp;dtd=21"
        data-google-container-id="a!6"
        tabindex="0"
        title="Advertisement"
        aria-label="Advertisement"
        data-load-complete="true"
        data-google-query-id="CMPAzMbrrI4DFWCYuQUdAtIPTw"
      ></iframe></div
  ></ins>
</div>
<p>
  First, it leads to wasted memory if the variables aren’t actually used. For
  example, if we allocate 25 chars for every name, but names on average are only
  12 chars long, we’re using over twice what we really need. Or consider the
  rendering array above: if a rendering only uses 10,000 polygons, we have
  20,000 Polygons worth of memory not being used!
</p>
<p>
  Second, how do we tell which bits of memory are actually used? For strings,
  it’s easy: a string that starts with a \0 is clearly not being used. But what
  about monster[24]? Is it alive or dead right now? Has it even been initialized
  in the first place? That necessitates having some way to tell the status of
  each monster, which adds complexity and can use up additional memory.
</p>
<p>
  Third, most normal variables (including fixed arrays) are allocated in a
  portion of memory called the <strong>stack</strong>. The amount of stack
  memory for a program is generally quite small -- Visual Studio defaults the
  stack size to 1MB. If you exceed this number, stack overflow will result, and
  the operating system will probably close down the program.
</p>
<div class="code-block code-block-3" style="margin: 8px 0; clear: both"></div>

<p>On Visual Studio, you can see this happen when running this program:</p>
<div class="code-toolbar">
  <pre
    class="line-numbers language-cpp"
    tabindex="0"
  ><code class="match-braces language-cpp"><span class="token keyword keyword-int">int</span> <span class="token function">main</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-4-close">(</span><span class="token punctuation brace-round brace-close brace-level-1" id="pair-4-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-6-close">{</span>
    <span class="token keyword keyword-int">int</span> array<span class="token punctuation brace-square brace-open brace-level-2" id="pair-5-close">[</span><span class="token number">1000000</span><span class="token punctuation brace-square brace-close brace-level-2" id="pair-5-open">]</span><span class="token punctuation">;</span> <span class="token comment">// allocate 1 million integers (probably 4MB of memory)</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-6-open">}</span><span aria-hidden="true" class="line-numbers-rows"><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre>
  <div class="toolbar">
    <div class="toolbar-item">
      <button
        class="copy-to-clipboard-button"
        type="button"
        data-copy-state="copy"
      >
        <span>Copy</span>
      </button>
    </div>
  </div>
</div>
<p>
  Being limited to just 1MB of memory would be problematic for many programs,
  especially those that deal with graphics.
</p>
<div
  class="google-auto-placed ap_container"
  style="width: 100%; height: auto; clear: both; text-align: center"
>
  <ins
    data-ad-format="auto"
    class="adsbygoogle adsbygoogle-noablate"
    data-ad-client="ca-pub-0588844875925051"
    data-adsbygoogle-status="done"
    style="
      display: block;
      margin: auto;
      background-color: transparent;
      height: 0px;
    "
    data-ad-status="unfilled"
    ><div
      id="aswift_6_host"
      style="
        border: none;
        height: 0px;
        width: 1027px;
        margin: 0px;
        padding: 0px;
        position: relative;
        visibility: visible;
        background-color: transparent;
        display: inline-block;
        overflow: hidden;
        opacity: 0;
      "
    >
      <iframe
        id="aswift_6"
        name="aswift_6"
        browsingtopics="true"
        style="
          left: 0px;
          position: absolute;
          top: 0px;
          border: 0px;
          width: 1027px;
          height: 0px;
          min-height: auto;
          max-height: none;
          min-width: auto;
          max-width: none;
        "
        sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation"
        width="1027"
        height="0"
        frameborder="0"
        marginwidth="0"
        marginheight="0"
        vspace="0"
        hspace="0"
        allowtransparency="true"
        scrolling="no"
        allow="attribution-reporting; run-ad-auction"
        src="https://googleads.g.doubleclick.net/pagead/ads?client=ca-pub-0588844875925051&amp;output=html&amp;h=280&amp;adk=880962766&amp;adf=1833584219&amp;w=1027&amp;abgtt=11&amp;fwrn=4&amp;fwrnh=100&amp;lmt=1751641354&amp;num_ads=1&amp;rafmt=1&amp;armr=3&amp;sem=mc&amp;pwprc=4633386603&amp;ad_type=text_image&amp;format=1027x280&amp;url=https%3A%2F%2Fwww.learncpp.com%2Fcpp-tutorial%2Fdynamic-memory-allocation-with-new-and-delete%2F&amp;fwr=0&amp;pra=3&amp;rh=200&amp;rw=1026&amp;rpe=1&amp;resp_fmts=3&amp;wgl=1&amp;fa=27&amp;uach=WyJXaW5kb3dzIiwiMTkuMC4wIiwieDg2IiwiIiwiMTM3LjAuNzE1MS4xMjIiLG51bGwsMCxudWxsLCI2NCIsW1siR29vZ2xlIENocm9tZSIsIjEzNy4wLjcxNTEuMTIyIl0sWyJDaHJvbWl1bSIsIjEzNy4wLjcxNTEuMTIyIl0sWyJOb3QvQSlCcmFuZCIsIjI0LjAuMC4wIl1dLDBd&amp;dt=1751963211465&amp;bpp=1&amp;bdt=485&amp;idt=-M&amp;shv=r20250702&amp;mjsv=m202507020101&amp;ptt=9&amp;saldr=aa&amp;abxe=1&amp;cookie=ID%3D05f6e82287d810b4%3AT%3D1751962604%3ART%3D1751962911%3AS%3DALNI_MaQYA0TSAU2k8xwY5tqlN0xFCcd6g&amp;gpic=UID%3D00001157d9e27d0a%3AT%3D1751962604%3ART%3D1751962911%3AS%3DALNI_MYgtHzQJAQQXY_151HTGSSfVxE8_A&amp;eo_id_str=ID%3D52c21936d98c6d2b%3AT%3D1751962604%3ART%3D1751962911%3AS%3DAA-AfjZsJ15yjdEPJ8d11hPojsJQ&amp;prev_fmts=0x0%2C336x280%2C160x600%2C160x600%2C1027x280&amp;nras=3&amp;correlator=1989182826611&amp;frm=20&amp;pv=1&amp;u_tz=480&amp;u_his=2&amp;u_h=600&amp;u_w=800&amp;u_ah=600&amp;u_aw=800&amp;u_cd=24&amp;u_sd=1&amp;dmc=8&amp;adx=27&amp;ady=1816&amp;biw=1080&amp;bih=1024&amp;scr_x=0&amp;scr_y=0&amp;eid=31093233%2C31093235%2C42531705%2C95353387%2C95362656%2C95365225%2C95365235%2C95344788%2C95359266%2C95365115%2C95365798&amp;oid=2&amp;pvsid=1567181035466612&amp;tmod=1708485235&amp;uas=0&amp;nvt=1&amp;fc=1408&amp;brdim=10%2C10%2C10%2C10%2C800%2C0%2C780%2C580%2C1080%2C1024&amp;vis=1&amp;rsz=%7C%7Cs%7C&amp;abl=NS&amp;fu=128&amp;bc=31&amp;bz=0.72&amp;td=1&amp;tdf=2&amp;psd=W251bGwsbnVsbCxudWxsLDNd&amp;nt=1&amp;ifi=7&amp;uci=a!7&amp;btvi=2&amp;fsb=1&amp;dtd=22"
        data-google-container-id="a!7"
        tabindex="0"
        title="Advertisement"
        aria-label="Advertisement"
        data-load-complete="true"
        data-google-query-id="CJTTzMbrrI4DFWgSewcdrZspXQ"
      ></iframe></div
  ></ins>
</div>
<p>
  Fourth, and most importantly, it can lead to artificial limitations and/or
  array overflows. What happens when the user tries to read in 600 records from
  disk, but we’ve only allocated memory for a maximum of 500 records? Either we
  have to give the user an error, only read the 500 records, or (in the worst
  case where we don’t handle this case at all) overflow the record array and
  watch something bad happen.
</p>
<p>
  Fortunately, these problems are easily addressed via dynamic memory
  allocation. <strong>Dynamic memory allocation</strong> is a way for running
  programs to request memory from the operating system when needed. This memory
  does not come from the program’s limited stack memory -- instead, it is
  allocated from a much larger pool of memory managed by the operating system
  called the <strong>heap</strong>. On modern machines, the heap can be
  gigabytes in size.
</p>
<p class="cpp-section cpp-topline" style="clear: both">
  Dynamically allocating single variables
</p>
<p>
  To allocate a <em>single</em> variable dynamically, we use the scalar
  (non-array) form of the <strong>new</strong> operator:
</p>
<div class="code-block code-block-4" style="margin: 8px 0; clear: both"></div>

<div class="code-toolbar">
  <pre
    class="line-numbers language-cpp"
    tabindex="0"
  ><code class="match-braces language-cpp"><span class="token keyword keyword-new">new</span> <span class="token keyword keyword-int">int</span><span class="token punctuation">;</span> <span class="token comment">// dynamically allocate an integer (and discard the result)</span><span aria-hidden="true" class="line-numbers-rows"><span style="height: 16px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre>
  <div class="toolbar">
    <div class="toolbar-item">
      <button
        class="copy-to-clipboard-button"
        type="button"
        data-copy-state="copy"
      >
        <span>Copy</span>
      </button>
    </div>
  </div>
</div>
<p>
  In the above case, we’re requesting an integer’s worth of memory from the
  operating system. The new operator creates the object using that memory, and
  then returns a pointer containing the <i>address</i> of the memory that has
  been allocated.
</p>
<div
  class="google-auto-placed ap_container"
  style="width: 100%; height: auto; clear: both; text-align: center"
>
  <ins
    data-ad-format="auto"
    class="adsbygoogle adsbygoogle-noablate"
    data-ad-client="ca-pub-0588844875925051"
    data-adsbygoogle-status="done"
    style="
      display: block;
      margin: auto;
      background-color: transparent;
      height: 0px;
    "
    data-ad-status="unfilled"
    ><div
      id="aswift_7_host"
      style="
        border: none;
        height: 0px;
        width: 1027px;
        margin: 0px;
        padding: 0px;
        position: relative;
        visibility: visible;
        background-color: transparent;
        display: inline-block;
        overflow: hidden;
        opacity: 0;
      "
    >
      <iframe
        id="aswift_7"
        name="aswift_7"
        browsingtopics="true"
        style="
          left: 0px;
          position: absolute;
          top: 0px;
          border: 0px;
          width: 1027px;
          height: 0px;
          min-height: auto;
          max-height: none;
          min-width: auto;
          max-width: none;
        "
        sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation"
        width="1027"
        height="0"
        frameborder="0"
        marginwidth="0"
        marginheight="0"
        vspace="0"
        hspace="0"
        allowtransparency="true"
        scrolling="no"
        allow="attribution-reporting; run-ad-auction"
        src="https://googleads.g.doubleclick.net/pagead/ads?client=ca-pub-0588844875925051&amp;output=html&amp;h=280&amp;adk=880962766&amp;adf=2593540152&amp;w=1027&amp;abgtt=11&amp;fwrn=4&amp;fwrnh=100&amp;lmt=1751641354&amp;num_ads=1&amp;rafmt=1&amp;armr=3&amp;sem=mc&amp;pwprc=4633386603&amp;ad_type=text_image&amp;format=1027x280&amp;url=https%3A%2F%2Fwww.learncpp.com%2Fcpp-tutorial%2Fdynamic-memory-allocation-with-new-and-delete%2F&amp;fwr=0&amp;pra=3&amp;rh=200&amp;rw=1026&amp;rpe=1&amp;resp_fmts=3&amp;wgl=1&amp;fa=27&amp;uach=WyJXaW5kb3dzIiwiMTkuMC4wIiwieDg2IiwiIiwiMTM3LjAuNzE1MS4xMjIiLG51bGwsMCxudWxsLCI2NCIsW1siR29vZ2xlIENocm9tZSIsIjEzNy4wLjcxNTEuMTIyIl0sWyJDaHJvbWl1bSIsIjEzNy4wLjcxNTEuMTIyIl0sWyJOb3QvQSlCcmFuZCIsIjI0LjAuMC4wIl1dLDBd&amp;dt=1751963211465&amp;bpp=1&amp;bdt=485&amp;idt=-M&amp;shv=r20250702&amp;mjsv=m202507020101&amp;ptt=9&amp;saldr=aa&amp;abxe=1&amp;cookie=ID%3D05f6e82287d810b4%3AT%3D1751962604%3ART%3D1751962911%3AS%3DALNI_MaQYA0TSAU2k8xwY5tqlN0xFCcd6g&amp;gpic=UID%3D00001157d9e27d0a%3AT%3D1751962604%3ART%3D1751962911%3AS%3DALNI_MYgtHzQJAQQXY_151HTGSSfVxE8_A&amp;eo_id_str=ID%3D52c21936d98c6d2b%3AT%3D1751962604%3ART%3D1751962911%3AS%3DAA-AfjZsJ15yjdEPJ8d11hPojsJQ&amp;prev_fmts=0x0%2C336x280%2C160x600%2C160x600%2C1027x280%2C1027x280&amp;nras=4&amp;correlator=1989182826611&amp;frm=20&amp;pv=1&amp;u_tz=480&amp;u_his=2&amp;u_h=600&amp;u_w=800&amp;u_ah=600&amp;u_aw=800&amp;u_cd=24&amp;u_sd=1&amp;dmc=8&amp;adx=27&amp;ady=2450&amp;biw=1080&amp;bih=1024&amp;scr_x=0&amp;scr_y=0&amp;eid=31093233%2C31093235%2C42531705%2C95353387%2C95362656%2C95365225%2C95365235%2C95344788%2C95359266%2C95365115%2C95365798&amp;oid=2&amp;pvsid=1567181035466612&amp;tmod=1708485235&amp;uas=0&amp;nvt=1&amp;fc=1408&amp;brdim=10%2C10%2C10%2C10%2C800%2C0%2C780%2C580%2C1080%2C1024&amp;vis=1&amp;rsz=%7C%7Cs%7C&amp;abl=NS&amp;fu=128&amp;bc=31&amp;bz=0.72&amp;td=1&amp;tdf=2&amp;psd=W251bGwsbnVsbCxudWxsLDNd&amp;nt=1&amp;ifi=8&amp;uci=a!8&amp;btvi=3&amp;fsb=1&amp;dtd=23"
        data-google-container-id="a!8"
        tabindex="0"
        title="Advertisement"
        aria-label="Advertisement"
        data-load-complete="true"
        data-google-query-id="CJrozMbrrI4DFbsrewcdgeIm-w"
      ></iframe></div
  ></ins>
</div>
<p>
  Most often, we’ll assign the return value to our own pointer variable so we
  can access the allocated memory later.
</p>
<div class="code-toolbar">
  <pre
    class="line-numbers language-cpp"
    tabindex="0"
  ><code class="match-braces language-cpp"><span class="token keyword keyword-int">int</span><span class="token operator">*</span> ptr<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-7-close">{</span> <span class="token keyword keyword-new">new</span> <span class="token keyword keyword-int">int</span> <span class="token punctuation brace-curly brace-close brace-level-1" id="pair-7-open">}</span><span class="token punctuation">;</span> <span class="token comment">// dynamically allocate an integer and assign the address to ptr so we can access it later</span><span aria-hidden="true" class="line-numbers-rows"><span style="height: 16px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre>
  <div class="toolbar">
    <div class="toolbar-item">
      <button
        class="copy-to-clipboard-button"
        type="button"
        data-copy-state="copy"
      >
        <span>Copy</span>
      </button>
    </div>
  </div>
</div>
<p>We can then dereference the pointer to access the memory:</p>
<div class="code-toolbar">
  <pre
    class="line-numbers language-cpp"
    tabindex="0"
  ><code class="match-braces language-cpp"><span class="token operator">*</span>ptr <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">;</span> <span class="token comment">// assign value of 7 to allocated memory</span><span aria-hidden="true" class="line-numbers-rows"><span style="height: 16px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre>
  <div class="toolbar">
    <div class="toolbar-item">
      <button
        class="copy-to-clipboard-button"
        type="button"
        data-copy-state="copy"
      >
        <span>Copy</span>
      </button>
    </div>
  </div>
</div>
<p>
  If it wasn’t before, it should now be clear at least one case in which
  pointers are useful. Without a pointer to hold the address of the memory that
  was just allocated, we’d have no way to access the memory that was just
  allocated for us!
</p>
<p>
  Note that accessing heap-allocated objects is generally slower than accessing
  stack-allocated objects. Because the compiler knows the address of
  stack-allocated objects, it can go directly to that address to get a value.
  Heap allocated objects are typically accessed via pointer. This requires two
  steps: one to get the address of the object (from the pointer), and another to
  get the value.
</p>
<div class="code-block code-block-5" style="margin: 8px 0; clear: both"></div>

<p class="cpp-section cpp-topline" style="clear: both">
  How does dynamic memory allocation work?
</p>
<div
  class="google-auto-placed ap_container"
  style="width: 100%; height: auto; clear: both; text-align: center"
>
  <ins
    data-ad-format="auto"
    class="adsbygoogle adsbygoogle-noablate"
    data-ad-client="ca-pub-0588844875925051"
    data-adsbygoogle-status="done"
    style="
      display: block;
      margin: auto;
      background-color: transparent;
      height: 0px;
    "
    data-ad-status="unfilled"
    ><div
      id="aswift_8_host"
      style="
        border: none;
        height: 0px;
        width: 1027px;
        margin: 0px;
        padding: 0px;
        position: relative;
        visibility: visible;
        background-color: transparent;
        display: inline-block;
        overflow: hidden;
        opacity: 0;
      "
    >
      <iframe
        id="aswift_8"
        name="aswift_8"
        browsingtopics="true"
        style="
          left: 0px;
          position: absolute;
          top: 0px;
          border: 0px;
          width: 1027px;
          height: 0px;
          min-height: auto;
          max-height: none;
          min-width: auto;
          max-width: none;
        "
        sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation"
        width="1027"
        height="0"
        frameborder="0"
        marginwidth="0"
        marginheight="0"
        vspace="0"
        hspace="0"
        allowtransparency="true"
        scrolling="no"
        allow="attribution-reporting; run-ad-auction"
        src="https://googleads.g.doubleclick.net/pagead/ads?client=ca-pub-0588844875925051&amp;output=html&amp;h=280&amp;adk=880962766&amp;adf=3144189896&amp;w=1027&amp;abgtt=11&amp;fwrn=4&amp;fwrnh=100&amp;lmt=1751641354&amp;num_ads=1&amp;rafmt=1&amp;armr=3&amp;sem=mc&amp;pwprc=4633386603&amp;ad_type=text_image&amp;format=1027x280&amp;url=https%3A%2F%2Fwww.learncpp.com%2Fcpp-tutorial%2Fdynamic-memory-allocation-with-new-and-delete%2F&amp;fwr=0&amp;pra=3&amp;rh=200&amp;rw=1026&amp;rpe=1&amp;resp_fmts=3&amp;wgl=1&amp;fa=27&amp;uach=WyJXaW5kb3dzIiwiMTkuMC4wIiwieDg2IiwiIiwiMTM3LjAuNzE1MS4xMjIiLG51bGwsMCxudWxsLCI2NCIsW1siR29vZ2xlIENocm9tZSIsIjEzNy4wLjcxNTEuMTIyIl0sWyJDaHJvbWl1bSIsIjEzNy4wLjcxNTEuMTIyIl0sWyJOb3QvQSlCcmFuZCIsIjI0LjAuMC4wIl1dLDBd&amp;dt=1751963211465&amp;bpp=1&amp;bdt=485&amp;idt=-M&amp;shv=r20250702&amp;mjsv=m202507020101&amp;ptt=9&amp;saldr=aa&amp;abxe=1&amp;cookie=ID%3D05f6e82287d810b4%3AT%3D1751962604%3ART%3D1751962911%3AS%3DALNI_MaQYA0TSAU2k8xwY5tqlN0xFCcd6g&amp;gpic=UID%3D00001157d9e27d0a%3AT%3D1751962604%3ART%3D1751962911%3AS%3DALNI_MYgtHzQJAQQXY_151HTGSSfVxE8_A&amp;eo_id_str=ID%3D52c21936d98c6d2b%3AT%3D1751962604%3ART%3D1751962911%3AS%3DAA-AfjZsJ15yjdEPJ8d11hPojsJQ&amp;prev_fmts=0x0%2C336x280%2C160x600%2C160x600%2C1027x280%2C1027x280%2C1027x280&amp;nras=5&amp;correlator=1989182826611&amp;frm=20&amp;pv=1&amp;u_tz=480&amp;u_his=2&amp;u_h=600&amp;u_w=800&amp;u_ah=600&amp;u_aw=800&amp;u_cd=24&amp;u_sd=1&amp;dmc=8&amp;adx=27&amp;ady=3104&amp;biw=1080&amp;bih=1024&amp;scr_x=0&amp;scr_y=0&amp;eid=31093233%2C31093235%2C42531705%2C95353387%2C95362656%2C95365225%2C95365235%2C95344788%2C95359266%2C95365115%2C95365798&amp;oid=2&amp;pvsid=1567181035466612&amp;tmod=1708485235&amp;uas=0&amp;nvt=1&amp;fc=1408&amp;brdim=10%2C10%2C10%2C10%2C800%2C0%2C780%2C580%2C1080%2C1024&amp;vis=1&amp;rsz=%7C%7Cs%7C&amp;abl=NS&amp;fu=128&amp;bc=31&amp;bz=0.72&amp;td=1&amp;tdf=2&amp;psd=W251bGwsbnVsbCxudWxsLDNd&amp;nt=1&amp;ifi=9&amp;uci=a!9&amp;btvi=4&amp;fsb=1&amp;dtd=24"
        data-google-container-id="a!9"
        tabindex="0"
        title="Advertisement"
        aria-label="Advertisement"
        data-load-complete="true"
        data-google-query-id="CMXqzMbrrI4DFRMjewcd-LkSng"
      ></iframe></div
  ></ins>
</div>
<p>
  Your computer has memory (probably lots of it) that is available for
  applications to use. When you run an application, your operating system loads
  the application into some of that memory. This memory used by your application
  is divided into different areas, each of which serves a different purpose. One
  area contains your code. Another area is used for normal operations (keeping
  track of which functions were called, creating and destroying global and local
  variables, etc…). We’ll talk more about those later. However, much of the
  memory available just sits there, waiting to be handed out to programs that
  request it.
</p>
<p>
  When you dynamically allocate memory, you’re asking the operating system to
  reserve some of that memory for your program’s use. If it can fulfill this
  request, it will return the address of that memory to your application. From
  that point forward, your application can use this memory as it wishes. When
  your application is done with the memory, it can return the memory back to the
  operating system to be given to another program.
</p>
<p>
  Unlike static or automatic memory, the program itself is responsible for
  requesting and disposing of dynamically allocated memory.
</p>
<div class="cpp-note cpp-lightbluebackground">
  <p class="cpp-note-title cpp-bottomline">Key insight</p>
  <p>
    The allocation and deallocation for stack objects is done automatically.
    There is no need for us to deal with memory addresses -- the code the
    compiler writes can do this for us.
  </p>
  <p>
    The allocation and deallocation for heap objects is not done automatically.
    We need to be involved. That means we need some unambiguous way to refer to
    a specific heap allocated object, so that we can request its destruction
    when we’re ready. And the way we reference such objects is via memory
    address.
  </p>
  <p>
    When we use operator new, it returns a pointer containing the memory address
    of the newly allocated object. We generally want to store that in a pointer
    so we can use that address later to access the object (and eventually,
    request its destruction).
  </p>
</div>
<p class="cpp-section cpp-topline" style="clear: both">
  Initializing a dynamically allocated variable
</p>
<div
  class="google-auto-placed ap_container"
  style="width: 100%; height: auto; clear: both; text-align: center"
>
  <ins
    data-ad-format="auto"
    class="adsbygoogle adsbygoogle-noablate"
    data-ad-client="ca-pub-0588844875925051"
    data-adsbygoogle-status="done"
    style="
      display: block;
      margin: auto;
      background-color: transparent;
      height: 0px;
    "
    data-ad-status="unfilled"
    ><div
      id="aswift_9_host"
      style="
        border: none;
        height: 0px;
        width: 1027px;
        margin: 0px;
        padding: 0px;
        position: relative;
        visibility: visible;
        background-color: transparent;
        display: inline-block;
        overflow: hidden;
        opacity: 0;
      "
    >
      <iframe
        id="aswift_9"
        name="aswift_9"
        browsingtopics="true"
        style="
          left: 0px;
          position: absolute;
          top: 0px;
          border: 0px;
          width: 1027px;
          height: 0px;
          min-height: auto;
          max-height: none;
          min-width: auto;
          max-width: none;
        "
        sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation"
        width="1027"
        height="0"
        frameborder="0"
        marginwidth="0"
        marginheight="0"
        vspace="0"
        hspace="0"
        allowtransparency="true"
        scrolling="no"
        allow="attribution-reporting; run-ad-auction"
        src="https://googleads.g.doubleclick.net/pagead/ads?client=ca-pub-0588844875925051&amp;output=html&amp;h=280&amp;adk=880962766&amp;adf=1437395643&amp;w=1027&amp;abgtt=11&amp;fwrn=4&amp;fwrnh=100&amp;lmt=1751641354&amp;num_ads=1&amp;rafmt=1&amp;armr=3&amp;sem=mc&amp;pwprc=4633386603&amp;ad_type=text_image&amp;format=1027x280&amp;url=https%3A%2F%2Fwww.learncpp.com%2Fcpp-tutorial%2Fdynamic-memory-allocation-with-new-and-delete%2F&amp;fwr=0&amp;pra=3&amp;rh=200&amp;rw=1026&amp;rpe=1&amp;resp_fmts=3&amp;wgl=1&amp;fa=27&amp;uach=WyJXaW5kb3dzIiwiMTkuMC4wIiwieDg2IiwiIiwiMTM3LjAuNzE1MS4xMjIiLG51bGwsMCxudWxsLCI2NCIsW1siR29vZ2xlIENocm9tZSIsIjEzNy4wLjcxNTEuMTIyIl0sWyJDaHJvbWl1bSIsIjEzNy4wLjcxNTEuMTIyIl0sWyJOb3QvQSlCcmFuZCIsIjI0LjAuMC4wIl1dLDBd&amp;dt=1751963211465&amp;bpp=1&amp;bdt=485&amp;idt=0&amp;shv=r20250702&amp;mjsv=m202507020101&amp;ptt=9&amp;saldr=aa&amp;abxe=1&amp;cookie=ID%3D05f6e82287d810b4%3AT%3D1751962604%3ART%3D1751962911%3AS%3DALNI_MaQYA0TSAU2k8xwY5tqlN0xFCcd6g&amp;gpic=UID%3D00001157d9e27d0a%3AT%3D1751962604%3ART%3D1751962911%3AS%3DALNI_MYgtHzQJAQQXY_151HTGSSfVxE8_A&amp;eo_id_str=ID%3D52c21936d98c6d2b%3AT%3D1751962604%3ART%3D1751962911%3AS%3DAA-AfjZsJ15yjdEPJ8d11hPojsJQ&amp;prev_fmts=0x0%2C336x280%2C160x600%2C160x600%2C1027x280%2C1027x280%2C1027x280%2C1027x280&amp;nras=6&amp;correlator=1989182826611&amp;frm=20&amp;pv=1&amp;u_tz=480&amp;u_his=2&amp;u_h=600&amp;u_w=800&amp;u_ah=600&amp;u_aw=800&amp;u_cd=24&amp;u_sd=1&amp;dmc=8&amp;adx=27&amp;ady=3870&amp;biw=1080&amp;bih=1024&amp;scr_x=0&amp;scr_y=0&amp;eid=31093233%2C31093235%2C42531705%2C95353387%2C95362656%2C95365225%2C95365235%2C95344788%2C95359266%2C95365115%2C95365798&amp;oid=2&amp;pvsid=1567181035466612&amp;tmod=1708485235&amp;uas=0&amp;nvt=1&amp;fc=1408&amp;brdim=10%2C10%2C10%2C10%2C800%2C0%2C780%2C580%2C1080%2C1024&amp;vis=1&amp;rsz=%7C%7Cs%7C&amp;abl=NS&amp;fu=128&amp;bc=31&amp;bz=0.72&amp;td=1&amp;tdf=2&amp;psd=W251bGwsbnVsbCxudWxsLDNd&amp;nt=1&amp;ifi=10&amp;uci=a!a&amp;btvi=5&amp;fsb=1&amp;dtd=25"
        data-google-container-id="a!a"
        tabindex="0"
        title="Advertisement"
        aria-label="Advertisement"
        data-load-complete="true"
        data-google-query-id="COOezcbrrI4DFb7zTAId88I8UQ"
      ></iframe></div
  ></ins>
</div>
<div class="code-block code-block-6" style="margin: 8px 0; clear: both"></div>

<p>
  When you dynamically allocate a variable, you can also initialize it via
  direct initialization or uniform initialization:
</p>
<div class="code-toolbar">
  <pre
    class="line-numbers language-cpp"
    tabindex="0"
  ><code class="match-braces language-cpp"><span class="token keyword keyword-int">int</span><span class="token operator">*</span> ptr1<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-9-close">{</span> <span class="token keyword keyword-new">new</span> <span class="token keyword keyword-int">int</span> <span class="token punctuation brace-round brace-open brace-level-2" id="pair-8-close">(</span><span class="token number">5</span><span class="token punctuation brace-round brace-close brace-level-2" id="pair-8-open">)</span> <span class="token punctuation brace-curly brace-close brace-level-1" id="pair-9-open">}</span><span class="token punctuation">;</span> <span class="token comment">// use direct initialization</span>
<span class="token keyword keyword-int">int</span><span class="token operator">*</span> ptr2<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-11-close">{</span> <span class="token keyword keyword-new">new</span> <span class="token keyword keyword-int">int</span> <span class="token punctuation brace-curly brace-open brace-level-2" id="pair-10-close">{</span> <span class="token number">6</span> <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-10-open">}</span> <span class="token punctuation brace-curly brace-close brace-level-1" id="pair-11-open">}</span><span class="token punctuation">;</span> <span class="token comment">// use uniform initialization</span><span aria-hidden="true" class="line-numbers-rows"><span style="height: 16px;"></span><span style="height: 16px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre>
  <div class="toolbar">
    <div class="toolbar-item">
      <button
        class="copy-to-clipboard-button"
        type="button"
        data-copy-state="copy"
      >
        <span>Copy</span>
      </button>
    </div>
  </div>
</div>
<p class="cpp-section cpp-topline" style="clear: both">
  Deleting a single variable
</p>
<p>
  When we are done with a dynamically allocated variable, we need to explicitly
  tell C++ to free the memory for reuse. For single variables, this is done via
  the scalar (non-array) form of the <strong>delete</strong> operator:
</p>
<div class="code-toolbar">
  <pre
    class="line-numbers language-cpp"
    tabindex="0"
  ><code class="match-braces language-cpp"><span class="token comment">// assume ptr has previously been allocated with operator new</span>
<span class="token keyword keyword-delete">delete</span> ptr<span class="token punctuation">;</span> <span class="token comment">// return the memory pointed to by ptr to the operating system</span>
ptr <span class="token operator">=</span> <span class="token keyword keyword-nullptr">nullptr</span><span class="token punctuation">;</span> <span class="token comment">// set ptr to be a null pointer</span><span aria-hidden="true" class="line-numbers-rows"><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre>
  <div class="toolbar">
    <div class="toolbar-item">
      <button
        class="copy-to-clipboard-button"
        type="button"
        data-copy-state="copy"
      >
        <span>Copy</span>
      </button>
    </div>
  </div>
</div>
<p class="cpp-section cpp-topline" style="clear: both">
  What does it mean to delete memory?
</p>
<div
  class="google-auto-placed ap_container"
  style="width: 100%; height: auto; clear: both; text-align: center"
>
  <ins
    data-ad-format="auto"
    class="adsbygoogle adsbygoogle-noablate"
    data-ad-client="ca-pub-0588844875925051"
    data-adsbygoogle-status="done"
    style="
      display: block;
      margin: auto;
      background-color: transparent;
      height: 0px;
    "
    ><div
      id="aswift_10_host"
      style="
        border: none;
        height: 0px;
        width: 1027px;
        margin: 0px;
        padding: 0px;
        position: relative;
        visibility: visible;
        background-color: transparent;
        display: inline-block;
        overflow: hidden;
        opacity: 0;
      "
    >
      <iframe
        id="aswift_10"
        name="aswift_10"
        browsingtopics="true"
        style="
          left: 0px;
          position: absolute;
          top: 0px;
          border: 0px;
          width: 1027px;
          height: 0px;
          min-height: auto;
          max-height: none;
          min-width: auto;
          max-width: none;
        "
        sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation"
        width="1027"
        height="0"
        frameborder="0"
        marginwidth="0"
        marginheight="0"
        vspace="0"
        hspace="0"
        allowtransparency="true"
        scrolling="no"
        allow="attribution-reporting; run-ad-auction"
        src="https://googleads.g.doubleclick.net/pagead/ads?client=ca-pub-0588844875925051&amp;output=html&amp;h=280&amp;adk=880962766&amp;adf=2903856513&amp;w=1027&amp;abgtt=11&amp;fwrn=4&amp;fwrnh=100&amp;lmt=1751641354&amp;num_ads=1&amp;rafmt=1&amp;armr=3&amp;sem=mc&amp;pwprc=4633386603&amp;ad_type=text_image&amp;format=1027x280&amp;url=https%3A%2F%2Fwww.learncpp.com%2Fcpp-tutorial%2Fdynamic-memory-allocation-with-new-and-delete%2F&amp;fwr=0&amp;pra=3&amp;rh=200&amp;rw=1026&amp;rpe=1&amp;resp_fmts=3&amp;wgl=1&amp;fa=27&amp;uach=WyJXaW5kb3dzIiwiMTkuMC4wIiwieDg2IiwiIiwiMTM3LjAuNzE1MS4xMjIiLG51bGwsMCxudWxsLCI2NCIsW1siR29vZ2xlIENocm9tZSIsIjEzNy4wLjcxNTEuMTIyIl0sWyJDaHJvbWl1bSIsIjEzNy4wLjcxNTEuMTIyIl0sWyJOb3QvQSlCcmFuZCIsIjI0LjAuMC4wIl1dLDBd&amp;dt=1751963211467&amp;bpp=1&amp;bdt=487&amp;idt=1&amp;shv=r20250702&amp;mjsv=m202507020101&amp;ptt=9&amp;saldr=aa&amp;abxe=1&amp;cookie=ID%3D05f6e82287d810b4%3AT%3D1751962604%3ART%3D1751962911%3AS%3DALNI_MaQYA0TSAU2k8xwY5tqlN0xFCcd6g&amp;gpic=UID%3D00001157d9e27d0a%3AT%3D1751962604%3ART%3D1751962911%3AS%3DALNI_MYgtHzQJAQQXY_151HTGSSfVxE8_A&amp;eo_id_str=ID%3D52c21936d98c6d2b%3AT%3D1751962604%3ART%3D1751962911%3AS%3DAA-AfjZsJ15yjdEPJ8d11hPojsJQ&amp;prev_fmts=0x0%2C336x280%2C160x600%2C160x600%2C1027x280%2C1027x280%2C1027x280%2C1027x280%2C1027x280&amp;nras=7&amp;correlator=1989182826611&amp;frm=20&amp;pv=1&amp;u_tz=480&amp;u_his=2&amp;u_h=600&amp;u_w=800&amp;u_ah=600&amp;u_aw=800&amp;u_cd=24&amp;u_sd=1&amp;dmc=8&amp;adx=27&amp;ady=3114&amp;biw=1080&amp;bih=1024&amp;scr_x=0&amp;scr_y=0&amp;eid=31093233%2C31093235%2C42531705%2C95353387%2C95362656%2C95365225%2C95365235%2C95344788%2C95359266%2C95365115%2C95365798&amp;oid=2&amp;pvsid=1567181035466612&amp;tmod=1708485235&amp;uas=0&amp;nvt=1&amp;fc=1408&amp;brdim=10%2C10%2C10%2C10%2C800%2C0%2C780%2C580%2C1080%2C1024&amp;vis=1&amp;rsz=%7C%7Cs%7C&amp;abl=NS&amp;fu=128&amp;bc=31&amp;bz=0.72&amp;td=1&amp;tdf=2&amp;psd=W251bGwsbnVsbCxudWxsLDNd&amp;nt=1&amp;ifi=11&amp;uci=a!b&amp;btvi=6&amp;fsb=1&amp;dtd=287"
        data-google-container-id="a!b"
        tabindex="0"
        title="Advertisement"
        aria-label="Advertisement"
        data-load-complete="true"
        data-google-query-id="CJuD3cbrrI4DFU6SuQUdO2EGAQ"
      ></iframe></div
  ></ins>
</div>
<p>
  The delete operator does not <em>actually</em> delete anything. It simply
  returns the memory being pointed to back to the operating system. The
  operating system is then free to reassign that memory to another application
  (or to this application again later).
</p>
<p>
  Although the syntax makes it look like we’re deleting a <em>variable</em>,
  this is not the case! The pointer variable still has the same scope as before,
  and can be assigned a new value (e.g. <code>nullptr</code>) just like any
  other variable.
</p>
<div class="code-block code-block-7" style="margin: 8px 0; clear: both"></div>

<p>
  Note that deleting a pointer that is not pointing to dynamically allocated
  memory may cause bad things to happen.
</p>
<p class="cpp-section cpp-topline" style="clear: both">Dangling pointers</p>
<p>
  C++ does not make any guarantees about what will happen to the contents of
  deallocated memory, or to the value of the pointer being deleted. In most
  cases, the memory returned to the operating system will contain the same
  values it had before it was returned, and the pointer will be left pointing to
  the now deallocated memory.
</p>
<p>
  A pointer that is pointing to deallocated memory is called a
  <strong>dangling pointer</strong>. Dereferencing or deleting a dangling
  pointer will lead to undefined behavior. Consider the following program:
</p>
<div class="code-toolbar">
  <pre
    class="line-numbers language-cpp"
    tabindex="0"
  ><code class="match-braces language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>

<span class="token keyword keyword-int">int</span> <span class="token function">main</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-12-close">(</span><span class="token punctuation brace-round brace-close brace-level-1" id="pair-12-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-14-close">{</span>
    <span class="token keyword keyword-int">int</span><span class="token operator">*</span> ptr<span class="token punctuation brace-curly brace-open brace-level-2" id="pair-13-close">{</span> <span class="token keyword keyword-new">new</span> <span class="token keyword keyword-int">int</span> <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-13-open">}</span><span class="token punctuation">;</span> <span class="token comment">// dynamically allocate an integer</span>
    <span class="token operator">*</span>ptr <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">;</span> <span class="token comment">// put a value in that memory location</span>

    <span class="token keyword keyword-delete">delete</span> ptr<span class="token punctuation">;</span> <span class="token comment">// return the memory to the operating system.  ptr is now a dangling pointer.</span>

    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span>ptr<span class="token punctuation">;</span> <span class="token comment">// Dereferencing a dangling pointer will cause undefined behavior</span>
    <span class="token keyword keyword-delete">delete</span> ptr<span class="token punctuation">;</span> <span class="token comment">// trying to deallocate the memory again will also lead to undefined behavior.</span>

    <span class="token keyword keyword-return">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-14-open">}</span><span aria-hidden="true" class="line-numbers-rows"><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre>
  <div class="toolbar">
    <div class="toolbar-item">
      <button
        class="copy-to-clipboard-button"
        type="button"
        data-copy-state="copy"
      >
        <span>Copy</span>
      </button>
    </div>
  </div>
</div>
<p>
  In the above program, the value of 7 that was previously assigned to the
  allocated memory will probably still be there, but it’s possible that the
  value at that memory address could have changed. It’s also possible the memory
  could be allocated to another application (or for the operating system’s own
  usage), and trying to access that memory will cause the operating system to
  shut the program down.
</p>
<div
  class="google-auto-placed ap_container"
  style="width: 100%; height: auto; clear: both; text-align: center"
>
  <ins
    data-ad-format="auto"
    class="adsbygoogle adsbygoogle-noablate"
    data-ad-client="ca-pub-0588844875925051"
    data-adsbygoogle-status="done"
    style="
      display: block;
      margin: auto;
      background-color: transparent;
      height: 0px;
    "
    ><div
      id="aswift_11_host"
      style="
        border: none;
        height: 0px;
        width: 1027px;
        margin: 0px;
        padding: 0px;
        position: relative;
        visibility: visible;
        background-color: transparent;
        display: inline-block;
        overflow: hidden;
        opacity: 0;
      "
    >
      <iframe
        id="aswift_11"
        name="aswift_11"
        browsingtopics="true"
        style="
          left: 0px;
          position: absolute;
          top: 0px;
          border: 0px;
          width: 1027px;
          height: 0px;
          min-height: auto;
          max-height: none;
          min-width: auto;
          max-width: none;
        "
        sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation"
        width="1027"
        height="0"
        frameborder="0"
        marginwidth="0"
        marginheight="0"
        vspace="0"
        hspace="0"
        allowtransparency="true"
        scrolling="no"
        allow="attribution-reporting; run-ad-auction"
        src="https://googleads.g.doubleclick.net/pagead/ads?client=ca-pub-0588844875925051&amp;output=html&amp;h=280&amp;adk=880962766&amp;adf=19550639&amp;w=1027&amp;abgtt=11&amp;fwrn=4&amp;fwrnh=100&amp;lmt=1751641354&amp;num_ads=1&amp;rafmt=1&amp;armr=3&amp;sem=mc&amp;pwprc=4633386603&amp;ad_type=text_image&amp;format=1027x280&amp;url=https%3A%2F%2Fwww.learncpp.com%2Fcpp-tutorial%2Fdynamic-memory-allocation-with-new-and-delete%2F&amp;fwr=0&amp;pra=3&amp;rh=200&amp;rw=1026&amp;rpe=1&amp;resp_fmts=3&amp;wgl=1&amp;fa=27&amp;uach=WyJXaW5kb3dzIiwiMTkuMC4wIiwieDg2IiwiIiwiMTM3LjAuNzE1MS4xMjIiLG51bGwsMCxudWxsLCI2NCIsW1siR29vZ2xlIENocm9tZSIsIjEzNy4wLjcxNTEuMTIyIl0sWyJDaHJvbWl1bSIsIjEzNy4wLjcxNTEuMTIyIl0sWyJOb3QvQSlCcmFuZCIsIjI0LjAuMC4wIl1dLDBd&amp;dt=1751963211469&amp;bpp=1&amp;bdt=489&amp;idt=1&amp;shv=r20250702&amp;mjsv=m202507020101&amp;ptt=9&amp;saldr=aa&amp;abxe=1&amp;cookie=ID%3D05f6e82287d810b4%3AT%3D1751962604%3ART%3D1751962911%3AS%3DALNI_MaQYA0TSAU2k8xwY5tqlN0xFCcd6g&amp;gpic=UID%3D00001157d9e27d0a%3AT%3D1751962604%3ART%3D1751962911%3AS%3DALNI_MYgtHzQJAQQXY_151HTGSSfVxE8_A&amp;eo_id_str=ID%3D52c21936d98c6d2b%3AT%3D1751962604%3ART%3D1751962911%3AS%3DAA-AfjZsJ15yjdEPJ8d11hPojsJQ&amp;prev_fmts=0x0%2C336x280%2C160x600%2C160x600%2C1027x280%2C1027x280%2C1027x280%2C1027x280%2C1027x280%2C1027x280&amp;nras=8&amp;correlator=1989182826611&amp;frm=20&amp;pv=1&amp;u_tz=480&amp;u_his=2&amp;u_h=600&amp;u_w=800&amp;u_ah=600&amp;u_aw=800&amp;u_cd=24&amp;u_sd=1&amp;dmc=8&amp;adx=27&amp;ady=4068&amp;biw=1080&amp;bih=1024&amp;scr_x=0&amp;scr_y=0&amp;eid=31093233%2C31093235%2C42531705%2C95353387%2C95362656%2C95365225%2C95365235%2C95344788%2C95359266%2C95365115%2C95365798&amp;oid=2&amp;pvsid=1567181035466612&amp;tmod=1708485235&amp;uas=0&amp;nvt=1&amp;fc=1408&amp;brdim=10%2C10%2C10%2C10%2C800%2C0%2C780%2C580%2C1080%2C1024&amp;vis=1&amp;rsz=%7C%7Cs%7C&amp;abl=NS&amp;fu=128&amp;bc=31&amp;bz=0.72&amp;td=1&amp;tdf=2&amp;psd=W251bGwsbnVsbCxudWxsLDNd&amp;nt=1&amp;ifi=12&amp;uci=a!c&amp;btvi=7&amp;fsb=1&amp;dtd=294"
        data-google-container-id="a!c"
        tabindex="0"
        title="Advertisement"
        aria-label="Advertisement"
        data-load-complete="true"
        data-google-query-id="CODm3cbrrI4DFSCYuQUd1yoDTQ"
      ></iframe></div
  ></ins>
</div>
<p>
  Deallocating memory may create multiple dangling pointers. Consider the
  following example:
</p>
<div class="code-block code-block-8" style="margin: 8px 0; clear: both"></div>

<div class="code-toolbar">
  <pre
    class="line-numbers language-cpp"
    tabindex="0"
  ><code class="match-braces language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>

<span class="token keyword keyword-int">int</span> <span class="token function">main</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-15-close">(</span><span class="token punctuation brace-round brace-close brace-level-1" id="pair-15-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-19-close">{</span>
    <span class="token keyword keyword-int">int</span><span class="token operator">*</span> ptr<span class="token punctuation brace-curly brace-open brace-level-2" id="pair-17-close">{</span> <span class="token keyword keyword-new">new</span> <span class="token keyword keyword-int">int</span><span class="token punctuation brace-curly brace-open brace-level-3" id="pair-16-close">{</span><span class="token punctuation brace-curly brace-close brace-level-3" id="pair-16-open">}</span> <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-17-open">}</span><span class="token punctuation">;</span> <span class="token comment">// dynamically allocate an integer</span>
    <span class="token keyword keyword-int">int</span><span class="token operator">*</span> otherPtr<span class="token punctuation brace-curly brace-open brace-level-2" id="pair-18-close">{</span> ptr <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-18-open">}</span><span class="token punctuation">;</span> <span class="token comment">// otherPtr is now pointed at that same memory location</span>

    <span class="token keyword keyword-delete">delete</span> ptr<span class="token punctuation">;</span> <span class="token comment">// return the memory to the operating system.  ptr and otherPtr are now dangling pointers.</span>
    ptr <span class="token operator">=</span> <span class="token keyword keyword-nullptr">nullptr</span><span class="token punctuation">;</span> <span class="token comment">// ptr is now a nullptr</span>

    <span class="token comment">// however, otherPtr is still a dangling pointer!</span>

    <span class="token keyword keyword-return">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-19-open">}</span><span aria-hidden="true" class="line-numbers-rows"><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre>
  <div class="toolbar">
    <div class="toolbar-item">
      <button
        class="copy-to-clipboard-button"
        type="button"
        data-copy-state="copy"
      >
        <span>Copy</span>
      </button>
    </div>
  </div>
</div>
<p>There are a few best practices that can help here.</p>
<div
  class="google-auto-placed ap_container"
  style="width: 100%; height: auto; clear: both; text-align: center"
>
  <ins
    data-ad-format="auto"
    class="adsbygoogle adsbygoogle-noablate"
    data-ad-client="ca-pub-0588844875925051"
    data-adsbygoogle-status="done"
    style="
      display: block;
      margin: auto;
      background-color: transparent;
      height: 280px;
    "
    ><div
      id="aswift_12_host"
      style="
        border: none;
        height: 280px;
        width: 1027px;
        margin: 0px;
        padding: 0px;
        position: relative;
        visibility: visible;
        background-color: transparent;
        display: inline-block;
      "
    ></div
  ></ins>
</div>
<p>
  First, try to avoid having multiple pointers point at the same piece of
  dynamic memory. If this is not possible, be clear about which pointer “owns”
  the memory (and is responsible for deleting it) and which pointers are just
  accessing it.
</p>
<p>
  Second, when you delete a pointer, if that pointer is not going out of scope
  immediately afterward, set the pointer to nullptr. We’ll talk more about null
  pointers, and why they are useful in a bit.
</p>
<div class="cpp-note cpp-lightgreenbackground">
  <p class="cpp-note-title cpp-bottomline">Best practice</p>
  <p>
    Set deleted pointers to nullptr unless they are going out of scope
    immediately afterward.
  </p>
</div>
<p class="cpp-section cpp-topline" style="clear: both">Operator new can fail</p>
<p>
  When requesting memory from the operating system, in rare circumstances, the
  operating system may not have any memory to grant the request with.
</p>
<p>
  By default, if new fails, a <em>bad_alloc</em> exception is thrown. If this
  exception isn’t properly handled (and it won’t be, since we haven’t covered
  exceptions or exception handling yet), the program will simply terminate
  (crash) with an unhandled exception error.
</p>
<div
  class="google-auto-placed ap_container"
  style="width: 100%; height: auto; clear: both; text-align: center"
>
  <ins
    data-ad-format="auto"
    class="adsbygoogle adsbygoogle-noablate"
    data-ad-client="ca-pub-0588844875925051"
    data-adsbygoogle-status="done"
    style="
      display: block;
      margin: auto;
      background-color: transparent;
      height: 280px;
    "
    ><div
      id="aswift_13_host"
      style="
        border: none;
        height: 280px;
        width: 1027px;
        margin: 0px;
        padding: 0px;
        position: relative;
        visibility: visible;
        background-color: transparent;
        display: inline-block;
      "
    ></div
  ></ins>
</div>
<p>
  In many cases, having new throw an exception (or having your program crash) is
  undesirable, so there’s an alternate form of new that can be used instead to
  tell new to return a null pointer if memory can’t be allocated. This is done
  by adding the constant std::nothrow between the new keyword and the allocation
  type:
</p>
<div class="code-toolbar">
  <pre
    class="line-numbers language-cpp"
    tabindex="0"
  ><code class="match-braces language-cpp"><span class="token keyword keyword-int">int</span><span class="token operator">*</span> value <span class="token punctuation brace-curly brace-open brace-level-1" id="pair-21-close">{</span> <span class="token keyword keyword-new">new</span> <span class="token punctuation brace-round brace-open brace-level-2" id="pair-20-close">(</span>std<span class="token double-colon punctuation">::</span>nothrow<span class="token punctuation brace-round brace-close brace-level-2" id="pair-20-open">)</span> <span class="token keyword keyword-int">int</span> <span class="token punctuation brace-curly brace-close brace-level-1" id="pair-21-open">}</span><span class="token punctuation">;</span> <span class="token comment">// value will be set to a null pointer if the integer allocation fails</span><span aria-hidden="true" class="line-numbers-rows"><span style="height: 16px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre>
  <div class="toolbar">
    <div class="toolbar-item">
      <button
        class="copy-to-clipboard-button"
        type="button"
        data-copy-state="copy"
      >
        <span>Copy</span>
      </button>
    </div>
  </div>
</div>
<p>
  In the above example, if new fails to allocate memory, it will return a null
  pointer instead of the address of the allocated memory.
</p>
<p>
  Note that if you then attempt to dereference this pointer, undefined behavior
  will result (most likely, your program will crash). Consequently, the best
  practice is to check all memory requests to ensure they actually succeeded
  before using the allocated memory.
</p>
<div class="code-toolbar">
  <pre
    class="line-numbers language-cpp"
    tabindex="0"
  ><code class="match-braces language-cpp"><span class="token keyword keyword-int">int</span><span class="token operator">*</span> value <span class="token punctuation brace-curly brace-open brace-level-1" id="pair-25-close">{</span> <span class="token keyword keyword-new">new</span> <span class="token punctuation brace-round brace-open brace-level-2" id="pair-22-close">(</span>std<span class="token double-colon punctuation">::</span>nothrow<span class="token punctuation brace-round brace-close brace-level-2" id="pair-22-open">)</span> <span class="token keyword keyword-int">int</span><span class="token punctuation brace-curly brace-open brace-level-2" id="pair-24-close">{</span><span class="token punctuation brace-curly brace-close brace-level-2" id="pair-24-open">}</span> <span class="token punctuation brace-curly brace-close brace-level-1" id="pair-25-open">}</span><span class="token punctuation">;</span> <span class="token comment">// ask for an integer's worth of memory</span>
<span class="token keyword keyword-if">if</span> <span class="token punctuation brace-round brace-open brace-level-1" id="pair-23-close">(</span><span class="token operator">!</span>value<span class="token punctuation brace-round brace-close brace-level-1" id="pair-23-open">)</span> <span class="token comment">// handle case where new returned null</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-26-close">{</span>
    <span class="token comment">// Do error handling here</span>
    std<span class="token double-colon punctuation">::</span>cerr <span class="token operator">&lt;&lt;</span> <span class="token string">"Could not allocate memory\n"</span><span class="token punctuation">;</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-26-open">}</span><span aria-hidden="true" class="line-numbers-rows"><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre>
  <div class="toolbar">
    <div class="toolbar-item">
      <button
        class="copy-to-clipboard-button"
        type="button"
        data-copy-state="copy"
      >
        <span>Copy</span>
      </button>
    </div>
  </div>
</div>
<p>
  Because asking new for memory only fails rarely (and almost never in a dev
  environment), it’s common to forget to do this check!
</p>
<p class="cpp-section cpp-topline" style="clear: both">
  Null pointers and dynamic memory allocation
</p>
<p>
  Null pointers (pointers set to nullptr) are particularly useful when dealing
  with dynamic memory allocation. In the context of dynamic memory allocation, a
  null pointer basically says “no memory has been allocated to this pointer”.
  This allows us to do things like conditionally allocate memory:
</p>
<div class="code-toolbar">
  <pre
    class="line-numbers language-cpp"
    tabindex="0"
  ><code class="match-braces language-cpp"><span class="token comment">// If ptr isn't already allocated, allocate it</span>
<span class="token keyword keyword-if">if</span> <span class="token punctuation brace-round brace-open brace-level-1" id="pair-27-close">(</span><span class="token operator">!</span>ptr<span class="token punctuation brace-round brace-close brace-level-1" id="pair-27-open">)</span>
    ptr <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token keyword keyword-int">int</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre>
  <div class="toolbar">
    <div class="toolbar-item">
      <button
        class="copy-to-clipboard-button"
        type="button"
        data-copy-state="copy"
      >
        <span>Copy</span>
      </button>
    </div>
  </div>
</div>
<p>
  Deleting a null pointer has no effect. Thus, there is no need for the
  following:
</p>
<div class="code-toolbar">
  <pre
    class="line-numbers language-cpp"
    tabindex="0"
  ><code class="match-braces language-cpp"><span class="token keyword keyword-if">if</span> <span class="token punctuation brace-round brace-open brace-level-1" id="pair-28-close">(</span>ptr<span class="token punctuation brace-round brace-close brace-level-1" id="pair-28-open">)</span> <span class="token comment">// if ptr is not a null pointer</span>
    <span class="token keyword keyword-delete">delete</span> ptr<span class="token punctuation">;</span> <span class="token comment">// delete it</span>
<span class="token comment">// otherwise do nothing</span><span aria-hidden="true" class="line-numbers-rows"><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre>
  <div class="toolbar">
    <div class="toolbar-item">
      <button
        class="copy-to-clipboard-button"
        type="button"
        data-copy-state="copy"
      >
        <span>Copy</span>
      </button>
    </div>
  </div>
</div>
<p>Instead, you can just write:</p>
<div class="code-toolbar">
  <pre
    class="line-numbers language-cpp"
    tabindex="0"
  ><code class="match-braces language-cpp"><span class="token keyword keyword-delete">delete</span> ptr<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span style="height: 16px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre>
  <div class="toolbar">
    <div class="toolbar-item">
      <button
        class="copy-to-clipboard-button"
        type="button"
        data-copy-state="copy"
      >
        <span>Copy</span>
      </button>
    </div>
  </div>
</div>
<p>
  If ptr is non-null, the dynamically allocated memory will be deleted. If ptr
  is null, nothing will happen.
</p>
<div class="cpp-note cpp-lightgreenbackground">
  <p class="cpp-note-title cpp-bottomline">Best practice</p>
  <p>
    Deleting a null pointer is okay, and does nothing. There is no need to
    conditionalize your delete statements.
  </p>
</div>
<p class="cpp-section cpp-topline" style="clear: both">Memory leaks</p>
<p>
  Dynamically allocated memory stays allocated until it is explicitly
  deallocated or until the program ends (and the operating system cleans it up,
  assuming your operating system does that). However, the pointers used to hold
  dynamically allocated memory addresses follow the normal scoping rules for
  local variables. This mismatch can create interesting problems.
</p>
<p>Consider the following function:</p>
<div class="code-toolbar">
  <pre
    class="line-numbers language-cpp"
    tabindex="0"
  ><code class="match-braces language-cpp"><span class="token keyword keyword-void">void</span> <span class="token function">doSomething</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-29-close">(</span><span class="token punctuation brace-round brace-close brace-level-1" id="pair-29-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-32-close">{</span>
    <span class="token keyword keyword-int">int</span><span class="token operator">*</span> ptr<span class="token punctuation brace-curly brace-open brace-level-2" id="pair-31-close">{</span> <span class="token keyword keyword-new">new</span> <span class="token keyword keyword-int">int</span><span class="token punctuation brace-curly brace-open brace-level-3" id="pair-30-close">{</span><span class="token punctuation brace-curly brace-close brace-level-3" id="pair-30-open">}</span> <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-31-open">}</span><span class="token punctuation">;</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-32-open">}</span><span aria-hidden="true" class="line-numbers-rows"><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre>
  <div class="toolbar">
    <div class="toolbar-item">
      <button
        class="copy-to-clipboard-button"
        type="button"
        data-copy-state="copy"
      >
        <span>Copy</span>
      </button>
    </div>
  </div>
</div>
<p>
  This function allocates an integer dynamically, but never frees it using
  delete. Because pointers variables are just normal variables, when the
  function ends, ptr will go out of scope. And because ptr is the only variable
  holding the address of the dynamically allocated integer, when ptr is
  destroyed there are no more references to the dynamically allocated memory.
  This means the program has now “lost” the address of the dynamically allocated
  memory. As a result, this dynamically allocated integer can not be deleted.
</p>
<p>
  This is called a <strong>memory leak</strong>. Memory leaks happen when your
  program loses the address of some bit of dynamically allocated memory before
  giving it back to the operating system. When this happens, your program can’t
  delete the dynamically allocated memory, because it no longer knows where it
  is. The operating system also can’t use this memory, because that memory is
  considered to be still in use by your program.
</p>
<p>
  Memory leaks eat up free memory while the program is running, making less
  memory available not only to this program, but to other programs as well.
  Programs with severe memory leak problems can eat all the available memory,
  causing the entire machine to run slowly or even crash. Only after your
  program terminates is the operating system able to clean up and “reclaim” all
  leaked memory.
</p>
<p>
  Although memory leaks can result from a pointer going out of scope, there are
  other ways that memory leaks can result. For example, a memory leak can occur
  if a pointer holding the address of the dynamically allocated memory is
  assigned another value:
</p>
<div class="code-toolbar">
  <pre
    class="line-numbers language-cpp"
    tabindex="0"
  ><code class="match-braces language-cpp"><span class="token keyword keyword-int">int</span> value <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
<span class="token keyword keyword-int">int</span><span class="token operator">*</span> ptr<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-34-close">{</span> <span class="token keyword keyword-new">new</span> <span class="token keyword keyword-int">int</span><span class="token punctuation brace-curly brace-open brace-level-2" id="pair-33-close">{</span><span class="token punctuation brace-curly brace-close brace-level-2" id="pair-33-open">}</span> <span class="token punctuation brace-curly brace-close brace-level-1" id="pair-34-open">}</span><span class="token punctuation">;</span> <span class="token comment">// allocate memory</span>
ptr <span class="token operator">=</span> <span class="token operator">&amp;</span>value<span class="token punctuation">;</span> <span class="token comment">// old address lost, memory leak results</span><span aria-hidden="true" class="line-numbers-rows"><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre>
  <div class="toolbar">
    <div class="toolbar-item">
      <button
        class="copy-to-clipboard-button"
        type="button"
        data-copy-state="copy"
      >
        <span>Copy</span>
      </button>
    </div>
  </div>
</div>
<p>This can be fixed by deleting the pointer before reassigning it:</p>
<div class="code-toolbar">
  <pre
    class="line-numbers language-cpp"
    tabindex="0"
  ><code class="match-braces language-cpp"><span class="token keyword keyword-int">int</span> value<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-35-close">{</span> <span class="token number">5</span> <span class="token punctuation brace-curly brace-close brace-level-1" id="pair-35-open">}</span><span class="token punctuation">;</span>
<span class="token keyword keyword-int">int</span><span class="token operator">*</span> ptr<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-37-close">{</span> <span class="token keyword keyword-new">new</span> <span class="token keyword keyword-int">int</span><span class="token punctuation brace-curly brace-open brace-level-2" id="pair-36-close">{</span><span class="token punctuation brace-curly brace-close brace-level-2" id="pair-36-open">}</span> <span class="token punctuation brace-curly brace-close brace-level-1" id="pair-37-open">}</span><span class="token punctuation">;</span> <span class="token comment">// allocate memory</span>
<span class="token keyword keyword-delete">delete</span> ptr<span class="token punctuation">;</span> <span class="token comment">// return memory back to operating system</span>
ptr <span class="token operator">=</span> <span class="token operator">&amp;</span>value<span class="token punctuation">;</span> <span class="token comment">// reassign pointer to address of value</span><span aria-hidden="true" class="line-numbers-rows"><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre>
  <div class="toolbar">
    <div class="toolbar-item">
      <button
        class="copy-to-clipboard-button"
        type="button"
        data-copy-state="copy"
      >
        <span>Copy</span>
      </button>
    </div>
  </div>
</div>
<p>
  Relatedly, it is also possible to get a memory leak via double-allocation:
</p>
<div class="code-toolbar">
  <pre
    class="line-numbers language-cpp"
    tabindex="0"
  ><code class="match-braces language-cpp"><span class="token keyword keyword-int">int</span><span class="token operator">*</span> ptr<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-39-close">{</span> <span class="token keyword keyword-new">new</span> <span class="token keyword keyword-int">int</span><span class="token punctuation brace-curly brace-open brace-level-2" id="pair-38-close">{</span><span class="token punctuation brace-curly brace-close brace-level-2" id="pair-38-open">}</span> <span class="token punctuation brace-curly brace-close brace-level-1" id="pair-39-open">}</span><span class="token punctuation">;</span>
ptr <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token keyword keyword-int">int</span><span class="token punctuation brace-curly brace-open brace-level-1" id="pair-40-close">{</span><span class="token punctuation brace-curly brace-close brace-level-1" id="pair-40-open">}</span><span class="token punctuation">;</span> <span class="token comment">// old address lost, memory leak results</span><span aria-hidden="true" class="line-numbers-rows"><span style="height: 16px;"></span><span style="height: 16px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre>
  <div class="toolbar">
    <div class="toolbar-item">
      <button
        class="copy-to-clipboard-button"
        type="button"
        data-copy-state="copy"
      >
        <span>Copy</span>
      </button>
    </div>
  </div>
</div>
<p>
  The address returned from the second allocation overwrites the address of the
  first allocation. Consequently, the first allocation becomes a memory leak!
</p>
<p>
  Similarly, this can be avoided by ensuring you delete the pointer before
  reassigning.
</p>
<p class="cpp-section cpp-topline" style="clear: both">Conclusion</p>
<p>
  Operators new and delete allow us to dynamically allocate single variables for
  our programs.
</p>
<p>
  Dynamically allocated memory has dynamic duration and will stay allocated
  until you deallocate it or the program terminates.
</p>
<p>Be careful not to perform dereference a dangling or null pointers.</p>
<p>
  In the next lesson, we’ll take a look at using new and delete to allocate and
  delete arrays.
</p>
<div class="prevnext">
  <div class="prevnext-inline">
    <a
      class="nav-link"
      href="https://www.learncpp.com/cpp-tutorial/dynamically-allocating-arrays/"
    >
      <div class="nav-button nav-button-next">
        <div class="nav-button-icon">
          <i class="fa fa-chevron-circle-right" aria-hidden="true"></i>
        </div>
        <div class="nav-button-text">
          <div class="nav-button-title">Next lesson</div>
          <div class="nav-button-lesson">
            <span class="nav-button-lesson-number">19.2</span>Dynamically
            allocating arrays
          </div>
        </div>
      </div></a
    >
    <a class="nav-link" href="/">
      <div class="nav-button nav-button-index">
        <div class="nav-button-icon">
          <i class="fa fa-home" aria-hidden="true"></i>
        </div>
        <div class="nav-button-text">
          <div class="nav-button-title">Back to table of contents</div>
        </div>
      </div></a
    >
    <a
      class="nav-link"
      href="https://www.learncpp.com/cpp-tutorial/timing-your-code/"
    >
      <div class="nav-button nav-button-prev">
        <div class="nav-button-icon">
          <i class="fa fa-chevron-circle-left" aria-hidden="true"></i>
        </div>
        <div class="nav-button-text">
          <div class="nav-button-title">Previous lesson</div>
          <div class="nav-button-lesson">
            <span class="nav-button-lesson-number">18.4</span>Timing your code
          </div>
        </div>
      </div></a
    >
  </div>
</div>
<div class="code-block code-block-10" style="margin: 8px 0; clear: both"></div>

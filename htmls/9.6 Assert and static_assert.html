<div
  class="code-block code-block-1"
  style="margin: 8px 8px 8px 0; float: left"
></div>
<p>
  In a function that takes parameters, the caller may be able to pass in
  arguments that are syntactically valid but semantically meaningless. For
  example, in the previous lesson (<a
    href="https://www.learncpp.com/cpp-tutorial/detecting-and-handling-errors/"
    >9.4 -- Detecting and handling errors</a
  >), we showed the following sample function:
</p>
<div class="code-toolbar">
  <pre
    class="line-numbers language-cpp"
    tabindex="0"
  ><code class="match-braces language-cpp"><span class="token keyword keyword-void">void</span> <span class="token function">printDivision</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-95-close">(</span><span class="token keyword keyword-int">int</span> x<span class="token punctuation">,</span> <span class="token keyword keyword-int">int</span> y<span class="token punctuation brace-round brace-close brace-level-1" id="pair-95-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-98-close">{</span>
    <span class="token keyword keyword-if">if</span> <span class="token punctuation brace-round brace-open brace-level-2" id="pair-96-close">(</span>y <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation brace-round brace-close brace-level-2" id="pair-96-open">)</span>
        std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token generic-function"><span class="token function">static_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword keyword-double">double</span><span class="token operator">&gt;</span></span></span><span class="token punctuation brace-round brace-open brace-level-2" id="pair-97-close">(</span>x<span class="token punctuation brace-round brace-close brace-level-2" id="pair-97-open">)</span> <span class="token operator">/</span> y<span class="token punctuation">;</span>
    <span class="token keyword keyword-else">else</span>
        std<span class="token double-colon punctuation">::</span>cerr <span class="token operator">&lt;&lt;</span> <span class="token string">"Error: Could not divide by zero\n"</span><span class="token punctuation">;</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-98-open">}</span><span aria-hidden="true" class="line-numbers-rows"><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre>
  <div class="toolbar">
    <div class="toolbar-item">
      <button
        class="copy-to-clipboard-button"
        type="button"
        data-copy-state="copy"
      >
        <span>Copy</span>
      </button>
    </div>
  </div>
</div>
<p>
  This function does an explicit check to see if <code>y</code> is
  <code>0</code>, since dividing by zero is a semantic error and will cause the
  program to crash if executed.
</p>
<p>
  In the prior lesson, we discussed a couple of ways to deal with such problems,
  including halting the program, or skipping the offending statements.
</p>
<p>
  Both of those options are problematic though. If a program skips statements
  due to an error, then it is essentially failing silently. Especially while we
  are writing and debugging programs, silent failures are bad, because they
  obscure real problems. Even if we print an error message, that error message
  may be lost among the other program output, and it may be non-obvious where
  the error message is being generated or how the conditions that triggered the
  error message occurred. Some functions may be called tens or hundreds of
  times, and if only one of those cases is generating a problem, it can be hard
  to know which one.
</p>
<p>
  If the program terminates (via <code>std::exit</code>) then we will have lost
  our call stack and any debugging information that might help us isolate the
  problem. <code>std::abort</code> is a better option for such cases, as
  typically the developer will be given the option to start debugging at the
  point where the program aborted.
</p>
<div class="code-block code-block-2" style="margin: 8px 0; clear: both"></div>
<p
  class="cpp-section cpp-topline"
  style="clear: both"
  data-ezoic-video-excluded="1"
>
  Preconditions, invariants, and postconditions
</p>
<p>
  In programming, a <strong>precondition</strong> is any condition that must be
  true prior to the execution of some section of code (typically the body of a
  function). In the prior example, our check that <code>y != 0</code> is a
  precondition that ensures <code>y</code> has a non-zero value before dividing
  by <code>y</code>.
</p>
<p>
  Preconditions for a function are best placed at the top of a function, using
  an early return to return back to the caller if the precondition isn’t met.
  For example:
</p>
<div class="code-toolbar">
  <pre
    class="line-numbers language-cpp"
    tabindex="0"
  ><code class="match-braces language-cpp"><span class="token keyword keyword-void">void</span> <span class="token function">printDivision</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-99-close">(</span><span class="token keyword keyword-int">int</span> x<span class="token punctuation">,</span> <span class="token keyword keyword-int">int</span> y<span class="token punctuation brace-round brace-close brace-level-1" id="pair-99-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-103-close">{</span>
    <span class="token keyword keyword-if">if</span> <span class="token punctuation brace-round brace-open brace-level-2" id="pair-100-close">(</span>y <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation brace-round brace-close brace-level-2" id="pair-100-open">)</span> <span class="token comment">// handle</span>
    <span class="token punctuation brace-curly brace-open brace-level-2" id="pair-102-close">{</span>
        std<span class="token double-colon punctuation">::</span>cerr <span class="token operator">&lt;&lt;</span> <span class="token string">"Error: Could not divide by zero\n"</span><span class="token punctuation">;</span>
        <span class="token keyword keyword-return">return</span><span class="token punctuation">;</span> <span class="token comment">// bounce the user back to the caller</span>
    <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-102-open">}</span>

    <span class="token comment">// We now know that y != 0</span>
    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token generic-function"><span class="token function">static_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword keyword-double">double</span><span class="token operator">&gt;</span></span></span><span class="token punctuation brace-round brace-open brace-level-2" id="pair-101-close">(</span>x<span class="token punctuation brace-round brace-close brace-level-2" id="pair-101-open">)</span> <span class="token operator">/</span> y<span class="token punctuation">;</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-103-open">}</span><span aria-hidden="true" class="line-numbers-rows"><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre>
  <div class="toolbar">
    <div class="toolbar-item">
      <button
        class="copy-to-clipboard-button"
        type="button"
        data-copy-state="copy"
      >
        <span>Copy</span>
      </button>
    </div>
  </div>
</div>
<div class="cpp-note cpp-lightgraybackground" data-ezoic-video-excluded="1">
  <p class="cpp-note-title cpp-bottomline">Optional reading</p>
  <p>
    This is sometimes known as the “bouncer pattern”, as you are bounced out of
    the function immediately when an error is detected.
  </p>
  <p>The bouncer pattern has two major benefits:</p>
  <ol start="1">
    <li>
      All your test cases are up-front, and the test case and code handling the
      error are together.
    </li>
    <li>You end up with less nesting.</li>
  </ol>
  <p>Here’s what the non-bouncer version of this looks like:</p>
  <div class="code-toolbar">
    <pre
      class="line-numbers language-cpp"
      tabindex="0"
    ><code class="match-braces language-cpp"><span class="token keyword keyword-void">void</span> <span class="token function">printDivision</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-104-close">(</span><span class="token keyword keyword-int">int</span> x<span class="token punctuation">,</span> <span class="token keyword keyword-int">int</span> y<span class="token punctuation brace-round brace-close brace-level-1" id="pair-104-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-109-close">{</span>
    <span class="token keyword keyword-if">if</span> <span class="token punctuation brace-round brace-open brace-level-2" id="pair-105-close">(</span>y <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation brace-round brace-close brace-level-2" id="pair-105-open">)</span>
    <span class="token punctuation brace-curly brace-open brace-level-2" id="pair-107-close">{</span>
        std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token generic-function"><span class="token function">static_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword keyword-double">double</span><span class="token operator">&gt;</span></span></span><span class="token punctuation brace-round brace-open brace-level-3" id="pair-106-close">(</span>x<span class="token punctuation brace-round brace-close brace-level-3" id="pair-106-open">)</span> <span class="token operator">/</span> y<span class="token punctuation">;</span>
    <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-107-open">}</span>
    <span class="token keyword keyword-else">else</span>
    <span class="token punctuation brace-curly brace-open brace-level-2" id="pair-108-close">{</span>
        std<span class="token double-colon punctuation">::</span>cerr <span class="token operator">&lt;&lt;</span> <span class="token string">"Error: Could not divide by zero\n"</span><span class="token punctuation">;</span>
        <span class="token keyword keyword-return">return</span><span class="token punctuation">;</span> <span class="token comment">// bounce the user back to the caller</span>
    <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-108-open">}</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-109-open">}</span><span aria-hidden="true" class="line-numbers-rows"><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre>
    <div class="toolbar">
      <div class="toolbar-item">
        <button
          class="copy-to-clipboard-button"
          type="button"
          data-copy-state="copy"
        >
          <span>Copy</span>
        </button>
      </div>
    </div>
  </div>
  <p>
    This version is strictly worse, as the test case and code handling the error
    are more separated, and there is more nesting.
  </p>
</div>
<p>
  An <strong>invariant</strong> is a condition that must be true while some
  section of code is executing. This is often used with loops, where the loop
  body will only execute so long as the invariant is true.
</p>
<div class="cpp-note cpp-lightgraybackground" data-ezoic-video-excluded="1">
  <p class="cpp-note-title cpp-bottomline">For advanced readers</p>
  <p>
    We talk about a common type of invariant called a “class invariant” in
    lesson
    <a href="https://www.learncpp.com/cpp-tutorial/introduction-to-classes/"
      >14.2 -- Introduction to classes</a
    >.
  </p>
</div>
<p>
  Similarly, a <strong>postcondition</strong> is something that must be true
  after the execution of some section of code. Our function doesn’t have any
  postconditions.
</p>
<p
  class="cpp-section cpp-topline"
  style="clear: both"
  data-ezoic-video-excluded="1"
>
  Assertions
</p>
<p>
  Using a conditional statement to detect an invalid parameter (or to validate
  some other kind of assumption), along with printing an error message and
  terminating the program, is such a common method of detecting problems that
  C++ provides a shortcut method for doing this.
</p>
<div class="code-block code-block-3" style="margin: 8px 0; clear: both"></div>
<p>
  An <strong>assertion</strong> is an expression that will be true unless there
  is a bug in the program. If the expression evaluates to <code>true</code>, the
  assertion statement does nothing. If the conditional expression evaluates to
  <code>false</code>, an error message is displayed and the program is
  terminated (via <code>std::abort</code>). This error message typically
  contains the expression that failed as text, along with the name of the code
  file and the line number of the assertion. This makes it very easy to tell not
  only what the problem was, but where in the code the problem occurred. This
  can help with debugging efforts immensely.
</p>
<div class="cpp-note cpp-lightbluebackground" data-ezoic-video-excluded="1">
  <p class="cpp-note-title cpp-bottomline">Key insight</p>
  <p>Asserts are used to detect errors while developing and debugging.</p>
  <p>
    When an assertion evaluates to false, your program is immediately stopped.
    This gives you an opportunity to use debugging tools to examine the state of
    your program and determine why the assertion failed. Working backwards, you
    can then find and fix the issue quickly.
  </p>
  <p>
    Without an assertion to detect an error and fail, such an error would likely
    cause your program to malfunction later. In such cases, it can be very
    difficult to determine where things are going wrong, or what the root cause
    of the issue actually is.
  </p>
</div>
<p>
  In C++, runtime assertions are implemented via the
  <strong>assert</strong> preprocessor macro, which lives in the &lt;cassert&gt;
  header.
</p>
<div class="code-toolbar">
  <pre
    class="line-numbers language-cpp"
    tabindex="0"
  ><code class="match-braces language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;cassert&gt;</span> <span class="token comment">// for assert()</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;cmath&gt;</span> <span class="token comment">// for std::sqrt</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>

<span class="token keyword keyword-double">double</span> <span class="token function">calculateTimeUntilObjectHitsGround</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-110-close">(</span><span class="token keyword keyword-double">double</span> initialHeight<span class="token punctuation">,</span> <span class="token keyword keyword-double">double</span> gravity<span class="token punctuation brace-round brace-close brace-level-1" id="pair-110-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-118-close">{</span>
  <span class="token function">assert</span><span class="token punctuation brace-round brace-open brace-level-2" id="pair-111-close">(</span>gravity <span class="token operator">&gt;</span> <span class="token number">0.0</span><span class="token punctuation brace-round brace-close brace-level-2" id="pair-111-open">)</span><span class="token punctuation">;</span> <span class="token comment">// The object won't reach the ground unless there is positive gravity.</span>

  <span class="token keyword keyword-if">if</span> <span class="token punctuation brace-round brace-open brace-level-2" id="pair-112-close">(</span>initialHeight <span class="token operator">&lt;=</span> <span class="token number">0.0</span><span class="token punctuation brace-round brace-close brace-level-2" id="pair-112-open">)</span>
  <span class="token punctuation brace-curly brace-open brace-level-2" id="pair-117-close">{</span>
    <span class="token comment">// The object is already on the ground. Or buried.</span>
    <span class="token keyword keyword-return">return</span> <span class="token number">0.0</span><span class="token punctuation">;</span>
  <span class="token punctuation brace-curly brace-close brace-level-2" id="pair-117-open">}</span>

  <span class="token keyword keyword-return">return</span> std<span class="token double-colon punctuation">::</span><span class="token function">sqrt</span><span class="token punctuation brace-round brace-open brace-level-2" id="pair-114-close">(</span><span class="token punctuation brace-round brace-open brace-level-3" id="pair-113-close">(</span><span class="token number">2.0</span> <span class="token operator">*</span> initialHeight<span class="token punctuation brace-round brace-close brace-level-3" id="pair-113-open">)</span> <span class="token operator">/</span> gravity<span class="token punctuation brace-round brace-close brace-level-2" id="pair-114-open">)</span><span class="token punctuation">;</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-118-open">}</span>

<span class="token keyword keyword-int">int</span> <span class="token function">main</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-115-close">(</span><span class="token punctuation brace-round brace-close brace-level-1" id="pair-115-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-119-close">{</span>
  std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Took "</span> <span class="token operator">&lt;&lt;</span> <span class="token function">calculateTimeUntilObjectHitsGround</span><span class="token punctuation brace-round brace-open brace-level-2" id="pair-116-close">(</span><span class="token number">100.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">9.8</span><span class="token punctuation brace-round brace-close brace-level-2" id="pair-116-open">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" second(s)\n"</span><span class="token punctuation">;</span>

  <span class="token keyword keyword-return">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-119-open">}</span><span aria-hidden="true" class="line-numbers-rows"><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre>
  <div class="toolbar">
    <div class="toolbar-item">
      <button
        class="copy-to-clipboard-button"
        type="button"
        data-copy-state="copy"
      >
        <span>Copy</span>
      </button>
    </div>
  </div>
</div>
<p>
  When the program calls
  <code>calculateTimeUntilObjectHitsGround(100.0, -9.8)</code>,
  <code>assert(gravity &gt; 0.0)</code> will evaluate to <code>false</code>,
  which will trigger the assert. That will print a message similar to this:
</p>
<pre>
dropsimulator: src/main.cpp:6: double calculateTimeUntilObjectHitsGround(double, double): Assertion 'gravity &gt; 0.0' failed.
</pre>
<p>The actual message varies depending on which compiler you use.</p>
<p>
  Although asserts are most often used to validate function parameters, they can
  be used anywhere you would like to validate that something is true.
</p>
<div class="code-block code-block-4" style="margin: 8px 0; clear: both"></div>
<p>
  Although we told you previously to avoid preprocessor macros, asserts are one
  of the few preprocessor macros that are considered acceptable to use. We
  encourage you to use assert statements liberally throughout your code.
</p>
<div class="cpp-note cpp-lightbluebackground" data-ezoic-video-excluded="1">
  <p class="cpp-note-title cpp-bottomline">Key insight</p>
  <p>
    Asserts are better than comments because they have both document and enforce
    a condition. Comments can become stale when the code changes and the comment
    isn’t updated. An assert that has become out of date is a code correctness
    issue, so developers are less likely to let them languish.
  </p>
</div>
<p
  class="cpp-section cpp-topline"
  style="clear: both"
  data-ezoic-video-excluded="1"
>
  Making your assert statements more descriptive
</p>
<p>
  Sometimes assert expressions aren’t very descriptive. Consider the following
  statement:
</p>
<div class="code-toolbar">
  <pre
    class="line-numbers language-cpp"
    tabindex="0"
  ><code class="match-braces language-cpp"><span class="token function">assert</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-120-close">(</span>found<span class="token punctuation brace-round brace-close brace-level-1" id="pair-120-open">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span style="height: 16px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre>
  <div class="toolbar">
    <div class="toolbar-item">
      <button
        class="copy-to-clipboard-button"
        type="button"
        data-copy-state="copy"
      >
        <span>Copy</span>
      </button>
    </div>
  </div>
</div>
<p>If this assert is triggered, the assert will say:</p>
<pre>
Assertion failed: found, file C:\\VCProjects\\Test.cpp, line 34
</pre>
<p>
  What does this even mean? Clearly <code>found</code> was
  <code>false</code> (since the assert triggered), but what wasn’t found? You’d
  have to go look at the code to determine that.
</p>
<div class="code-block code-block-5" style="margin: 8px 0; clear: both"></div>
<p>
  Fortunately, there’s a little trick you can use to make your assert statements
  more descriptive. Simply add a string literal joined by a logical AND:
</p>
<div class="code-toolbar">
  <pre
    class="line-numbers language-cpp"
    tabindex="0"
  ><code class="match-braces language-cpp"><span class="token function">assert</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-121-close">(</span>found <span class="token operator">&amp;&amp;</span> <span class="token string">"Car could not be found in database"</span><span class="token punctuation brace-round brace-close brace-level-1" id="pair-121-open">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span style="height: 16px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre>
  <div class="toolbar">
    <div class="toolbar-item">
      <button
        class="copy-to-clipboard-button"
        type="button"
        data-copy-state="copy"
      >
        <span>Copy</span>
      </button>
    </div>
  </div>
</div>
<p>
  Here’s why this works: A string literal always evaluates to Boolean
  <code>true</code>. So if <code>found</code> is <code>false</code>,
  <code>false &amp;&amp; true</code> is <code>false</code>. If
  <code>found</code> is <code>true</code>, <code>true &amp;&amp; true</code> is
  <code>true</code>. Thus, logical AND-ing a string literal doesn’t impact the
  evaluation of the assert.
</p>
<p>
  However, when the assert triggers, the string literal will be included in the
  assert message:
</p>
<pre>
Assertion failed: found &amp;&amp; "Car could not be found in database", file C:\\VCProjects\\Test.cpp, line 34
</pre>
<p>That gives you some additional context as to what went wrong.</p>
<p
  class="cpp-section cpp-topline"
  style="clear: both"
  data-ezoic-video-excluded="1"
>
  Using assertions for unimplemented features
</p>
<div class="code-block code-block-6" style="margin: 8px 0; clear: both"></div>
<p>
  Assertions are also sometimes used to document cases that were not implemented
  because they were not needed at the time the programmer wrote the code:
</p>
<div class="code-toolbar">
  <pre
    class="line-numbers language-cpp"
    tabindex="0"
  ><code class="match-braces language-cpp"><span class="token function">assert</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-122-close">(</span>moved <span class="token operator">&amp;&amp;</span> <span class="token string">"Need to handle case where student was just moved to another classroom"</span><span class="token punctuation brace-round brace-close brace-level-1" id="pair-122-open">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span style="height: 16px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre>
  <div class="toolbar">
    <div class="toolbar-item">
      <button
        class="copy-to-clipboard-button"
        type="button"
        data-copy-state="copy"
      >
        <span>Copy</span>
      </button>
    </div>
  </div>
</div>
<p>
  That way, if a developer encounters a situation where this case is needed, the
  code will fail with a useful error message, and the programmer can then
  determine how to implement that case.
</p>
<p
  class="cpp-section cpp-topline"
  style="clear: both"
  data-ezoic-video-excluded="1"
>
  NDEBUG
</p>
<p>
  The <code>assert</code> macro comes with a small performance cost that is
  incurred each time the assert condition is checked. Furthermore, asserts
  should (ideally) never be encountered in production code (because your code
  should already be thoroughly tested). Consequently, most developers prefer
  that asserts are only active in debug builds. C++ comes with a built-in way to
  turn off asserts in production code: if the preprocessor macro
  <code>NDEBUG</code> is defined, the assert macro gets disabled.
</p>
<p>
  Most IDEs set <code>NDEBUG</code> by default as part of the project settings
  for release configurations. For example, in Visual Studio, the following
  preprocessor definitions are set at the project level:
  <code>WIN32;NDEBUG;_CONSOLE</code>. If you’re using Visual Studio and want
  your asserts to trigger in release builds, you’ll need to remove
  <code>NDEBUG</code> from this setting.
</p>
<p>
  If you’re using an IDE or build system that doesn’t automatically define
  <code>NDEBUG</code> in release configuration, you will need to add it in the
  project or compilation settings manually.
</p>
<div class="code-block code-block-7" style="margin: 8px 0; clear: both"></div>
<div class="cpp-note cpp-lightbluebackground" data-ezoic-video-excluded="1">
  <p class="cpp-note-title cpp-bottomline">Tip</p>
  <p>
    For testing purposes, you can enable or disable asserts within a given
    translation unit. To do so, place one of the following on its own line
    <strong>before</strong> any #includes: <code>#define NDEBUG</code> (to
    disable asserts) or <code>#undef NDEBUG</code> (to enable asserts). Make
    sure that you do not end the line in a semicolon.
  </p>
  <p>e.g.</p>
  <div class="code-toolbar">
    <pre
      class="line-numbers language-cpp"
      tabindex="0"
    ><code class="match-braces language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">NDEBUG</span> <span class="token comment">// disable asserts (must be placed before any #includes)</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;cassert&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>

<span class="token keyword keyword-int">int</span> <span class="token function">main</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-123-close">(</span><span class="token punctuation brace-round brace-close brace-level-1" id="pair-123-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-125-close">{</span>
    <span class="token function">assert</span><span class="token punctuation brace-round brace-open brace-level-2" id="pair-124-close">(</span><span class="token boolean">false</span><span class="token punctuation brace-round brace-close brace-level-2" id="pair-124-open">)</span><span class="token punctuation">;</span> <span class="token comment">// won't trigger since asserts have been disabled in this translation unit</span>
    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Hello, world!\n"</span><span class="token punctuation">;</span>

    <span class="token keyword keyword-return">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-125-open">}</span><span aria-hidden="true" class="line-numbers-rows"><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre>
    <div class="toolbar">
      <div class="toolbar-item">
        <button
          class="copy-to-clipboard-button"
          type="button"
          data-copy-state="copy"
        >
          <span>Copy</span>
        </button>
      </div>
    </div>
  </div>
</div>
<p
  class="cpp-section cpp-topline"
  style="clear: both"
  data-ezoic-video-excluded="1"
>
  <a name="static_assert"></a>static_assert
  <a href="#static_assert"
    ><i class="fa fa-link" style="font-size: 0.8em"></i
  ></a>
</p>
<p>
  C++ also has another type of assert called <code>static_assert</code>. A
  <strong>static_assert</strong> is an assertion that is checked at compile-time
  rather than at runtime, with a failing <code>static_assert</code> causing a
  compile error. Unlike assert, which is declared in the &lt;cassert&gt; header,
  static_assert is a keyword, so no header needs to be included to use it.
</p>
<p>A <code>static_assert</code> takes the following form:</p>
<pre>
static_assert(condition, diagnostic_message)
</pre>
<p>
  If the condition is not true, the diagnostic message is printed. Here’s an
  example of using static_assert to ensure types have a certain size:
</p>
<div class="code-toolbar">
  <pre
    class="line-numbers language-cpp"
    tabindex="0"
  ><code class="match-braces language-cpp"><span class="token keyword keyword-static_assert">static_assert</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-127-close">(</span><span class="token keyword keyword-sizeof">sizeof</span><span class="token punctuation brace-round brace-open brace-level-2" id="pair-126-close">(</span><span class="token keyword keyword-long">long</span><span class="token punctuation brace-round brace-close brace-level-2" id="pair-126-open">)</span> <span class="token operator">==</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token string">"long must be 8 bytes"</span><span class="token punctuation brace-round brace-close brace-level-1" id="pair-127-open">)</span><span class="token punctuation">;</span>
<span class="token keyword keyword-static_assert">static_assert</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-129-close">(</span><span class="token keyword keyword-sizeof">sizeof</span><span class="token punctuation brace-round brace-open brace-level-2" id="pair-128-close">(</span><span class="token keyword keyword-int">int</span><span class="token punctuation brace-round brace-close brace-level-2" id="pair-128-open">)</span> <span class="token operator">&gt;=</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">"int must be at least 4 bytes"</span><span class="token punctuation brace-round brace-close brace-level-1" id="pair-129-open">)</span><span class="token punctuation">;</span>

<span class="token keyword keyword-int">int</span> <span class="token function">main</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-130-close">(</span><span class="token punctuation brace-round brace-close brace-level-1" id="pair-130-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-131-close">{</span>
	<span class="token keyword keyword-return">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-131-open">}</span><span aria-hidden="true" class="line-numbers-rows"><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre>
  <div class="toolbar">
    <div class="toolbar-item">
      <button
        class="copy-to-clipboard-button"
        type="button"
        data-copy-state="copy"
      >
        <span>Copy</span>
      </button>
    </div>
  </div>
</div>
<p>On the author’s machine, when compiled, the compiler errors:</p>
<pre>
1&gt;c:\consoleapplication1\main.cpp(19): error C2338: long must be 8 bytes
</pre>
<p>A few useful notes about <code>static_assert</code>:</p>
<div class="code-block code-block-8" style="margin: 8px 0; clear: both"></div>
<ul>
  <li>
    Because <code>static_assert</code> is evaluated by the compiler, the
    condition must be a constant expression.
  </li>
  <li>
    <code>static_assert</code> can be placed anywhere in the code file (even in
    the global namespace).
  </li>
  <li>
    <code>static_assert</code> is not deactivated in release builds (like normal
    <code>assert</code> is).
  </li>
  <li>
    Because the compiler does the evaluation, there is no runtime cost to a
    <code>static_assert</code>.
  </li>
</ul>
<p>
  Prior to C++17, the diagnostic message must be supplied as the second
  parameter. Since C++17, providing a diagnostic message is optional.
</p>
<div class="cpp-note cpp-lightgreenbackground" data-ezoic-video-excluded="1">
  <p class="cpp-note-title cpp-bottomline">Best practice</p>
  <p>
    Favor <code>static_assert</code> over <code>assert()</code> whenever
    possible.
  </p>
</div>
<p
  class="cpp-section cpp-topline"
  style="clear: both"
  data-ezoic-video-excluded="1"
>
  Asserts vs error handling
</p>
<p>
  Assertions and error handling are similar enough that their purposes can be
  confused, so let’s clarify.
</p>
<p>
  Assertions are used to detect <em>programming errors</em> during development
  by documenting assumptions about things that should never happen. And if they
  do happen, it’s the fault of the programmer. Assertions do not allow recovery
  from errors (after all, if something should never happen, there’s no need to
  recover from it). Because asserts are typically compiled-out in release
  builds, you can put a lot of them in without worrying about performance, so
  there’s little reason not to use them liberally.
</p>
<p>
  Error handling is used when we need to gracefully handle cases that could
  happen (however rarely) in a release build. These may either be recoverable
  issues (where the program can keep running), or unrecoverable issues (where
  the program has to shut down, but we can at least show a nice error message
  and ensure everything is cleaned up properly). Error detection and handling
  has both a runtime performance cost and a development time cost.
</p>
<p>
  In some cases, it’s less clear what we should do. Consider a function like
  this:
</p>
<div class="code-toolbar">
  <pre
    class="line-numbers language-cpp"
    tabindex="0"
  ><code class="match-braces language-cpp"><span class="token keyword keyword-double">double</span> <span class="token function">getInverse</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-132-close">(</span><span class="token keyword keyword-double">double</span> x<span class="token punctuation brace-round brace-close brace-level-1" id="pair-132-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-133-close">{</span>
    <span class="token keyword keyword-return">return</span> <span class="token number">1.0</span> <span class="token operator">/</span> x<span class="token punctuation">;</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-133-open">}</span><span aria-hidden="true" class="line-numbers-rows"><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre>
  <div class="toolbar">
    <div class="toolbar-item">
      <button
        class="copy-to-clipboard-button"
        type="button"
        data-copy-state="copy"
      >
        <span>Copy</span>
      </button>
    </div>
  </div>
</div>
<p>
  If <code>x</code> is <code>0.0</code>, this function will misbehave, and we
  need to guard against that. Should we use an assert or error handling? The
  best answer may be “both”.
</p>
<p>
  During debugging, if this function is called when <code>x</code> is
  <code>0.0</code>, that indicates a bug in our code somewhere, and we want to
  know that immediately. So an assert is definitely appropriate.
</p>
<p>
  However, this could also reasonably happen in a release build (e.g. along an
  obscure path we didn’t test). If the assert is compiled out and we don’t have
  error handling, then this function will return something unexpected and
  misbehave. In such a case, it’s probably better to detect that and handle the
  case.
</p>
<p>Our resulting function might look like this:</p>
<div class="code-toolbar">
  <pre
    class="line-numbers language-cpp"
    tabindex="0"
  ><code class="match-braces language-cpp"><span class="token keyword keyword-double">double</span> <span class="token function">getInverse</span><span class="token punctuation brace-round brace-open brace-level-1" id="pair-134-close">(</span><span class="token keyword keyword-double">double</span> x<span class="token punctuation brace-round brace-close brace-level-1" id="pair-134-open">)</span>
<span class="token punctuation brace-curly brace-open brace-level-1" id="pair-137-close">{</span>
    <span class="token function">assert</span><span class="token punctuation brace-round brace-open brace-level-2" id="pair-135-close">(</span>x <span class="token operator">!=</span> <span class="token number">0.0</span><span class="token punctuation brace-round brace-close brace-level-2" id="pair-135-open">)</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-if">if</span> <span class="token punctuation brace-round brace-open brace-level-2" id="pair-136-close">(</span>x <span class="token operator">==</span> <span class="token number">0.0</span><span class="token punctuation brace-round brace-close brace-level-2" id="pair-136-open">)</span>
       <span class="token comment">// handle error somehow (e.g. throw an exception)</span>

    <span class="token keyword keyword-return">return</span> <span class="token number">1.0</span> <span class="token operator">/</span> x<span class="token punctuation">;</span>
<span class="token punctuation brace-curly brace-close brace-level-1" id="pair-137-open">}</span><span aria-hidden="true" class="line-numbers-rows"><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span><span style="height: 16px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre>
  <div class="toolbar">
    <div class="toolbar-item">
      <button
        class="copy-to-clipboard-button"
        type="button"
        data-copy-state="copy"
      >
        <span>Copy</span>
      </button>
    </div>
  </div>
</div>
<div class="cpp-note cpp-lightbluebackground" data-ezoic-video-excluded="1">
  <p class="cpp-note-title cpp-bottomline">Tip</p>
  <p>Given this, we suggest the following:</p>
  <ul>
    <li>
      Use assertions to detect programming errors, incorrect assumptions, or
      conditions that should never occur in correct code. It is the programmer’s
      responsibility to fix these, so we want to catch them early.
    </li>
    <li>
      Use error handling for issues that we expect will occur during the normal
      operation of your program.
    </li>
    <li>
      Use both in cases where something isn’t supposed to occur, but we want to
      fail gracefully if it does.
    </li>
  </ul>
</div>
<p
  class="cpp-section cpp-topline"
  style="clear: both"
  data-ezoic-video-excluded="1"
>
  Some assert limitations and warnings
</p>
<p>
  There are a few pitfalls and limitations to asserts. First, the assert itself
  can be improperly written. If this happens, the assert will either report an
  error where none exists, or fail to report a bug where one does exist.
</p>
<p>
  Second, your <code>assert()</code> expressions should have no side effects, as
  the assert expression won’t be evaluated when <code>NDEBUG</code> is defined
  (and thus the side effect won’t be applied). Otherwise, what you are testing
  in a debug configuration will not be the same as in a release configuration
  (assuming you ship with NDEBUG).
</p>
<p>
  Also note that the <code>abort()</code> function terminates the program
  immediately, without a chance to do any further cleanup (e.g. close a file or
  database). Because of this, asserts should be used only in cases where
  corruption isn’t likely to occur if the program terminates unexpectedly.
</p>
<div class="prevnext">
  <div class="prevnext-inline">
    <a
      class="nav-link"
      href="https://www.learncpp.com/cpp-tutorial/chapter-9-summary-and-quiz/"
      ><div class="nav-button nav-button-next">
        <div class="nav-button-icon">
          <i class="fa fa-chevron-circle-right" aria-hidden="true"></i>
        </div>
        <div class="nav-button-text">
          <div class="nav-button-title">Next lesson</div>
          <div class="nav-button-lesson">
            <span class="nav-button-lesson-number">9.x</span>Chapter 9 summary
            and quiz
          </div>
        </div>
      </div></a
    ><a class="nav-link" href="/"
      ><div class="nav-button nav-button-index">
        <div class="nav-button-icon">
          <i class="fa fa-home" aria-hidden="true"></i>
        </div>
        <div class="nav-button-text">
          <div class="nav-button-title">Back to table of contents</div>
        </div>
      </div></a
    ><a
      class="nav-link"
      href="https://www.learncpp.com/cpp-tutorial/stdcin-and-handling-invalid-input/"
      ><div class="nav-button nav-button-prev">
        <div class="nav-button-icon">
          <i class="fa fa-chevron-circle-left" aria-hidden="true"></i>
        </div>
        <div class="nav-button-text">
          <div class="nav-button-title">Previous lesson</div>
          <div class="nav-button-lesson">
            <span class="nav-button-lesson-number">9.5</span>std::cin and
            handling invalid input
          </div>
        </div>
      </div></a
    >
  </div>
</div>
<div class="code-block code-block-10" style="margin: 8px 0; clear: both"></div>
